require=function t(e,n,r){function i(u,s){if(!n[u]){if(!e[u]){var a="function"==typeof require&&require;if(!s&&a)return a(u,!0);if(o)return o(u,!0);throw new Error("Cannot find module '"+u+"'")}var c=n[u]={exports:{}};e[u][0].call(c.exports,function(t){var n=e[u][1][t];return i(n?n:t)},c,c.exports,t,e,n,r)}return n[u].exports}for(var o="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}({1:[function(t,e,n){(function(t,n,r,i,o,u,s,a,c){(function(){var t,r,i,o,u,s,a,c,f,l,h,p,d,v,m,g,y,b,w,k,E,A,S,_,I,D,T,B,x,M,O,L,C,P,q,j,H,V,U,N,F,J,Z,$,W,K,z,R,Q,Y,G,X,tt,et,nt,rt,it,ot,ut,st,at,ct,ft,lt,ht,pt,dt,vt,mt,gt,yt,bt,wt,kt={}.hasOwnProperty,Et=function(t,e){function n(){this.constructor=t}for(var r in e)kt.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},At=[].slice,St=function(t,e){return function(){return t.apply(e,arguments)}};t={toString:function(){return"Bacon"}},t.version="0.7.73",p=("undefined"!=typeof n&&null!==n?n:this).Error,ut=function(){},G=function(t,e){return e},W=function(t,e){return t},P=function(t){return t.slice(0)},D=function(t,e){if(!e)throw new p(t)},L=function(t){if(t instanceof g&&!(t instanceof y))throw new p("Observable is not a Property : "+t)},B=function(t){if(!(t instanceof h))throw new p("not an EventStream : "+t)},O=function(t){if(!(t instanceof g))throw new p("not an Observable : "+t)},x=function(t){return D("not a function : "+t,A.isFunction(t))},R=function(t){return t instanceof Array},Y=function(t){return t instanceof g},T=function(t){if(!R(t))throw new p("not an array : "+t)},M=function(t){return D("no arguments supported",0===t.length)},C=function(t){if("string"!=typeof t)throw new p("not a string : "+t)},A={indexOf:Array.prototype.indexOf?function(t,e){return t.indexOf(e)}:function(t,e){var n,r,i,o;for(n=r=0,i=t.length;i>r;n=++r)if(o=t[n],e===o)return n;return-1},indexWhere:function(t,e){var n,r,i,o;for(n=r=0,i=t.length;i>r;n=++r)if(o=t[n],e(o))return n;return-1},head:function(t){return t[0]},always:function(t){return function(){return t}},negate:function(t){return function(e){return!t(e)}},empty:function(t){return 0===t.length},tail:function(t){return t.slice(1,t.length)},filter:function(t,e){var n,r,i,o;for(n=[],r=0,i=e.length;i>r;r++)o=e[r],t(o)&&n.push(o);return n},map:function(t,e){var n,r,i,o;for(i=[],n=0,r=e.length;r>n;n++)o=e[n],i.push(t(o));return i},each:function(t,e){var n,r;for(n in t)kt.call(t,n)&&(r=t[n],e(n,r));return void 0},toArray:function(t){return R(t)?t:[t]},contains:function(t,e){return-1!==A.indexOf(t,e)},id:function(t){return t},last:function(t){return t[t.length-1]},all:function(t,e){var n,r,i;for(null==e&&(e=A.id),n=0,r=t.length;r>n;n++)if(i=t[n],!e(i))return!1;return!0},any:function(t,e){var n,r,i;for(null==e&&(e=A.id),n=0,r=t.length;r>n;n++)if(i=t[n],e(i))return!0;return!1},without:function(t,e){return A.filter(function(e){return e!==t},e)},remove:function(t,e){var n;return n=A.indexOf(e,t),n>=0?e.splice(n,1):void 0},fold:function(t,e,n){var r,i,o;for(r=0,i=t.length;i>r;r++)o=t[r],e=n(e,o);return e},flatMap:function(t,e){return A.fold(e,[],function(e,n){return e.concat(t(n))})},cached:function(t){var e;return e=m,function(){return e===m&&(e=t(),t=void 0),e}},isFunction:function(t){return"function"==typeof t},toString:function(t){var e,n,r,i;try{return at++,null==t?"undefined":A.isFunction(t)?"function":R(t)?at>5?"[..]":"["+A.map(A.toString,t).toString()+"]":null!=(null!=t?t.toString:void 0)&&t.toString!==Object.prototype.toString?t.toString():"object"==typeof t?at>5?"{..}":(n=function(){var n;n=[];for(r in t)kt.call(t,r)&&(i=function(){try{return t[r]}catch(n){return e=n}}(),n.push(A.toString(r)+":"+A.toString(i)));return n}(),"{"+n+"}"):t}finally{at--}}},at=0,t._=A,E=t.UpdateBarrier=function(){var e,n,r,i,o,u,s,a,c,f,l,h,p,d;return f=void 0,l=[],h={},n=[],r=0,e=function(t){return f?n.push(t):t()},p=function(t,e){var n;return f?(n=h[t.id],null==n?(n=h[t.id]=[e],l.push(t)):n.push(e)):e()},o=function(){for(;l.length>0;)s(0);return void 0},s=function(t){var e,n,r,i,o,s;for(i=l[t],o=i.id,s=h[o],l.splice(t,1),delete h[o],u(i),n=0,r=s.length;r>n;n++)(e=s[n])();return void 0},u=function(t){var e,n,r,i,o;for(n=t.internalDeps(),i=0,o=n.length;o>i;i++)e=n[i],u(e),h[e.id]&&(r=A.indexOf(l,e),s(r));return void 0},c=function(t,e,i,u){var s,a;if(f)return i.apply(e,u);f=t;try{a=i.apply(e,u),o()}finally{for(f=void 0;r<n.length;)s=n[r],r++,s();r=0,n=[]}return a},i=function(){return f?f.id:void 0},d=function(n,r){var i,o,u,s;return s=!1,o=!1,i=function(){return o=!0},u=function(){return s=!0,i()},i=n.dispatcher.subscribe(function(n){return e(function(){var e;return s||(e=r(n),e!==t.noMore)?void 0:u()})}),o&&i(),u},a=function(){return l.length>0},{whenDoneWith:p,hasWaiters:a,inTransaction:c,currentEventId:i,wrappedSubscribe:d,afterTransaction:e}}(),k=function(){function t(t,e,n){this.obs=t,this.sync=e,this.lazy=null!=n?n:!1,this.queue=[]}return t.prototype.subscribe=function(t){return this.obs.dispatcher.subscribe(t)},t.prototype.toString=function(){return this.obs.toString()},t.prototype.markEnded=function(){return this.ended=!0},t.prototype.consume=function(){return this.lazy?{value:A.always(this.queue[0])}:this.queue[0]},t.prototype.push=function(t){return this.queue=[t]},t.prototype.mayHave=function(){return!0},t.prototype.hasAtLeast=function(){return this.queue.length},t.prototype.flatten=!0,t}(),u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Et(e,t),e.prototype.consume=function(){return this.queue.shift()},e.prototype.push=function(t){return this.queue.push(t)},e.prototype.mayHave=function(t){return!this.ended||this.queue.length>=t},e.prototype.hasAtLeast=function(t){return this.queue.length>=t},e.prototype.flatten=!1,e}(k),r=function(t){function e(t){e.__super__.constructor.call(this,t,!0)}return Et(e,t),e.prototype.consume=function(){var t;return t=this.queue,this.queue=[],{value:function(){return t}}},e.prototype.push=function(t){return this.queue.push(t.value())},e.prototype.hasAtLeast=function(){return!0},e}(k),k.isTrigger=function(t){return t instanceof k?t.sync:t instanceof h},k.fromObservable=function(t){return t instanceof k?t:t instanceof y?new k(t,!1):new u(t,!0)},s=function(){function t(t,e,n){this.context=t,this.method=e,this.args=n}return t.prototype.deps=function(){return this.cached||(this.cached=J([this.context].concat(this.args)))},t.prototype.toString=function(){return A.toString(this.context)+"."+A.toString(this.method)+"("+A.map(A.toString,this.args)+")"},t}(),V=function(){var t,e,n;return e=arguments[0],n=arguments[1],t=3<=arguments.length?At.call(arguments,2):[],(e||n)instanceof s?e||n:new s(e,n,t)},bt=function(t,e){return e.desc=t,e},J=function(t){return R(t)?A.flatMap(J,t):Y(t)?[t]:t instanceof k?[t.obs]:[]},t.Desc=s,t.Desc.empty=new t.Desc("","",[]),wt=function(t){return function(){var e,n,r,i;return r=arguments[0],e=2<=arguments.length?At.call(arguments,1):[],"object"==typeof r&&e.length&&(n=r,i=e[0],r=function(){return n[i].apply(n,arguments)},e=e.slice(1)),t.apply(null,[r].concat(At.call(e)))}},et=function(t){return t=Array.prototype.slice.call(t),nt.apply(null,t)},st=function(t,e){return function(){var n;return n=1<=arguments.length?At.call(arguments,0):[],t.apply(null,e.concat(n))}},gt=function(t){return function(e){return function(n){var r;return null==n?void 0:(r=n[e],A.isFunction(r)?r.apply(n,t):r)}}},dt=function(t,e){var n,r;return r=t.slice(1).split("."),n=A.map(gt(e),r),function(e){var r,i;for(r=0,i=n.length;i>r;r++)t=n[r],e=t(e);return e}},Q=function(t){return"string"==typeof t&&t.length>1&&"."===t.charAt(0)},nt=wt(function(){var t,e;return e=arguments[0],t=2<=arguments.length?At.call(arguments,1):[],A.isFunction(e)?t.length?st(e,t):e:Q(e)?dt(e,t):A.always(e)}),tt=function(t,e){return nt.apply(null,[t].concat(At.call(e)))},H=function(t,e,n,r){var i;return e instanceof y?(i=e.sampledBy(t,function(t,e){return[t,e]}),r.call(i,function(t){var e,n;return e=t[0],n=t[1],e}).map(function(t){var e,n;return e=t[0],n=t[1]})):(e=tt(e,n),r.call(t,e))},ht=function(t){var e;if(A.isFunction(t))return t;if(Q(t))return e=vt(t),function(t,n){return t[e](n)};throw new p("not a function or a field key: "+t)},vt=function(t){return t.slice(1)},w=function(){function t(t){this.value=t}return t.prototype.getOrElse=function(){return this.value},t.prototype.get=function(){return this.value},t.prototype.filter=function(e){return e(this.value)?new t(this.value):m},t.prototype.map=function(e){return new t(e(this.value))},t.prototype.forEach=function(t){return t(this.value)},t.prototype.isDefined=!0,t.prototype.toArray=function(){return[this.value]},t.prototype.inspect=function(){return"Some("+this.value+")"},t.prototype.toString=function(){return this.inspect()},t}(),m={getOrElse:function(t){return t},filter:function(){return m},map:function(){return m},forEach:function(){},isDefined:!1,toArray:function(){return[]},inspect:function(){return"None"},toString:function(){return this.inspect()}},mt=function(t){return t instanceof w||t===m?t:new w(t)},t.noMore=["<no-more>"],t.more=["<more>"],N=0,l=function(){function t(){this.id=++N}return t.prototype.isEvent=function(){return!0},t.prototype.isEnd=function(){return!1},t.prototype.isInitial=function(){return!1},t.prototype.isNext=function(){return!1},t.prototype.isError=function(){return!1},t.prototype.hasValue=function(){return!1},t.prototype.filter=function(){return!0},t.prototype.inspect=function(){return this.toString()},t.prototype.log=function(){return this.toString()},t}(),v=function(t){function e(t,n){return this instanceof e?(e.__super__.constructor.call(this),void(!n&&A.isFunction(t)||t instanceof e?(this.valueF=t,this.valueInternal=void 0):(this.valueF=void 0,this.valueInternal=t))):new e(t,n)}return Et(e,t),e.prototype.isNext=function(){return!0},e.prototype.hasValue=function(){return!0},e.prototype.value=function(){return this.valueF instanceof e?(this.valueInternal=this.valueF.value(),this.valueF=void 0):this.valueF&&(this.valueInternal=this.valueF(),this.valueF=void 0),this.valueInternal},e.prototype.fmap=function(t){var e,n;return this.valueInternal?(n=this.valueInternal,this.apply(function(){return t(n)})):(e=this,this.apply(function(){return t(e.value())}))},e.prototype.apply=function(t){return new e(t)},e.prototype.filter=function(t){return t(this.value())},e.prototype.toString=function(){return A.toString(this.value())},e.prototype.log=function(){return this.value()},e}(l),d=function(t){function e(t,n){return this instanceof e?void e.__super__.constructor.call(this,t,n):new e(t,n)}return Et(e,t),e.prototype.isInitial=function(){return!0},e.prototype.isNext=function(){return!1},e.prototype.apply=function(t){return new e(t)},e.prototype.toNext=function(){return new v(this)},e}(v),c=function(t){function e(){return this instanceof e?void 0:new e}return Et(e,t),e.prototype.isEnd=function(){return!0},e.prototype.fmap=function(){return this},e.prototype.apply=function(){return this},e.prototype.toString=function(){return"<end>"},e}(l),f=function(t){function e(t){return this instanceof e?void(this.error=t):new e(t)}return Et(e,t),e.prototype.isError=function(){return!0},e.prototype.fmap=function(){return this},e.prototype.apply=function(){return this},e.prototype.toString=function(){return"<error> "+A.toString(this.error)},e}(l),t.Event=l,t.Initial=d,t.Next=v,t.End=c,t.Error=f,z=function(t){return new d(t,!0)},ot=function(t){return new v(t,!0)},U=function(){return new c},pt=function(t){return t instanceof l?t:ot(t)},K=0,ft=function(){},g=function(){function t(t){this.desc=t,this.id=++K,this.initialDesc=this.desc}return t.prototype.subscribe=function(t){return E.wrappedSubscribe(this,t)},t.prototype.subscribeInternal=function(t){return this.dispatcher.subscribe(t)},t.prototype.onValue=function(){var t;return t=et(arguments),this.subscribe(function(e){return e.hasValue()?t(e.value()):void 0})},t.prototype.onValues=function(t){return this.onValue(function(e){return t.apply(null,e)})},t.prototype.onError=function(){var t;return t=et(arguments),this.subscribe(function(e){return e.isError()?t(e.error):void 0})},t.prototype.onEnd=function(){var t;return t=et(arguments),this.subscribe(function(e){return e.isEnd()?t():void 0})},t.prototype.name=function(t){return this._name=t,this},t.prototype.withDescription=function(){return this.desc=V.apply(null,arguments),this},t.prototype.toString=function(){return this._name?this._name:this.desc.toString()},t.prototype.internalDeps=function(){return this.initialDesc.deps()},t}(),g.prototype.assign=g.prototype.onValue,g.prototype.forEach=g.prototype.onValue,g.prototype.inspect=g.prototype.toString,t.Observable=g,o=function(){function t(t){var e,n,r;for(null==t&&(t=[]),this.unsubscribe=St(this.unsubscribe,this),this.unsubscribed=!1,this.subscriptions=[],this.starting=[],e=0,n=t.length;n>e;e++)r=t[e],this.add(r)}return t.prototype.add=function(t){var e,n,r;if(!this.unsubscribed)return e=!1,n=ut,this.starting.push(t),r=function(r){return function(){return r.unsubscribed?void 0:(e=!0,r.remove(n),A.remove(t,r.starting))}}(this),n=t(this.unsubscribe,r),this.unsubscribed||e?n():this.subscriptions.push(n),A.remove(t,this.starting),n},t.prototype.remove=function(t){return this.unsubscribed?void 0:void 0!==A.remove(t,this.subscriptions)?t():void 0},t.prototype.unsubscribe=function(){var t,e,n,r;if(!this.unsubscribed){for(this.unsubscribed=!0,n=this.subscriptions,t=0,e=n.length;e>t;t++)(r=n[t])();return this.subscriptions=[],this.starting=[]}},t.prototype.count=function(){return this.unsubscribed?0:this.subscriptions.length+this.starting.length},t.prototype.empty=function(){return 0===this.count()},t}(),t.CompositeUnsubscribe=o,a=function(){function e(t,e){this._subscribe=t,this._handleEvent=e,this.subscribe=St(this.subscribe,this),this.handleEvent=St(this.handleEvent,this),this.subscriptions=[],this.queue=[]}return e.prototype.pushing=!1,e.prototype.ended=!1,e.prototype.prevError=void 0,e.prototype.unsubSrc=void 0,e.prototype.hasSubscribers=function(){return this.subscriptions.length>0},e.prototype.removeSub=function(t){return this.subscriptions=A.without(t,this.subscriptions)},e.prototype.push=function(t){return t.isEnd()&&(this.ended=!0),E.inTransaction(t,this,this.pushIt,[t])},e.prototype.pushToSubscriptions=function(e){var n,r,i,o,u,s;try{for(s=this.subscriptions,r=0,i=s.length;i>r;r++)u=s[r],o=u.sink(e),(o===t.noMore||e.isEnd())&&this.removeSub(u);return!0}catch(a){throw n=a,this.pushing=!1,this.queue=[],n}},e.prototype.pushIt=function(e){if(this.pushing)return this.queue.push(e),t.more;if(e!==this.prevError){for(e.isError()&&(this.prevError=e),this.pushing=!0,this.pushToSubscriptions(e),this.pushing=!1;this.queue.length;)e=this.queue.shift(),this.push(e);return this.hasSubscribers()?t.more:(this.unsubscribeFromSource(),t.noMore)}},e.prototype.handleEvent=function(t){return this._handleEvent?this._handleEvent(t):this.push(t)},e.prototype.unsubscribeFromSource=function(){return this.unsubSrc&&this.unsubSrc(),this.unsubSrc=void 0},e.prototype.subscribe=function(t){var e;return this.ended?(t(U()),ut):(x(t),e={sink:t},this.subscriptions.push(e),1===this.subscriptions.length&&(this.unsubSrc=this._subscribe(this.handleEvent),x(this.unsubSrc)),function(t){return function(){return t.removeSub(e),t.hasSubscribers()?void 0:t.unsubscribeFromSource()}}(this))},e}(),t.Dispatcher=a,h=function(e){function n(t,e,r){return this instanceof n?(A.isFunction(t)&&(r=e,e=t,t=s.empty),n.__super__.constructor.call(this,t),x(e),this.dispatcher=new a(e,r),void ft(this)):new n(t,e,r)}return Et(n,e),n.prototype.toProperty=function(e){var n,r;return r=0===arguments.length?m:mt(function(){return e}),n=this.dispatcher,new y(new t.Desc(this,"toProperty",[e]),function(e){var i,o,u,s;return i=!1,s=ut,o=t.more,u=function(){return i?void 0:r.forEach(function(n){return i=!0,o=e(new d(n)),o===t.noMore?(s(),s=ut):void 0})},s=n.subscribe(function(n){return n.hasValue()?i&&n.isInitial()?t.more:(n.isInitial()||u(),i=!0,r=new w(n),e(n)):(n.isEnd()&&(o=u()),o!==t.noMore?e(n):void 0)}),u(),s})},n.prototype.toEventStream=function(){return this},n.prototype.withHandler=function(e){return new n(new t.Desc(this,"withHandler",[e]),this.dispatcher.subscribe,e)},n}(g),t.EventStream=h,t.never=function(){return new h(V(t,"never"),function(t){return t(U()),ut})},t.when=function(){var e,n,r,i,o,u,s,a,c,f,l,p,d,v,m,g,y,b,w,S;if(0===arguments.length)return t.never();for(s=arguments.length,S="when: expecting arguments in the form (Observable+,function)+",D(S,s%2===0),b=[],d=[],n=0,v=[];s>n;){for(v[n]=arguments[n],v[n+1]=arguments[n+1],p=A.toArray(arguments[n]),e=q(arguments[n+1]),l={f:e,ixs:[]},w=!1,o=0,a=p.length;a>o;o++){for(y=p[o],r=A.indexOf(b,y),w||(w=k.isTrigger(y)),0>r&&(b.push(y),r=b.length-1),m=l.ixs,u=0,c=m.length;c>u;u++)i=m[u],i.index===r&&i.count++;l.ixs.push({index:r,count:1})}D("At least one EventStream required",w||!p.length),p.length>0&&d.push(l),n+=2}return b.length?(b=A.map(k.fromObservable,b),f=A.any(b,function(t){return t.flatten})&&j(A.map(function(t){return t.obs},b)),g=new h(new t.Desc(t,"when",v),function(e){var r,i,o,u,s,a,c;return c=[],o=!1,u=function(t){var e,r,i;for(i=t.ixs,e=0,r=i.length;r>e;e++)if(n=i[e],!b[n.index].hasAtLeast(n.count))return!1;return!0},i=function(t){return!t.sync||t.ended},r=function(t){var e,r,i;for(i=t.ixs,e=0,r=i.length;r>e;e++)if(n=i[e],!b[n.index].mayHave(n.count))return!0},s=function(t){return!t.source.flatten},a=function(a){return function(l){var h,p,v;return p=function(){return E.whenDoneWith(g,h)},v=function(){var r,i,o,a,f,l;if(!(c.length>0))return t.more;for(f=t.more,l=c.pop(),i=0,o=d.length;o>i;i++)if(a=d[i],u(a))return r=function(){var t,e,r,i;for(r=a.ixs,i=[],e=0,t=r.length;t>e;e++)n=r[e],i.push(b[n.index].consume());return i}(),f=e(l.e.apply(function(){var t,e;return e=function(){var e,n,i;for(i=[],n=0,e=r.length;e>n;n++)t=r[n],i.push(t.value());return i}(),a.f.apply(a,e)})),c.length&&(c=A.filter(s,c)),f===t.noMore?f:v()},h=function(){var n;return n=v(),o&&(A.all(b,i)||A.all(d,r))&&(n=t.noMore,e(U())),n===t.noMore&&l(),n},a.subscribe(function(n){var r;return n.isEnd()?(o=!0,a.markEnded(),p()):n.isError()?r=e(n):(a.push(n),a.sync&&(c.push({source:a,e:n}),f||E.hasWaiters()?p():h())),r===t.noMore&&l(),r||t.more})}},new t.CompositeUnsubscribe(function(){var t,e,n;for(n=[],t=0,e=b.length;e>t;t++)y=b[t],n.push(a(y));return n}()).unsubscribe})):t.never()},j=function(t,e){var n;return null==e&&(e=[]),n=function(t){var r;return A.contains(e,t)?!0:(r=t.internalDeps(),r.length?(e.push(t),A.any(r,n)):(e.push(t),!1))},A.any(t,n)},q=function(t){return A.isFunction(t)?t:A.always(t)},t.groupSimultaneous=function(){var e,n,i;return i=1<=arguments.length?At.call(arguments,0):[],1===i.length&&R(i[0])&&(i=i[0]),n=function(){var t,n,o;for(o=[],t=0,n=i.length;n>t;t++)e=i[t],o.push(new r(e));return o}(),bt(new t.Desc(t,"groupSimultaneous",i),t.when(n,function(){var t;return t=1<=arguments.length?At.call(arguments,0):[]}))},b=function(e){function n(t,e,r){this.property=t,this.subscribe=St(this.subscribe,this),n.__super__.constructor.call(this,e,r),this.current=m,this.currentValueRootId=void 0,this.propertyEnded=!1}return Et(n,e),n.prototype.push=function(t){return t.isEnd()&&(this.propertyEnded=!0),t.hasValue()&&(this.current=new w(t),this.currentValueRootId=E.currentEventId()),n.__super__.push.call(this,t)},n.prototype.maybeSubSource=function(e,n){return n===t.noMore?ut:this.propertyEnded?(e(U()),ut):a.prototype.subscribe.call(this,e)},n.prototype.subscribe=function(e){var n,r,i,o;return r=!1,i=t.more,this.current.isDefined&&(this.hasSubscribers()||this.propertyEnded)?(n=E.currentEventId(),o=this.currentValueRootId,!this.propertyEnded&&o&&n&&n!==o?(E.whenDoneWith(this.property,function(t){return function(){return t.currentValueRootId===o?e(z(t.current.get().value())):void 0}}(this)),this.maybeSubSource(e,i)):(E.inTransaction(void 0,this,function(){return i=e(z(this.current.get().value()))},[]),this.maybeSubSource(e,i))):this.maybeSubSource(e,i)},n}(a),y=function(e){function n(t,e,r){n.__super__.constructor.call(this,t),x(e),this.dispatcher=new b(this,e,r),ft(this)}return Et(n,e),n.prototype.changes=function(){return new h(new t.Desc(this,"changes",[]),function(t){return function(e){return t.dispatcher.subscribe(function(t){return t.isInitial()?void 0:e(t)})}}(this))},n.prototype.withHandler=function(e){return new n(new t.Desc(this,"withHandler",[e]),this.dispatcher.subscribe,e)},n.prototype.toProperty=function(){return M(arguments),this},n.prototype.toEventStream=function(){return new h(new t.Desc(this,"toEventStream",[]),function(t){return function(e){return t.dispatcher.subscribe(function(t){return t.isInitial()&&(t=t.toNext()),e(t)})}}(this))},n}(g),t.Property=y,t.constant=function(e){return new y(new t.Desc(t,"constant",[e]),function(t){return t(z(e)),t(U()),ut})},t.fromBinder=function(e,n){return null==n&&(n=A.id),new h(new t.Desc(t,"fromBinder",[e,n]),function(r){var i,o,u,s;return s=!1,i=!1,o=function(){return s?void 0:"undefined"!=typeof u&&null!==u?(u(),s=!0):i=!0},u=e(function(){var e,i,u,s,a,c;for(e=1<=arguments.length?At.call(arguments,0):[],c=n.apply(this,e),R(c)&&A.last(c)instanceof l||(c=[c]),a=t.more,u=0,s=c.length;s>u;u++)if(i=c[u],a=r(i=pt(i)),a===t.noMore||i.isEnd())return o(),a;return a}),i&&o(),o})},F=[["addEventListener","removeEventListener"],["addListener","removeListener"],["on","off"],["bind","unbind"]],Z=function(t){var e,n,r,i;for(e=0,n=F.length;n>e;e++)if(i=F[e],r=[t[i[0]],t[i[1]]],r[0]&&r[1])return r;throw new f("No suitable event methods in "+t)},t.fromEventTarget=function(e,n,r){var i,o,u;return i=Z(e),o=i[0],u=i[1],bt(new t.Desc(t,"fromEvent",[e,n]),t.fromBinder(function(t){return o.call(e,n,t),function(){return u.call(e,n,t)}},r))},t.fromEvent=t.fromEventTarget,t.Observable.prototype.map=function(){var e,n;return n=arguments[0],e=2<=arguments.length?At.call(arguments,1):[],H(this,n,e,function(e){return bt(new t.Desc(this,"map",[e]),this.withHandler(function(t){return this.push(t.fmap(e))}))})},_=function(t){return R(t[0])?t[0]:Array.prototype.slice.call(t)},I=function(t){return A.isFunction(t[0])?[_(Array.prototype.slice.call(t,1)),t[0]]:[_(Array.prototype.slice.call(t,0,t.length-1)),A.last(t)]},t.combineAsArray=function(){var e,n,r,i,o,u,s;for(s=_(arguments),e=n=0,r=s.length;r>n;e=++n)u=s[e],Y(u)||(s[e]=t.constant(u));return s.length?(o=function(){var t,e,n;for(n=[],t=0,e=s.length;e>t;t++)i=s[t],n.push(new k(i,!0));return n}(),bt(new t.Desc(t,"combineAsArray",s),t.when(o,function(){var t;return t=1<=arguments.length?At.call(arguments,0):[]}).toProperty())):t.constant([])},t.onValues=function(){var e,n,r;return r=2<=arguments.length?At.call(arguments,0,n=arguments.length-1):(n=0,[]),e=arguments[n++],t.combineAsArray(r).onValues(e)},t.combineWith=function(){var e,n,r;return n=I(arguments),r=n[0],e=n[1],bt(new t.Desc(t,"combineWith",[e].concat(At.call(r))),t.combineAsArray(r).map(function(t){return e.apply(null,t)}))},t.Observable.prototype.combine=function(e,n){var r;return r=ht(n),bt(new t.Desc(this,"combine",[e,n]),t.combineAsArray(this,e).map(function(t){return r(t[0],t[1])}))},t.Observable.prototype.withStateMachine=function(e,n){var r;return r=e,bt(new t.Desc(this,"withStateMachine",[e,n]),this.withHandler(function(e){var i,o,u,s,a,c,f;for(i=n(r,e),s=i[0],c=i[1],r=s,f=t.more,o=0,u=c.length;u>o;o++)if(a=c[o],f=this.push(a),f===t.noMore)return f;return f}))},t.Observable.prototype.skipDuplicates=function(e){return null==e&&(e=function(t,e){return t===e}),bt(new t.Desc(this,"skipDuplicates",[]),this.withStateMachine(m,function(t,n){return n.hasValue()?n.isInitial()||t===m||!e(t.get(),n.value())?[new w(n.value()),[n]]:[t,[]]:[t,[n]]}))},t.Observable.prototype.awaiting=function(e){return bt(new t.Desc(this,"awaiting",[e]),t.groupSimultaneous(this,e).map(function(t){var e,n;return e=t[0],n=t[1],0===n.length}).toProperty(!1).skipDuplicates())},t.Observable.prototype.not=function(){return bt(new t.Desc(this,"not",[]),this.map(function(t){return!t}))},t.Property.prototype.and=function(e){return bt(new t.Desc(this,"and",[e]),this.combine(e,function(t,e){return t&&e}))},t.Property.prototype.or=function(e){return bt(new t.Desc(this,"or",[e]),this.combine(e,function(t,e){return t||e}))},t.scheduler={setTimeout:function(t,e){return setTimeout(t,e)},setInterval:function(t,e){return setInterval(t,e)},clearInterval:function(t){return clearInterval(t)},clearTimeout:function(t){return clearTimeout(t)},now:function(){return(new Date).getTime()}},t.EventStream.prototype.bufferWithTime=function(e){return bt(new t.Desc(this,"bufferWithTime",[e]),this.bufferWithTimeOrCount(e,Number.MAX_VALUE))},t.EventStream.prototype.bufferWithCount=function(e){return bt(new t.Desc(this,"bufferWithCount",[e]),this.bufferWithTimeOrCount(void 0,e))},t.EventStream.prototype.bufferWithTimeOrCount=function(e,n){var r;return r=function(t){return t.values.length===n?t.flush():void 0!==e?t.schedule():void 0},bt(new t.Desc(this,"bufferWithTimeOrCount",[e,n]),this.buffer(e,r,r))},t.EventStream.prototype.buffer=function(e,n,r){var i,o,u;return null==n&&(n=ut),null==r&&(r=ut),i={scheduled:null,end:void 0,values:[],flush:function(){var e,n;if(this.scheduled&&(t.scheduler.clearTimeout(this.scheduled),this.scheduled=null),this.values.length>0){if(n=this.values,this.values=[],e=this.push(ot(n)),null!=this.end)return this.push(this.end);if(e!==t.noMore)return r(this)}else if(null!=this.end)return this.push(this.end)},schedule:function(){return this.scheduled?void 0:this.scheduled=e(function(t){return function(){return t.flush()}}(this))}},u=t.more,A.isFunction(e)||(o=e,e=function(e){return t.scheduler.setTimeout(e,o)}),bt(new t.Desc(this,"buffer",[]),this.withHandler(function(t){return i.push=function(t){return function(e){return t.push(e)}}(this),t.isError()?u=this.push(t):t.isEnd()?(i.end=t,i.scheduled||i.flush()):(i.values.push(t.value()),n(i)),u}))},t.Observable.prototype.filter=function(){var e,n;return n=arguments[0],e=2<=arguments.length?At.call(arguments,1):[],L(n),H(this,n,e,function(e){return bt(new t.Desc(this,"filter",[e]),this.withHandler(function(n){return n.filter(e)?this.push(n):t.more}))})},t.once=function(e){return new h(new s(t,"once",[e]),function(t){return t(pt(e)),t(U()),ut})},t.EventStream.prototype.concat=function(e){var n;return n=this,new h(new t.Desc(n,"concat",[e]),function(t){var r,i;return i=ut,r=n.dispatcher.subscribe(function(n){return n.isEnd()?i=e.dispatcher.subscribe(t):t(n)}),function(){return r(),i()}})},t.Observable.prototype.flatMap=function(){return $(this,it(arguments))},t.Observable.prototype.flatMapFirst=function(){return $(this,it(arguments),!0)},$=function(e,n,r,i){var u,s,a;return a=[e],u=[],s=new h(new t.Desc(e,"flatMap"+(r?"First":""),[n]),function(s){var a,c,f,l,h;return f=new o,l=[],h=function(e){var r;return r=rt(n(e.value())),u.push(r),f.add(function(e,n){return r.dispatcher.subscribe(function(i){var o;return i.isEnd()?(A.remove(r,u),c(),a(n),t.noMore):(i instanceof d&&(i=i.toNext()),o=s(i),o===t.noMore&&e(),o)})})},c=function(){var t;return t=l.shift(),t?h(t):void 0},a=function(t){return t(),f.empty()?s(U()):void 0},f.add(function(n,o){return e.dispatcher.subscribe(function(e){return e.isEnd()?a(o):e.isError()?s(e):r&&f.count()>1?t.more:f.unsubscribed?t.noMore:i&&f.count()>i?l.push(e):h(e)})}),f.unsubscribe}),s.internalDeps=function(){return u.length?a.concat(u):a},s},it=function(t){return 1===t.length&&Y(t[0])?A.always(t[0]):et(t)},rt=function(e){return Y(e)?e:t.once(e)},t.Observable.prototype.flatMapWithConcurrencyLimit=function(){var e,n;return n=arguments[0],e=2<=arguments.length?At.call(arguments,1):[],bt(new t.Desc(this,"flatMapWithConcurrencyLimit",[n].concat(At.call(e))),$(this,it(e),!1,n))},t.Observable.prototype.flatMapConcat=function(){return bt(new t.Desc(this,"flatMapConcat",Array.prototype.slice.call(arguments,0)),this.flatMapWithConcurrencyLimit.apply(this,[1].concat(At.call(arguments))))},t.later=function(e,n){return bt(new t.Desc(t,"later",[e,n]),t.fromBinder(function(r){var i,o;return o=function(){return r([n,U()])},i=t.scheduler.setTimeout(o,e),function(){return t.scheduler.clearTimeout(i)}}))},t.Observable.prototype.bufferingThrottle=function(e){return bt(new t.Desc(this,"bufferingThrottle",[e]),this.flatMapConcat(function(n){return t.once(n).concat(t.later(e).filter(!1))}))},t.Property.prototype.bufferingThrottle=function(){return t.Observable.prototype.bufferingThrottle.apply(this,arguments).toProperty()},i=function(e){function n(){return this.guardedSink=St(this.guardedSink,this),this.subscribeAll=St(this.subscribeAll,this),this.unsubAll=St(this.unsubAll,this),this instanceof n?(this.sink=void 0,this.subscriptions=[],this.ended=!1,void n.__super__.constructor.call(this,new t.Desc(t,"Bus",[]),this.subscribeAll)):new n}return Et(n,e),n.prototype.unsubAll=function(){var t,e,n,r;for(n=this.subscriptions,t=0,e=n.length;e>t;t++)r=n[t],"function"==typeof r.unsub&&r.unsub();return void 0},n.prototype.subscribeAll=function(t){var e,n,r,i;if(this.ended)t(U());else for(this.sink=t,r=P(this.subscriptions),e=0,n=r.length;n>e;e++)i=r[e],this.subscribeInput(i);return this.unsubAll},n.prototype.guardedSink=function(e){return function(n){return function(r){return r.isEnd()?(n.unsubscribeInput(e),t.noMore):n.sink(r)}}(this)},n.prototype.subscribeInput=function(t){return t.unsub=t.input.dispatcher.subscribe(this.guardedSink(t.input))},n.prototype.unsubscribeInput=function(t){var e,n,r,i,o;for(i=this.subscriptions,e=n=0,r=i.length;r>n;e=++n)if(o=i[e],o.input===t)return"function"==typeof o.unsub&&o.unsub(),void this.subscriptions.splice(e,1)},n.prototype.plug=function(t){var e;return O(t),this.ended?void 0:(e={input:t},this.subscriptions.push(e),null!=this.sink&&this.subscribeInput(e),function(e){return function(){return e.unsubscribeInput(t)}}(this))},n.prototype.end=function(){return this.ended=!0,this.unsubAll(),"function"==typeof this.sink?this.sink(U()):void 0},n.prototype.push=function(t){return this.ended?void 0:"function"==typeof this.sink?this.sink(ot(t)):void 0},n.prototype.error=function(t){return"function"==typeof this.sink?this.sink(new f(t)):void 0},n}(h),t.Bus=i,X=function(e,n){return wt(function(){var r,i,o;return i=arguments[0],r=2<=arguments.length?At.call(arguments,1):[],o=st(n,[function(t,e){return i.apply(null,At.call(t).concat([e]))}]),bt(new t.Desc(t,e,[i].concat(At.call(r))),t.combineAsArray(r).flatMap(o))})},t.fromCallback=X("fromCallback",function(){var e,n;return n=arguments[0],e=2<=arguments.length?At.call(arguments,1):[],t.fromBinder(function(t){return tt(n,e)(t),ut},function(t){return[t,U()]})}),t.fromNodeCallback=X("fromNodeCallback",function(){var e,n;return n=arguments[0],e=2<=arguments.length?At.call(arguments,1):[],t.fromBinder(function(t){return tt(n,e)(t),ut},function(t,e){return t?[new f(t),U()]:[e,U()]})}),t.combineTemplate=function(e){var n,r,i,o,u,s,a,c,f,l,h;return a=[],h=[],s=function(t){return t[t.length-1]},l=function(t,e,n){return s(t)[e]=n},n=function(t,e){return function(n,r){return l(n,t,r[e])}},u=function(t,e){return function(n){return l(n,t,e)}},c=function(t){return R(t)?[]:{}},f=function(t,e){return function(n){var r;return r=c(e),l(n,t,r),n.push(r)}},i=function(t,e){var r;return Y(e)?(h.push(e),a.push(n(t,h.length-1))):e!==Object(e)||"function"==typeof e||e instanceof RegExp||e instanceof Date?a.push(u(t,e)):(r=function(t){return t.pop()},a.push(f(t,e)),o(e),a.push(r))},o=function(t){return A.each(t,i)},o(e),r=function(t){var n,r,i,o,u;for(u=c(e),n=[u],i=0,o=a.length;o>i;i++)(r=a[i])(n,t);return u},bt(new t.Desc(t,"combineTemplate",[e]),t.combineAsArray(h).map(r))},S=function(e,n){var r;return r=new h(V(e,"justInitValue"),function(n){var i,o;return o=void 0,i=e.dispatcher.subscribe(function(e){return e.isEnd()||(o=e),t.noMore}),E.whenDoneWith(r,function(){return null!=o&&n(o),n(U())}),i}),r.concat(n).toProperty()},t.Observable.prototype.mapEnd=function(){var e;return e=et(arguments),
bt(new t.Desc(this,"mapEnd",[e]),this.withHandler(function(n){return n.isEnd()?(this.push(ot(e(n))),this.push(U()),t.noMore):this.push(n)}))},t.Observable.prototype.skipErrors=function(){return bt(new t.Desc(this,"skipErrors",[]),this.withHandler(function(e){return e.isError()?t.more:this.push(e)}))},t.EventStream.prototype.takeUntil=function(e){var n;return n={},bt(new t.Desc(this,"takeUntil",[e]),t.groupSimultaneous(this.mapEnd(n),e.skipErrors()).withHandler(function(r){var i,o,u,s,a,c;if(r.hasValue()){if(s=r.value(),i=s[0],e=s[1],e.length)return this.push(U());for(a=t.more,o=0,u=i.length;u>o;o++)c=i[o],a=c===n?this.push(U()):this.push(ot(c));return a}return this.push(r)}))},t.Property.prototype.takeUntil=function(e){var n;return n=this.changes().takeUntil(e),bt(new t.Desc(this,"takeUntil",[e]),S(this,n))},t.Observable.prototype.flatMapLatest=function(){var e,n;return e=it(arguments),n=this.toEventStream(),bt(new t.Desc(this,"flatMapLatest",[e]),n.flatMap(function(t){return rt(e(t)).takeUntil(n)}))},t.Property.prototype.delayChanges=function(t,e){return bt(t,S(this,e(this.changes())))},t.EventStream.prototype.delay=function(e){return bt(new t.Desc(this,"delay",[e]),this.flatMap(function(n){return t.later(e,n)}))},t.Property.prototype.delay=function(e){return this.delayChanges(new t.Desc(this,"delay",[e]),function(t){return t.delay(e)})},t.EventStream.prototype.debounce=function(e){return bt(new t.Desc(this,"debounce",[e]),this.flatMapLatest(function(n){return t.later(e,n)}))},t.Property.prototype.debounce=function(e){return this.delayChanges(new t.Desc(this,"debounce",[e]),function(t){return t.debounce(e)})},t.EventStream.prototype.debounceImmediate=function(e){return bt(new t.Desc(this,"debounceImmediate",[e]),this.flatMapFirst(function(n){return t.once(n).concat(t.later(e).filter(!1))}))},t.Observable.prototype.decode=function(e){return bt(new t.Desc(this,"decode",[e]),this.combine(t.combineTemplate(e),function(t,e){return e[t]}))},t.Observable.prototype.scan=function(e,n){var r,i,o,u;return n=ht(n),r=mt(e),i=!1,u=function(e){return function(u){var s,a,c,f;return s=!1,f=ut,a=t.more,c=function(){return s?void 0:r.forEach(function(e){return s=i=!0,a=u(new d(function(){return e})),a===t.noMore?(f(),f=ut):void 0})},f=e.dispatcher.subscribe(function(e){var o,f;return e.hasValue()?i&&e.isInitial()?t.more:(e.isInitial()||c(),s=i=!0,f=r.getOrElse(void 0),o=n(f,e.value()),r=new w(o),u(e.apply(function(){return o}))):(e.isEnd()&&(a=c()),a!==t.noMore?u(e):void 0)}),E.whenDoneWith(o,c),f}}(this),o=new y(new t.Desc(this,"scan",[e,n]),u)},t.Observable.prototype.diff=function(e,n){return n=ht(n),bt(new t.Desc(this,"diff",[e,n]),this.scan([e],function(t,e){return[e,n(t[0],e)]}).filter(function(t){return 2===t.length}).map(function(t){return t[1]}))},t.Observable.prototype.doAction=function(){var e;return e=et(arguments),bt(new t.Desc(this,"doAction",[e]),this.withHandler(function(t){return t.hasValue()&&e(t.value()),this.push(t)}))},t.Observable.prototype.doError=function(){var e;return e=et(arguments),bt(new t.Desc(this,"doError",[e]),this.withHandler(function(t){return t.isError()&&e(t.error),this.push(t)}))},t.Observable.prototype.doLog=function(){var e;return e=1<=arguments.length?At.call(arguments,0):[],bt(new t.Desc(this,"doLog",e),this.withHandler(function(t){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log&&console.log.apply(console,At.call(e).concat([t.log()])),this.push(t)}))},t.Observable.prototype.endOnError=function(){var e,n;return n=arguments[0],e=2<=arguments.length?At.call(arguments,1):[],null==n&&(n=!0),H(this,n,e,function(e){return bt(new t.Desc(this,"endOnError",[]),this.withHandler(function(t){return t.isError()&&e(t.error)?(this.push(t),this.push(U())):this.push(t)}))})},g.prototype.errors=function(){return bt(new t.Desc(this,"errors",[]),this.filter(function(){return!1}))},yt=function(t){return[t,U()]},t.fromPromise=function(e,n,r){return null==r&&(r=yt),bt(new t.Desc(t,"fromPromise",[e]),t.fromBinder(function(t){var r;return null!=(r=e.then(t,function(e){return t(new f(e))}))&&"function"==typeof r.done&&r.done(),function(){return n&&"function"==typeof e.abort?e.abort():void 0}},r))},t.Observable.prototype.mapError=function(){var e;return e=et(arguments),bt(new t.Desc(this,"mapError",[e]),this.withHandler(function(t){return t.isError()?this.push(ot(e(t.error))):this.push(t)}))},t.Observable.prototype.flatMapError=function(e){return bt(new t.Desc(this,"flatMapError",[e]),this.mapError(function(t){return new f(t)}).flatMap(function(n){return n instanceof f?e(n.error):t.once(n)}))},t.EventStream.prototype.sampledBy=function(e,n){return bt(new t.Desc(this,"sampledBy",[e,n]),this.toProperty().sampledBy(e,n))},t.Property.prototype.sampledBy=function(e,n){var r,i,o,u,s;return null!=n?n=ht(n):(r=!0,n=function(t){return t.value()}),s=new k(this,!1,r),o=new k(e,!0,r),u=t.when([s,o],n),i=e instanceof y?u.toProperty():u,bt(new t.Desc(this,"sampledBy",[e,n]),i)},t.Property.prototype.sample=function(e){return bt(new t.Desc(this,"sample",[e]),this.sampledBy(t.interval(e,{})))},t.Observable.prototype.map=function(){var e,n;return n=arguments[0],e=2<=arguments.length?At.call(arguments,1):[],n instanceof y?n.sampledBy(this,W):H(this,n,e,function(e){return bt(new t.Desc(this,"map",[e]),this.withHandler(function(t){return this.push(t.fmap(e))}))})},t.Observable.prototype.fold=function(e,n){return bt(new t.Desc(this,"fold",[e,n]),this.scan(e,n).sampledBy(this.filter(!1).mapEnd().toProperty()))},g.prototype.reduce=g.prototype.fold,t.fromPoll=function(e,n){return bt(new t.Desc(t,"fromPoll",[e,n]),t.fromBinder(function(n){var r;return r=t.scheduler.setInterval(n,e),function(){return t.scheduler.clearInterval(r)}},n))},t.Observable.prototype.groupBy=function(e,n){var r,i;return null==n&&(n=t._.id),i={},r=this,r.filter(function(t){return!i[e(t)]}).map(function(o){var u,s,a,c;return s=e(o),c=r.filter(function(t){return e(t)===s}),u=t.once(o).concat(c),a=n(u,o).withHandler(function(t){return this.push(t),t.isEnd()?delete i[s]:void 0}),i[s]=a})},t.fromArray=function(e){var n;return T(e),e.length?(n=0,new h(new t.Desc(t,"fromArray",[e]),function(r){var i,o,u,s,a;return a=!1,s=t.more,u=!1,o=!1,i=function(){var c;if(o=!0,!u){for(u=!0;o;)o=!1,s===t.noMore||a||(c=e[n++],s=r(pt(c)),s!==t.noMore&&(n===e.length?r(U()):E.afterTransaction(i)));return u=!1}},i(),function(){return a=!0}})):bt(new t.Desc(t,"fromArray",e),t.never())},t.EventStream.prototype.holdWhen=function(e){var n,r,i;return r=!1,n=[],i=this,new h(new t.Desc(this,"holdWhen",[e]),function(t){var u,s,a;return u=new o,a=!1,s=function(e){return"function"==typeof e&&e(),u.empty()&&a?t(U()):void 0},u.add(function(i,o){return e.subscribeInternal(function(e){var i,u,a,c,f;if(!e.hasValue())return e.isEnd()?s(o):t(e);if(r=e.value(),!r){for(c=n,n=[],a=[],i=0,u=c.length;u>i;i++)f=c[i],a.push(t(ot(f)));return a}})}),u.add(function(e,o){return i.subscribeInternal(function(e){return r&&e.hasValue()?n.push(e.value()):e.isEnd()&&n.length?s(o):t(e)})}),a=!0,s(),u.unsubscribe})},t.interval=function(e,n){return null==n&&(n={}),bt(new t.Desc(t,"interval",[e,n]),t.fromPoll(e,function(){return ot(n)}))},t.$={},t.$.asEventStream=function(e,n,r){var i;return A.isFunction(n)&&(i=[n,void 0],r=i[0],n=i[1]),bt(new t.Desc(this.selector||this,"asEventStream",[e]),t.fromBinder(function(t){return function(r){return t.on(e,n,r),function(){return t.off(e,n,r)}}}(this),r))},null!=(ct="undefined"!=typeof jQuery&&null!==jQuery?jQuery:"undefined"!=typeof Zepto&&null!==Zepto?Zepto:void 0)&&(ct.fn.asEventStream=t.$.asEventStream),t.Observable.prototype.log=function(){var t;return t=1<=arguments.length?At.call(arguments,0):[],this.subscribe(function(e){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log.apply(console,At.call(t).concat([e.log()])):void 0}),this},t.EventStream.prototype.merge=function(e){var n;return B(e),n=this,bt(new t.Desc(n,"merge",[e]),t.mergeAll(this,e))},t.mergeAll=function(){var e;return e=_(arguments),e.length?new h(new t.Desc(t,"mergeAll",e),function(n){var r,i,o;return r=0,o=function(i){return function(o){return i.dispatcher.subscribe(function(i){var u;return i.isEnd()?(r++,r===e.length?n(U()):t.more):(u=n(i),u===t.noMore&&o(),u)})}},i=A.map(o,e),new t.CompositeUnsubscribe(i).unsubscribe}):t.never()},t.repeatedly=function(e,n){var r;return r=0,bt(new t.Desc(t,"repeatedly",[e,n]),t.fromPoll(e,function(){return n[r++%n.length]}))},t.repeat=function(e){var n;return n=0,t.fromBinder(function(r){var i,o,u,s,a;return i=!1,u=t.more,a=function(){},o=function(t){return t.isEnd()?i?s():i=!0:u=r(t)},s=function(){var s;for(i=!0;i&&u!==t.noMore;)s=e(n++),i=!1,s?a=s.subscribeInternal(o):r(U());return i=!0},s(),function(){return a()}})},t.retry=function(e){var n,r,i,o,u,s,a;if(!A.isFunction(e.source))throw new p("'source' option has to be a function");return a=e.source,s=e.retries||0,u=e.maxRetries||s,n=e.delay||function(){return 0},o=e.isRetryable||function(){return!0},i=!1,r=null,bt(new t.Desc(t,"retry",[e]),t.repeat(function(){var e,c,f;return i?null:(f=function(){return a().endOnError().withHandler(function(t){return t.isError()?(r=t,o(r.error)&&s>0?void 0:(i=!0,this.push(t))):(t.hasValue()&&(r=null,i=!0),this.push(t))})},r?(e={error:r.error,retriesDone:u-s},c=t.later(n(e)).filter(!1),s-=1,c.concat(t.once().flatMap(f))):f())}))},t.sequentially=function(e,n){var r;return r=0,bt(new t.Desc(t,"sequentially",[e,n]),t.fromPoll(e,function(){var t;return t=n[r++],r<n.length?t:r===n.length?[t,U()]:U()}))},t.Observable.prototype.skip=function(e){return bt(new t.Desc(this,"skip",[e]),this.withHandler(function(n){return n.hasValue()&&e>0?(e--,t.more):this.push(n)}))},t.Observable.prototype.take=function(e){return 0>=e?t.never():bt(new t.Desc(this,"take",[e]),this.withHandler(function(n){return n.hasValue()?(e--,e>0?this.push(n):(0===e&&this.push(n),this.push(U()),t.noMore)):this.push(n)}))},t.EventStream.prototype.skipUntil=function(e){var n;return n=e.take(1).map(!0).toProperty(!1),bt(new t.Desc(this,"skipUntil",[e]),this.filter(n))},t.EventStream.prototype.skipWhile=function(){var e,n,r;return n=arguments[0],e=2<=arguments.length?At.call(arguments,1):[],L(n),r=!1,H(this,n,e,function(e){return bt(new t.Desc(this,"skipWhile",[e]),this.withHandler(function(n){return!r&&n.hasValue()&&e(n.value())?t.more:(n.hasValue()&&(r=!0),this.push(n))}))})},t.Observable.prototype.slidingWindow=function(e,n){return null==n&&(n=0),bt(new t.Desc(this,"slidingWindow",[e,n]),this.scan([],function(t,n){return t.concat([n]).slice(-e)}).filter(function(t){return t.length>=n}))},t.spy=function(t){return lt.push(t)},lt=[],ft=function(t){var e,n,r;if(lt.length&&!ft.running)try{for(ft.running=!0,e=0,n=lt.length;n>e;e++)(r=lt[e])(t)}finally{delete ft.running}return void 0},t.Property.prototype.startWith=function(e){return bt(new t.Desc(this,"startWith",[e]),this.scan(e,function(t,e){return e}))},t.EventStream.prototype.startWith=function(e){return bt(new t.Desc(this,"startWith",[e]),t.once(e).concat(this))},t.Observable.prototype.takeWhile=function(){var e,n;return n=arguments[0],e=2<=arguments.length?At.call(arguments,1):[],L(n),H(this,n,e,function(e){return bt(new t.Desc(this,"takeWhile",[e]),this.withHandler(function(n){return n.filter(e)?this.push(n):(this.push(U()),t.noMore)}))})},t.update=function(){var e,n,r,i;for(n=arguments[0],i=2<=arguments.length?At.call(arguments,1):[],r=function(t){return function(){var e;return e=1<=arguments.length?At.call(arguments,0):[],function(n){return t.apply(null,[n].concat(e))}}},e=i.length-1;e>0;)i[e]instanceof Function||(i[e]=function(t){return function(){return t}}(i[e])),i[e]=r(i[e]),e-=2;return bt(new t.Desc(t,"update",[n].concat(At.call(i))),t.when.apply(t,i).scan(n,function(t,e){return e(t)}))},t.zipAsArray=function(){var e;return e=_(arguments),bt(new t.Desc(t,"zipAsArray",e),t.zipWith(e,function(){var t;return t=1<=arguments.length?At.call(arguments,0):[]}))},t.zipWith=function(){var e,n,r;return n=I(arguments),r=n[0],e=n[1],r=A.map(function(t){return t.toEventStream()},r),bt(new t.Desc(t,"zipWith",[e].concat(At.call(r))),t.when(r,e))},t.Observable.prototype.zip=function(e,n){return null==n&&(n=Array),bt(new t.Desc(this,"zip",[e]),t.zipWith([this,e],n))},t.Observable.prototype.first=function(){return bt(new t.Desc(this,"first",[]),this.take(1))},t.Observable.prototype.last=function(){var e;return bt(new t.Desc(this,"last",[]),this.withHandler(function(n){return n.isEnd()?(e&&this.push(e),this.push(U()),t.noMore):void(e=n)}))},t.EventStream.prototype.throttle=function(e){return bt(new t.Desc(this,"throttle",[e]),this.bufferWithTime(e).map(function(t){return t[t.length-1]}))},t.Property.prototype.throttle=function(e){return this.delayChanges(new t.Desc(this,"throttle",[e]),function(t){return t.throttle(e)})},g.prototype.firstToPromise=function(e){var n=this;if("function"!=typeof e){if("function"!=typeof Promise)throw new p("There isn't default Promise, use shim or parameter");e=Promise}return new e(function(e,r){return n.subscribe(function(n){return n.hasValue()&&e(n.value()),n.isError()&&r(n.error),t.noMore})})},g.prototype.toPromise=function(t){return this.last().firstToPromise(t)},"undefined"!=typeof define&&null!==define&&null!=define.amd?(define([],function(){return t}),"undefined"!=typeof this&&null!==this&&(this.Bacon=t)):"undefined"!=typeof e&&null!==e&&null!=e.exports?(e.exports=t,t.Bacon=t):this.Bacon=t}).call(this)}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../../../node_modules/baconjs/dist/Bacon.js","/../../../node_modules/baconjs/dist")},{"+7ZJp0":5,buffer:2}],2:[function(t,e,n){(function(e,r,i,o,u,s,a,c,f){function i(t,e,n){if(!(this instanceof i))return new i(t,e,n);var r=typeof t;if("base64"===e&&"string"===r)for(t=P(t);t.length%4!==0;)t+="=";var o;if("number"===r)o=j(t);else if("string"===r)o=i.byteLength(t,e);else{if("object"!==r)throw new Error("First argument needs to be a number, array or string.");o=j(t.length)}var u;i._useTypedArrays?u=i._augment(new Uint8Array(o)):(u=this,u.length=o,u._isBuffer=!0);var s;if(i._useTypedArrays&&"number"==typeof t.byteLength)u._set(t);else if(V(t))for(s=0;o>s;s++)i.isBuffer(t)?u[s]=t.readUInt8(s):u[s]=t[s];else if("string"===r)u.write(t,0,e);else if("number"===r&&!i._useTypedArrays&&!n)for(s=0;o>s;s++)u[s]=0;return u}function l(t,e,n,r){n=Number(n)||0;var o=t.length-n;r?(r=Number(r),r>o&&(r=o)):r=o;var u=e.length;Q(u%2===0,"Invalid hex string"),r>u/2&&(r=u/2);for(var s=0;r>s;s++){var a=parseInt(e.substr(2*s,2),16);Q(!isNaN(a),"Invalid hex string"),t[n+s]=a}return i._charsWritten=2*s,s}function h(t,e,n,r){var o=i._charsWritten=$(N(e),t,n,r);return o}function p(t,e,n,r){var o=i._charsWritten=$(F(e),t,n,r);return o}function d(t,e,n,r){return p(t,e,n,r)}function v(t,e,n,r){var o=i._charsWritten=$(Z(e),t,n,r);return o}function m(t,e,n,r){var o=i._charsWritten=$(J(e),t,n,r);return o}function g(t,e,n){return 0===e&&n===t.length?Y.fromByteArray(t):Y.fromByteArray(t.slice(e,n))}function y(t,e,n){var r="",i="";n=Math.min(t.length,n);for(var o=e;n>o;o++)t[o]<=127?(r+=W(i)+String.fromCharCode(t[o]),i=""):i+="%"+t[o].toString(16);return r+W(i)}function b(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;n>i;i++)r+=String.fromCharCode(t[i]);return r}function w(t,e,n){return b(t,e,n)}function k(t,e,n){var r=t.length;(!e||0>e)&&(e=0),(!n||0>n||n>r)&&(n=r);for(var i="",o=e;n>o;o++)i+=U(t[o]);return i}function E(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function A(t,e,n,r){r||(Q("boolean"==typeof n,"missing or invalid endian"),Q(void 0!==e&&null!==e,"missing offset"),Q(e+1<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var o;return n?(o=t[e],i>e+1&&(o|=t[e+1]<<8)):(o=t[e]<<8,i>e+1&&(o|=t[e+1])),o}}function S(t,e,n,r){r||(Q("boolean"==typeof n,"missing or invalid endian"),Q(void 0!==e&&null!==e,"missing offset"),Q(e+3<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var o;return n?(i>e+2&&(o=t[e+2]<<16),i>e+1&&(o|=t[e+1]<<8),o|=t[e],i>e+3&&(o+=t[e+3]<<24>>>0)):(i>e+1&&(o=t[e+1]<<16),i>e+2&&(o|=t[e+2]<<8),i>e+3&&(o|=t[e+3]),o+=t[e]<<24>>>0),o}}function _(t,e,n,r){r||(Q("boolean"==typeof n,"missing or invalid endian"),Q(void 0!==e&&null!==e,"missing offset"),Q(e+1<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var o=A(t,e,n,!0),u=32768&o;return u?-1*(65535-o+1):o}}function I(t,e,n,r){r||(Q("boolean"==typeof n,"missing or invalid endian"),Q(void 0!==e&&null!==e,"missing offset"),Q(e+3<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var o=S(t,e,n,!0),u=2147483648&o;return u?-1*(4294967295-o+1):o}}function D(t,e,n,r){return r||(Q("boolean"==typeof n,"missing or invalid endian"),Q(e+3<t.length,"Trying to read beyond buffer length")),G.read(t,e,n,23,4)}function T(t,e,n,r){return r||(Q("boolean"==typeof n,"missing or invalid endian"),Q(e+7<t.length,"Trying to read beyond buffer length")),G.read(t,e,n,52,8)}function B(t,e,n,r,i){i||(Q(void 0!==e&&null!==e,"missing value"),Q("boolean"==typeof r,"missing or invalid endian"),Q(void 0!==n&&null!==n,"missing offset"),Q(n+1<t.length,"trying to write beyond buffer length"),K(e,65535));var o=t.length;if(!(n>=o))for(var u=0,s=Math.min(o-n,2);s>u;u++)t[n+u]=(e&255<<8*(r?u:1-u))>>>8*(r?u:1-u)}function x(t,e,n,r,i){i||(Q(void 0!==e&&null!==e,"missing value"),Q("boolean"==typeof r,"missing or invalid endian"),Q(void 0!==n&&null!==n,"missing offset"),Q(n+3<t.length,"trying to write beyond buffer length"),K(e,4294967295));var o=t.length;if(!(n>=o))for(var u=0,s=Math.min(o-n,4);s>u;u++)t[n+u]=e>>>8*(r?u:3-u)&255}function M(t,e,n,r,i){i||(Q(void 0!==e&&null!==e,"missing value"),Q("boolean"==typeof r,"missing or invalid endian"),Q(void 0!==n&&null!==n,"missing offset"),Q(n+1<t.length,"Trying to write beyond buffer length"),z(e,32767,-32768));var o=t.length;n>=o||(e>=0?B(t,e,n,r,i):B(t,65535+e+1,n,r,i))}function O(t,e,n,r,i){i||(Q(void 0!==e&&null!==e,"missing value"),Q("boolean"==typeof r,"missing or invalid endian"),Q(void 0!==n&&null!==n,"missing offset"),Q(n+3<t.length,"Trying to write beyond buffer length"),z(e,2147483647,-2147483648));var o=t.length;n>=o||(e>=0?x(t,e,n,r,i):x(t,4294967295+e+1,n,r,i))}function L(t,e,n,r,i){i||(Q(void 0!==e&&null!==e,"missing value"),Q("boolean"==typeof r,"missing or invalid endian"),Q(void 0!==n&&null!==n,"missing offset"),Q(n+3<t.length,"Trying to write beyond buffer length"),R(e,3.4028234663852886e38,-3.4028234663852886e38));var o=t.length;n>=o||G.write(t,e,n,r,23,4)}function C(t,e,n,r,i){i||(Q(void 0!==e&&null!==e,"missing value"),Q("boolean"==typeof r,"missing or invalid endian"),Q(void 0!==n&&null!==n,"missing offset"),Q(n+7<t.length,"Trying to write beyond buffer length"),R(e,1.7976931348623157e308,-1.7976931348623157e308));var o=t.length;n>=o||G.write(t,e,n,r,52,8)}function P(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function q(t,e,n){return"number"!=typeof t?n:(t=~~t,t>=e?e:t>=0?t:(t+=e,t>=0?t:0))}function j(t){return t=~~Math.ceil(+t),0>t?0:t}function H(t){return(Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)})(t)}function V(t){return H(t)||i.isBuffer(t)||t&&"object"==typeof t&&"number"==typeof t.length}function U(t){return 16>t?"0"+t.toString(16):t.toString(16)}function N(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(127>=r)e.push(t.charCodeAt(n));else{var i=n;r>=55296&&57343>=r&&n++;for(var o=encodeURIComponent(t.slice(i,n+1)).substr(1).split("%"),u=0;u<o.length;u++)e.push(parseInt(o[u],16))}}return e}function F(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e}function J(t){for(var e,n,r,i=[],o=0;o<t.length;o++)e=t.charCodeAt(o),n=e>>8,r=e%256,i.push(r),i.push(n);return i}function Z(t){return Y.toByteArray(t)}function $(t,e,n,r){for(var i=0;r>i&&!(i+n>=e.length||i>=t.length);i++)e[i+n]=t[i];return i}function W(t){try{return decodeURIComponent(t)}catch(e){return String.fromCharCode(65533)}}function K(t,e){Q("number"==typeof t,"cannot write a non-number as a number"),Q(t>=0,"specified a negative value for writing an unsigned value"),Q(e>=t,"value is larger than maximum value for type"),Q(Math.floor(t)===t,"value has a fractional component")}function z(t,e,n){Q("number"==typeof t,"cannot write a non-number as a number"),Q(e>=t,"value larger than maximum allowed value"),Q(t>=n,"value smaller than minimum allowed value"),Q(Math.floor(t)===t,"value has a fractional component")}function R(t,e,n){Q("number"==typeof t,"cannot write a non-number as a number"),Q(e>=t,"value larger than maximum allowed value"),Q(t>=n,"value smaller than minimum allowed value")}function Q(t,e){if(!t)throw new Error(e||"Failed assertion")}var Y=t("base64-js"),G=t("ieee754");n.Buffer=i,n.SlowBuffer=i,n.INSPECT_MAX_BYTES=50,i.poolSize=8192,i._useTypedArrays=function(){try{var t=new ArrayBuffer(0),e=new Uint8Array(t);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray}catch(n){return!1}}(),i.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.isBuffer=function(t){return!(null===t||void 0===t||!t._isBuffer)},i.byteLength=function(t,e){var n;switch(t+="",e||"utf8"){case"hex":n=t.length/2;break;case"utf8":case"utf-8":n=N(t).length;break;case"ascii":case"binary":case"raw":n=t.length;break;case"base64":n=Z(t).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=2*t.length;break;default:throw new Error("Unknown encoding")}return n},i.concat=function(t,e){if(Q(H(t),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===t.length)return new i(0);if(1===t.length)return t[0];var n;if("number"!=typeof e)for(e=0,n=0;n<t.length;n++)e+=t[n].length;var r=new i(e),o=0;for(n=0;n<t.length;n++){var u=t[n];u.copy(r,o),o+=u.length}return r},i.prototype.write=function(t,e,n,r){if(isFinite(e))isFinite(n)||(r=n,n=void 0);else{var i=r;r=e,e=n,n=i}e=Number(e)||0;var o=this.length-e;n?(n=Number(n),n>o&&(n=o)):n=o,r=String(r||"utf8").toLowerCase();var u;switch(r){case"hex":u=l(this,t,e,n);break;case"utf8":case"utf-8":u=h(this,t,e,n);break;case"ascii":u=p(this,t,e,n);break;case"binary":u=d(this,t,e,n);break;case"base64":u=v(this,t,e,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":u=m(this,t,e,n);break;default:throw new Error("Unknown encoding")}return u},i.prototype.toString=function(t,e,n){var r=this;if(t=String(t||"utf8").toLowerCase(),e=Number(e)||0,n=void 0!==n?Number(n):n=r.length,n===e)return"";var i;switch(t){case"hex":i=k(r,e,n);break;case"utf8":case"utf-8":i=y(r,e,n);break;case"ascii":i=b(r,e,n);break;case"binary":i=w(r,e,n);break;case"base64":i=g(r,e,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":i=E(r,e,n);break;default:throw new Error("Unknown encoding")}return i},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},i.prototype.copy=function(t,e,n,r){var o=this;if(n||(n=0),r||0===r||(r=this.length),e||(e=0),r!==n&&0!==t.length&&0!==o.length){Q(r>=n,"sourceEnd < sourceStart"),Q(e>=0&&e<t.length,"targetStart out of bounds"),Q(n>=0&&n<o.length,"sourceStart out of bounds"),Q(r>=0&&r<=o.length,"sourceEnd out of bounds"),r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var u=r-n;if(100>u||!i._useTypedArrays)for(var s=0;u>s;s++)t[s+e]=this[s+n];else t._set(this.subarray(n,n+u),e)}},i.prototype.slice=function(t,e){var n=this.length;if(t=q(t,n,0),e=q(e,n,n),i._useTypedArrays)return i._augment(this.subarray(t,e));for(var r=e-t,o=new i(r,void 0,!0),u=0;r>u;u++)o[u]=this[u+t];return o},i.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},i.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},i.prototype.readUInt8=function(t,e){return e||(Q(void 0!==t&&null!==t,"missing offset"),Q(t<this.length,"Trying to read beyond buffer length")),t>=this.length?void 0:this[t]},i.prototype.readUInt16LE=function(t,e){return A(this,t,!0,e)},i.prototype.readUInt16BE=function(t,e){return A(this,t,!1,e)},i.prototype.readUInt32LE=function(t,e){return S(this,t,!0,e)},i.prototype.readUInt32BE=function(t,e){return S(this,t,!1,e)},i.prototype.readInt8=function(t,e){if(e||(Q(void 0!==t&&null!==t,"missing offset"),Q(t<this.length,"Trying to read beyond buffer length")),!(t>=this.length)){var n=128&this[t];return n?-1*(255-this[t]+1):this[t]}},i.prototype.readInt16LE=function(t,e){return _(this,t,!0,e)},i.prototype.readInt16BE=function(t,e){return _(this,t,!1,e)},i.prototype.readInt32LE=function(t,e){return I(this,t,!0,e)},i.prototype.readInt32BE=function(t,e){return I(this,t,!1,e)},i.prototype.readFloatLE=function(t,e){return D(this,t,!0,e)},i.prototype.readFloatBE=function(t,e){return D(this,t,!1,e)},i.prototype.readDoubleLE=function(t,e){return T(this,t,!0,e)},i.prototype.readDoubleBE=function(t,e){return T(this,t,!1,e)},i.prototype.writeUInt8=function(t,e,n){n||(Q(void 0!==t&&null!==t,"missing value"),Q(void 0!==e&&null!==e,"missing offset"),Q(e<this.length,"trying to write beyond buffer length"),K(t,255)),e>=this.length||(this[e]=t)},i.prototype.writeUInt16LE=function(t,e,n){B(this,t,e,!0,n)},i.prototype.writeUInt16BE=function(t,e,n){B(this,t,e,!1,n)},i.prototype.writeUInt32LE=function(t,e,n){x(this,t,e,!0,n)},i.prototype.writeUInt32BE=function(t,e,n){x(this,t,e,!1,n)},i.prototype.writeInt8=function(t,e,n){n||(Q(void 0!==t&&null!==t,"missing value"),Q(void 0!==e&&null!==e,"missing offset"),Q(e<this.length,"Trying to write beyond buffer length"),z(t,127,-128)),e>=this.length||(t>=0?this.writeUInt8(t,e,n):this.writeUInt8(255+t+1,e,n))},i.prototype.writeInt16LE=function(t,e,n){M(this,t,e,!0,n)},i.prototype.writeInt16BE=function(t,e,n){M(this,t,e,!1,n)},i.prototype.writeInt32LE=function(t,e,n){O(this,t,e,!0,n)},i.prototype.writeInt32BE=function(t,e,n){O(this,t,e,!1,n)},i.prototype.writeFloatLE=function(t,e,n){L(this,t,e,!0,n)},i.prototype.writeFloatBE=function(t,e,n){L(this,t,e,!1,n)},i.prototype.writeDoubleLE=function(t,e,n){C(this,t,e,!0,n)},i.prototype.writeDoubleBE=function(t,e,n){C(this,t,e,!1,n)},i.prototype.fill=function(t,e,n){if(t||(t=0),e||(e=0),n||(n=this.length),"string"==typeof t&&(t=t.charCodeAt(0)),Q("number"==typeof t&&!isNaN(t),"value is not a number"),Q(n>=e,"end < start"),n!==e&&0!==this.length){Q(e>=0&&e<this.length,"start out of bounds"),Q(n>=0&&n<=this.length,"end out of bounds");for(var r=e;n>r;r++)this[r]=t}},i.prototype.inspect=function(){for(var t=[],e=this.length,r=0;e>r;r++)if(t[r]=U(this[r]),r===n.INSPECT_MAX_BYTES){t[r+1]="...";break}return"<Buffer "+t.join(" ")+">"},i.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(i._useTypedArrays)return new i(this).buffer;for(var t=new Uint8Array(this.length),e=0,n=t.length;n>e;e+=1)t[e]=this[e];return t.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var X=i.prototype;i._augment=function(t){return t._isBuffer=!0,t._get=t.get,t._set=t.set,t.get=X.get,t.set=X.set,t.write=X.write,t.toString=X.toString,t.toLocaleString=X.toString,t.toJSON=X.toJSON,t.copy=X.copy,t.slice=X.slice,t.readUInt8=X.readUInt8,t.readUInt16LE=X.readUInt16LE,t.readUInt16BE=X.readUInt16BE,t.readUInt32LE=X.readUInt32LE,t.readUInt32BE=X.readUInt32BE,t.readInt8=X.readInt8,t.readInt16LE=X.readInt16LE,t.readInt16BE=X.readInt16BE,t.readInt32LE=X.readInt32LE,t.readInt32BE=X.readInt32BE,t.readFloatLE=X.readFloatLE,t.readFloatBE=X.readFloatBE,t.readDoubleLE=X.readDoubleLE,t.readDoubleBE=X.readDoubleBE,t.writeUInt8=X.writeUInt8,t.writeUInt16LE=X.writeUInt16LE,t.writeUInt16BE=X.writeUInt16BE,t.writeUInt32LE=X.writeUInt32LE,t.writeUInt32BE=X.writeUInt32BE,t.writeInt8=X.writeInt8,t.writeInt16LE=X.writeInt16LE,t.writeInt16BE=X.writeInt16BE,t.writeInt32LE=X.writeInt32LE,t.writeInt32BE=X.writeInt32BE,t.writeFloatLE=X.writeFloatLE,t.writeFloatBE=X.writeFloatBE,t.writeDoubleLE=X.writeDoubleLE,t.writeDoubleBE=X.writeDoubleBE,t.fill=X.fill,t.inspect=X.inspect,t.toArrayBuffer=X.toArrayBuffer,t}}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../../../node_modules/gulp-browserify/node_modules/browserify/node_modules/buffer/index.js","/../../../node_modules/gulp-browserify/node_modules/browserify/node_modules/buffer")},{"+7ZJp0":5,"base64-js":3,buffer:2,ieee754:4}],3:[function(t,e,n){(function(t,e,r,i,o,u,s,a,c){var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function e(t){var e=t.charCodeAt(0);return e===o||e===l?62:e===u||e===h?63:s>e?-1:s+10>e?e-s+26+26:c+26>e?e-c:a+26>e?e-a+26:void 0}function n(t){function n(t){c[l++]=t}var r,o,u,s,a,c;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var f=t.length;a="="===t.charAt(f-2)?2:"="===t.charAt(f-1)?1:0,c=new i(3*t.length/4-a),u=a>0?t.length-4:t.length;var l=0;for(r=0,o=0;u>r;r+=4,o+=3)s=e(t.charAt(r))<<18|e(t.charAt(r+1))<<12|e(t.charAt(r+2))<<6|e(t.charAt(r+3)),n((16711680&s)>>16),n((65280&s)>>8),n(255&s);return 2===a?(s=e(t.charAt(r))<<2|e(t.charAt(r+1))>>4,n(255&s)):1===a&&(s=e(t.charAt(r))<<10|e(t.charAt(r+1))<<4|e(t.charAt(r+2))>>2,n(s>>8&255),n(255&s)),c}function r(t){function e(t){return f.charAt(t)}function n(t){return e(t>>18&63)+e(t>>12&63)+e(t>>6&63)+e(63&t)}var r,i,o,u=t.length%3,s="";for(r=0,o=t.length-u;o>r;r+=3)i=(t[r]<<16)+(t[r+1]<<8)+t[r+2],s+=n(i);switch(u){case 1:i=t[t.length-1],s+=e(i>>2),s+=e(i<<4&63),s+="==";break;case 2:i=(t[t.length-2]<<8)+t[t.length-1],s+=e(i>>10),s+=e(i>>4&63),s+=e(i<<2&63),s+="="}return s}var i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="+".charCodeAt(0),u="/".charCodeAt(0),s="0".charCodeAt(0),a="a".charCodeAt(0),c="A".charCodeAt(0),l="-".charCodeAt(0),h="_".charCodeAt(0);t.toByteArray=n,t.fromByteArray=r}("undefined"==typeof n?this.base64js={}:n)}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../../../node_modules/gulp-browserify/node_modules/browserify/node_modules/buffer/node_modules/base64-js/lib/b64.js","/../../../node_modules/gulp-browserify/node_modules/browserify/node_modules/buffer/node_modules/base64-js/lib")},{"+7ZJp0":5,buffer:2}],4:[function(t,e,n){(function(t,e,r,i,o,u,s,a,c){n.read=function(t,e,n,r,i){var o,u,s=8*i-r-1,a=(1<<s)-1,c=a>>1,f=-7,l=n?i-1:0,h=n?-1:1,p=t[e+l];for(l+=h,o=p&(1<<-f)-1,p>>=-f,f+=s;f>0;o=256*o+t[e+l],l+=h,f-=8);for(u=o&(1<<-f)-1,o>>=-f,f+=r;f>0;u=256*u+t[e+l],l+=h,f-=8);if(0===o)o=1-c;else{if(o===a)return u?NaN:(p?-1:1)*(1/0);u+=Math.pow(2,r),o-=c}return(p?-1:1)*u*Math.pow(2,o-r)},n.write=function(t,e,n,r,i,o){var u,s,a,c=8*o-i-1,f=(1<<c)-1,l=f>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,v=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,u=f):(u=Math.floor(Math.log(e)/Math.LN2),e*(a=Math.pow(2,-u))<1&&(u--,a*=2),e+=u+l>=1?h/a:h*Math.pow(2,1-l),e*a>=2&&(u++,a/=2),u+l>=f?(s=0,u=f):u+l>=1?(s=(e*a-1)*Math.pow(2,i),u+=l):(s=e*Math.pow(2,l-1)*Math.pow(2,i),u=0));i>=8;t[n+p]=255&s,p+=d,s/=256,i-=8);for(u=u<<i|s,c+=i;c>0;t[n+p]=255&u,p+=d,u/=256,c-=8);t[n+p-d]|=128*v}}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../../../node_modules/gulp-browserify/node_modules/browserify/node_modules/buffer/node_modules/ieee754/index.js","/../../../node_modules/gulp-browserify/node_modules/browserify/node_modules/buffer/node_modules/ieee754")},{"+7ZJp0":5,buffer:2}],5:[function(t,e,n){
(function(t,n,r,i,o,u,s,a,c){function f(){}var t=e.exports={};t.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),t.title="browser",t.browser=!0,t.env={},t.argv=[],t.on=f,t.addListener=f,t.once=f,t.off=f,t.removeListener=f,t.removeAllListeners=f,t.emit=f,t.binding=function(t){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(t){throw new Error("process.chdir is not supported")}}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../../../node_modules/gulp-browserify/node_modules/browserify/node_modules/process/browser.js","/../../../node_modules/gulp-browserify/node_modules/browserify/node_modules/process")},{"+7ZJp0":5,buffer:2}],6:[function(t,e,n){(function(n,r,i,o,u,s,a,c,f){var l=t("baconjs");e.exports=function(t,e){t.factory("angularBacon",function(){return{watch:function(t,e){var n=new l.Bus;return t.$watch(e,function(t,e){t!==e&&n.push(t)}),n},resource:function(t){return function(e,n){return l.fromNodeCallback(function(r){function i(t){r(null,t)}function o(t){r(t)}t(e,n,i,o)})}}}})}}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/angularBacon.js","/")},{"+7ZJp0":5,baconjs:1,buffer:2}],7:[function(t,e,n){(function(n,r,i,o,u,s,a,c,f){var l=t("./question").Question;e.exports=function(t){t.factory("applicationValidator",["restResources",function(t){function e(e,n,r){var i=t.validate(e);i.success(function(t,i,o,u){0===t.errors.length?n({questions:l.getQuestions(t.questions,e),response:t}):r({statusCode:200,errors:t.errors,questions:l.getQuestions(t.questions,e),response:t})}),i.error(function(t,e){r({errors:[],statusCode:e,isSaveable:!0,response:t})})}return function(){function t(t,e){return function(){n===t&&e.apply(this,arguments)}}var n;return function(r,i,o,u){n={},o=t(n,o),u=t(n,u);var s=r.validatePreferences();s?(i(),e(r,o,u)):u({errors:[]})}}}])}}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/applicationValidator.js","/")},{"+7ZJp0":5,"./question":28,buffer:2}],8:[function(t,e,n){(function(n,r,i,o,u,s,a,c,f){var l=(t("../hakemus"),t("../hakutoive")),h=(t("../util"),t("../question").Question);e.exports=function(t){t.directive("application",["$http","$sce","restResources","applicationValidator","settings","debounce","localization","$timeout",function(t,e,n,r,i,o,u,s){return{restrict:"E",scope:{application:"=application"},templateUrl:"templates/application.html",link:function(t,e,a){function c(){return _(t.application.hakutoiveet).map(function(t){return{Koulutus:t.data.Koulutus,"Koulutus-id":t.data["Koulutus-id"],Opetuspiste:t.data.Opetuspiste,"Opetuspiste-id":t.data["Opetuspiste-id"]}})}function f(){var e=_(h.questionMap(t.application.additionalQuestions)).map(function(t,e){return t.answer}),n=_(t.application.henkilotiedot).map(function(t){return t.answer});return e.concat(n)}function p(){t.applicationForm.$setDirty(),"success"==t.statusMessageType&&v("")}function d(e){function n(){w(!0)}function r(n){v(u("message.validationOk"),"info"),t.isSaveable=!0,w(!1),t.application.importQuestions(n.questions),t.application.importHakuajat(n.response.hakemus.hakutoiveet),t.application.importPaymentInfo(n.response.paymentInfo),t.application.notifications=n.response.hakemus.notifications,t.application.tuloskirjeet=n.response.hakemus.tuloskirjeet,y([],e)}function i(n){w(!1),n.statusCode?200===n.statusCode?(t.isSaveable=_.isEmpty(n.errors),v(u("error.validationFailed"),"error")):401==n.statusCode?(t.isSaveable=!0,v(u("error.sessionExpired"),"error")):500==n.statusCode?(t.isSaveable=!0,v(u("error.serverError"),"error")):(t.isSaveable=!1,v(u("error.validationFailed_httpError"),"error")):(t.isSaveable=!1,v(u("error.validationFailed"),"error"));var r=null!=n.questions&&!l.hasHakutoiveErrors(n.errors),i=n.errors;r?t.application.importQuestions(n.questions):i=_(n.errors).filter(function(t){return l.isHakutoiveError(t.key)}),null!=n.response&&null!=n.response.hakemus&&(t.application.importHakuajat(n.response.hakemus.hakutoiveet),t.application.notifications=n.response.hakemus.notifications,t.application.tuloskirjeet=n.response.hakemus.tuloskirjeet),y(i,e)}b(t.application,n,r,i)}function v(e,n){t.statusMessage=e,t.statusMessageType=n||""}function m(t){var n=e.find(".preference-list-item");_.each(t,function(t){n.eq(t).addClass("saved")}),e.find(".timestamp-row").addClass("saved"),e.find(".yhteystiedot .ng-dirty").addClass("saved"),window.setTimeout(function(){e.find(".saved").removeClass("saved"),$(".timestamp-row").removeClass("saved")},3e3)}function g(){var t=$(e[0]).find(".application-header");null!=t.get(0)&&$(window).scrollTop()>t.get(0).offsetTop&&t.get(0).scrollIntoView()}function y(e,n){function r(t){return _(t).filter(function(t){var n=l.parseHakutoiveIndex(t.questionId),r=_(e).any(function(t){return l.isHakutoiveError(t.key)&&l.parseHakutoiveIndex(t.key)==n});return!r})}var i=t.application.updateValidationMessages(e,n);i=r(i),i.length>0&&(_(i).each(function(t){console.log("Validaatiovirhett ei ksitelty:",t.questionId,t.errors)}),v(u("error.serverError"),"error"))}t.localization=u;var b=o(r(),i.modelDebounce);t.isSaveable=!0,t.isValidating=!1,t.timestampLabel=function(){return u(t.application.received==t.application.updated?"label.applicationReceived":"label.applicationUpdated")},t.tuloskirjeForHaku=function(t,e){return _(t).findWhere({hakuOid:e})},t.shouldSaveButtonBeDisabled=function(){return t.applicationForm.$pristine||"pending"==t.statusMessageType||!t.isSaveable||t.isValidating},t.statusMessageStyleModifier=function(){return{"ajax-spinner":"pending"==t.statusMessageType,error:"error"==t.statusMessageType,success:"success"==t.statusMessageType}},t.$watch(c,function(t,e){_.isEqual(t,e)||(p(),d(!0))},!0),t.$watch(f,function(t,e){_.isEqual(e,t)||p()},!0),t.$on("questionAnswered",function(){d(!1)}),t.hakutoiveVastaanotettu=function(e,n){t.application.mergeSavedApplication(n.hakemus),s(function(){t.$emit("hakutoive-vastaanotettu",e)},0)},t.preferenceMoved=function(){v("")};var w=o(function(e){t.isValidating=e},i.uiIndicatorDebounce);t.saveApplication=function(){function e(e){m(t.application.getChangedPreferences()),t.$broadcast("show-callout","attachments",e.requiresAdditionalInfo===!0&&t.application.getChangedPreferences().length>0),t.application.mergeSavedApplication(e),t.applicationForm.$setPristine(),v(u("message.changesSaved"),"success"),y([]),t.application.editHakutoiveetEnabled()&&g()}function r(t){var e=function(){return 400==t.status&&_.isArray(t.data)&&t.data.length>0?"error.saveFailed_validationError":400!=t.status||_.isArray(t.data)&&t.data.length>0?401==t.status?"error.saveFailed_sessionExpired":500==t.status?"error.serverError":"error.saveFailed":"error.serverError"}();v(u(e),"error"),400==t.status&&y(t.data)}n.applications.update({id:t.application.oid},t.application.toJson(),e,r),v("","pending")}}}}])}}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/directives/application.js","/directives")},{"+7ZJp0":5,"../hakemus":24,"../hakutoive":27,"../question":28,"../util":29,buffer:2}],9:[function(t,e,n){(function(n,r,i,o,u,s,a,c,f){t("../util");e.exports=function(t){t.directive("applicationPeriods",["localization",function(t){return{restrict:"E",scope:{haku:"&haku"},templateUrl:"templates/applicationPeriods.html",link:function(e,n,r){e.localization=t,e.periods=function(){return e.haku().applicationPeriods},e.applicationPeriodString=function(n){return 1===e.periods().length?t("label.applicationPeriod"):n+1+". "+t("label.applicationPeriod").toLowerCase()},e.statusString=function(e){return t(e.active?"label.applicationPeriodActive":e.end<(new Date).getTime()?"label.applicationPeriodPassed":"label.applicationPeriodNotStarted")}}}}])}}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/directives/applicationPeriods.js","/directives")},{"+7ZJp0":5,"../util":29,buffer:2}],10:[function(t,e,n){(function(t,n,r,i,o,u,s,a,c){e.exports=function(t){t.directive("callout",function(){return{link:function(t,e,n){e.addClass("callout"),e.prepend($("<div/>",{"class":"callout-close"})),e.on("click",".callout-close",function(){e.fadeOut("fast")}),t.$on("show-callout",function(t,r,i){n.callout==r&&(i?e.fadeIn("fast"):e.fadeOut("fast"))})}}})}}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/directives/callout.js","/directives")},{"+7ZJp0":5,buffer:2}],11:[function(t,e,n){(function(t,n,r,i,o,u,s,a,c){e.exports=function(t){t.directive("clearableInput",["$parse",function(t){return{link:function(e,n,r){var i=$("<div/>",{"class":"clearable-input"}),o=$("<div/>",{"class":"clear-btn"}),u=n.wrap(i).parent();u.prepend(o),o.on("click",function(){e.$apply(function(){var n=t(r.ngModel);n.assign(e,"")})}),e.$watch(r.ngModel,function(t){o.toggle(t&&t.length>0)})}}}])}}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/directives/clearableInput.js","/directives")},{"+7ZJp0":5,buffer:2}],12:[function(t,e,n){(function(t,n,r,i,o,u,s,a,c){e.exports=function(t){t.directive("confirm",function(){return{scope:{callback:"&confirmAction"},link:function(t,e,n){function r(){e.removeClass("confirm"),e.text(i),e.off(".cancelConfirm"),$("body").off(".cancelConfirm")}var i="";e.on("click",function(){return e.hasClass("confirm")?(t.$apply(t.callback),r()):(e.hide(),e.addClass("confirm"),i=e.text(),e.text(n.confirmText),$("body").one("click.cancelConfirm",r),e.fadeIn(100)),!1})}}})}}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/directives/confirm.js","/directives")},{"+7ZJp0":5,buffer:2}],13:[function(t,e,n){(function(t,n,r,i,o,u,s,a,c){e.exports=function(t){t.directive("disableClickFocus",function(){return{link:function(t,e){e.on("mousedown",function(t){t.preventDefault()})}}})}}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/directives/disableClickFocus.js","/directives")},{"+7ZJp0":5,buffer:2}],14:[function(t,e,n){(function(t,n,r,i,o,u,s,a,c){e.exports=function(t){t.directive("formattedTime",["$sce","localization",function(t,e){return{restrict:"A",template:"",scope:{formattedTime:"=formattedTime"},link:function(t,e,n){t.$watch("formattedTime",function(t){if(null==t)return"";var r=moment(t);e.attr("datetime",r.format()),e.text(r.format(n.format||"LLLL").replace(/,/g,""))})}}}])}}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/directives/formattedTime.js","/directives")},{"+7ZJp0":5,buffer:2}],15:[function(t,e,n){(function(t,n,r,i,o,u,s,a,c){e.exports=function(t){t.directive("hakutoiveenVastaanotto",["localization","restResources","$timeout",function(t,e,n){return{restrict:"E",scope:{applicationOid:"&applicationOid",haku:"&haku",hakutoiveet:"&hakutoiveet",callback:"=callback"},templateUrl:"templates/hakutoiveenVastaanotto.html",link:function(r,i,o){r.vastaanottoAction="",r.localization=t,r.ajaxPending=!1,r.error="";try{r.email=r.$parent.$parent.application.henkilotiedot["Shkposti"].answer}catch(u){r.email=""}r.formatTimestamp=function(t){return moment(t).format("LLL").replace(/,/g,"")},r.inputIsDisabled=function(){return this.ajaxPending||this.vastaanottoSentSuccessfully},r.flashSiirtohakuNotification=function(){r.siirtohakuClass="siirtohaku-fade-out",n(function(){r.siirtohakuClass="siirtohaku-fade-in"},50)},r.vastaanotaHakutoive=function(r){function i(t){u.ajaxPending=!1,u.error="",u.vastaanottoSentSuccessfully=!0,n(function(){u.callback(r,t)},3500)}function o(e){var n=function(){return 401==e.status?"error.saveFailed_sessionExpired":500==e.status?"error.serverError":403==e.status?"error.priorAcceptance":"error.saveFailed"}();u.error=t(n),u.ajaxPending=!1}var u=this;u.error="",u.ajaxPending=!0,e.vastaanota.post({hakemusOid:u.applicationOid(),hakukohdeOid:r.hakukohdeOid},{vastaanottoAction:{action:u.vastaanottoAction},email:u.email,hakukohdeNimi:r.hakukohdeNimi,tarjoajaNimi:r.tarjoajaNimi},i,o)}}}}])}}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/directives/hakutoiveenVastaanotto.js","/directives")},{"+7ZJp0":5,buffer:2}],16:[function(t,e,n){(function(n,r,i,o,u,s,a,c,f){var l=t("../hakutoive");e.exports=function(t){t.directive("hakutoiveet",["localization",function(t){return{restrict:"E",scope:{application:"=application",preferenceMoved:"=preferenceMoved",validating:"=validating"},templateUrl:"templates/hakutoiveet.html",link:function(e,n,r){e.localization=t,e.movePreference=function(t,e){e>=0&&e<this.application.hakutoiveet.length&&(this.application.movePreference(t,e),this.preferenceMoved())}}}}]),t.controller("additionalQuestionController",["$scope","localization",function(t,e){t.localization=e,t.questionAnswered=function(){t.$emit("questionAnswered")}}]),t.controller("hakutoiveController",["$scope","$http","$timeout","settings","restResources",function(t,e,n,r,i){t.isEditingDisabled=function(){return!t.hakutoive.isNew||!t.application.isEditable(t.$index)},t.isKoulutusSelectable=function(){return!t.isEditingDisabled()&&this.hakutoive.hasOpetuspiste()&&!_.isEmpty(t.koulutusList)},t.isLoadingKoulutusList=function(){return!t.isEditingDisabled()&&this.hakutoive.hasOpetuspiste()&&_.isEmpty(t.koulutusList)},t.showNotification=function(e){var n=t.hakutoive.data["Koulutus-id"],r=t.application.notifications[n]||{};return r[e]},t.isNonPrioritizedAndEditable=function(){return this.application.haku.usePriority||t.application.isEditable(t.$index)},t.opetuspisteValittu=function(e,n,r){this.hakutoive.setOpetuspiste(e.id,e.name),t.koulutusList=[],i.koulutukset.query({asId:this.application.haku.oid,opetuspisteId:e.id,baseEducation:this.application.educationBackground.baseEducation,vocational:this.application.educationBackground.vocational,uiLang:t.localization("languageId")},function(e){t.koulutusList=e,1===e.length&&(t.valittuKoulutus=e[0],t.hakutoive.setKoulutus(e[0]))})},t.opetuspisteModified=function(){_.isEmpty(this.hakutoive.data.Opetuspiste)?this.hakutoive.clear():this.hakutoive.removeOpetuspisteData()},t.removeHakutoive=function(e){t.application.removePreference(e),t.application.addPreference(new l({}))},t.canRemovePreference=function(e){return t.application.hasPreference(e)&&!t.application.preferenceLocked(e)},t.koulutusValittu=function(t){this.hakutoive.setKoulutus(this.valittuKoulutus)},t.findOpetuspiste=function(e){return i.opetuspisteet.query({query:e,asId:t.application.haku.oid,lang:t.localization("languageId")}).$promise}}])}}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/directives/hakutoiveet.js","/directives")},{"+7ZJp0":5,"../hakutoive":27,buffer:2}],17:[function(t,e,n){(function(t,n,r,i,o,u,s,a,c){e.exports=function(t){t.directive("henkilotiedot",["localization","restResources","debounce","settings","angularBacon",function(t,e,n,r,i){return{restrict:"E",scope:{application:"=application"},templateUrl:"templates/henkilotiedot.html",link:function(n,o,u){function s(t){return function(e){return e.length===t}}function a(t){return function(e){return!t(e)}}n.localization=t,n.yhteystiedot=n.application.henkilotiedot;var c=i.watch(n,"yhteystiedot['Postinumero'].answer").debounce(r.modelDebounce).skipDuplicates().map(".trim"),f=i.resource(e.postOffice.get),l=c.filter(s(5)).flatMapLatest(function(t){return f({postalCode:t})});l.onValue(function(t){n.application.calculatedValues.postOffice=t.postOffice,n.yhteystiedot.Postinumero.setErrors([])}),l.onError(function(){n.application.calculatedValues.postOffice=""}),c.filter(a(s(5))).onValue(function(){n.$apply(function(){n.application.calculatedValues.postOffice=""})})}}}])}}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/directives/henkilotiedot.js","/directives")},{"+7ZJp0":5,buffer:2}],18:[function(t,e,n){(function(t,n,r,i,o,u,s,a,c){e.exports=function(t){t.directive("ilmoittautuminen",["localization",function(t){return{restrict:"E",scope:{hakukohteet:"&hakukohteet"},templateUrl:"templates/ilmoittautuminen.html",link:function(e,n,r){e.localization=t}}}])}}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/directives/ilmoittautuminen.js","/directives")},{"+7ZJp0":5,buffer:2}],19:[function(t,e,n){(function(t,n,r,i,o,u,s,a,c){e.exports=function(t){t.directive("localizedLink",["$sce","localization",function(t,e){return{restrict:"E",template:"",link:function(t,n,r){var i=e(r.key),o=$("<span>"+i+"</span>").find("a").attr("href",r.href).attr("target",r.target).end();n.append(o)}}}])}}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/directives/localizedLink.js","/directives")},{"+7ZJp0":5,buffer:2}],20:[function(t,e,n){(function(t,n,r,i,o,u,s,a,c){e.exports=function(t){t.directive("question",["RecursionHelper",function(t){return{restrict:"E",scope:{questionNode:"=questionNode",application:"=application",level:"=level"},templateUrl:"templates/question.html",compile:function(e){return t.compile(e,function(t,e,n,r,i){t.isGroup=function(){return t.questionNode&&!_.isEmpty(t.questionNode.questionNodes)}})}}}])}}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/directives/question.js","/directives")},{"+7ZJp0":5,buffer:2}],21:[function(t,e,n){(function(t,n,r,i,o,u,s,a,c){e.exports=function(t){t.directive("sortable",["settings",function(t){return function(e,n,r){var i=function(t,e){t.css("transition","all 0.5s"),t.css("transform","translate3d(0px, "+e+"px, 0px)")},o=function(t){t.css({transition:"",transform:""})},u=function(u,s){var a=Math.abs(u.offset().top-s.offset().top);u.index()<s.index()?(i(u,s.outerHeight()+a-u.outerHeight()),i(s,-a)):(i(s,u.outerHeight()+a-s.outerHeight()),i(u,-a)),setTimeout(function(){e.$apply(function(t){var e=n.find(r.sortableItem);t[r.sortableMoved](e.index(u),e.index(s)),o(u),o(s)})},t.uiTransitionTime)},s=function(t){return function(e){var n=$(e.target);if(!n.hasClass("disabled")){var i=n.closest(r.sortableItem),o=i[t]();u(i,o)}}};n.on("click",".sort-arrow-down",s("next")),n.on("click",".sort-arrow-up",s("prev"))}}])}}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/directives/sortable.js","/directives")},{"+7ZJp0":5,buffer:2}],22:[function(t,e,n){(function(n,r,i,o,u,s,a,c,f){var l=t("../util");e.exports=function(t){t.directive("valintatulos",["localization","restResources","settings",function(t,e,n){return{restrict:"E",scope:{valintatulos:"&data",isFinal:"&final"},templateUrl:"templates/valintatulos.html",link:function(e,n,r){function i(t){return"HYVAKSYTTY"==t.valintatila||"HARKINNANVARAISESTI_HYVAKSYTTY"==t.valintatila||"VARASIJALTA_HYVAKSYTTY"==t.valintatila}function o(t){return t.tilanKuvaukset[e.localization("languageId").toUpperCase()]}e.localization=t,e.formatDate=function(t){return null==t?"":moment(t).format("LL").replace(/,/g,"")},e.$watch("isFinal()",function(n){e.status=t(n?"label.resultsFinal":"label.resultsPending")}),e.valintatulosText=function(n){var r=l.underscoreToCamelCase(n.valintatila);return["VASTAANOTTANUT_SITOVASTI","EI_VASTAANOTETTU_MAARA_AIKANA","EHDOLLISESTI_VASTAANOTTANUT"].indexOf(n.vastaanottotila)>=0?(r=l.underscoreToCamelCase(n.vastaanottotila),t("label.resultState."+r)):_.isEmpty(o(n))?"VARALLA"===n.valintatila&&null!=n.varasijojaTaytetaanAsti?t("label.resultState.VarallaPvm",{varasija:n.varasijanumero?n.varasijanumero+".":"",varasijaPvm:e.formatDate(n.varasijojaTaytetaanAsti)}):i(n)&&n.ehdollisestiHyvaksyttavissa?t("label.resultState."+r)+t("label.resultState.EhdollinenPostfix"):t("label.resultState."+r,{varasija:n.varasijanumero?n.varasijanumero+".":""}):"HYLATTY"===n.valintatila?t("label.resultState."+r)+" "+o(n):i(n)&&n.ehdollisestiHyvaksyttavissa?t("label.resultState."+r)+t("label.resultState.EhdollinenPostfix"):o(n)},e.valintatulosStyle=function(t){return i(t)?"accepted":void 0}}}}])}}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/directives/valintatulos.js","/directives")},{"+7ZJp0":5,"../util":29,buffer:2}],23:[function(t,e,n){(function(n,r,i,o,u,s,a,c,f){e.exports=function(e){t("./applicationValidator")(e),t("./angularBacon")(e),t("./directives/confirm")(e),t("./directives/question")(e),t("./directives/localizedLink")(e),t("./directives/formattedTime")(e),t("./directives/sortable")(e),t("./directives/disableClickFocus")(e),t("./directives/application")(e),t("./directives/hakutoiveenVastaanotto")(e),t("./directives/ilmoittautuminen")(e),t("./directives/hakutoiveet")(e),t("./directives/valintatulos")(e),t("./directives/henkilotiedot")(e),t("./directives/applicationPeriods")(e),t("./directives/clearableInput")(e),t("./directives/callout")(e)},e.exports.Hakemus=t("./hakemus")}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_d067dc78.js","/")},{"+7ZJp0":5,"./angularBacon":6,"./applicationValidator":7,"./directives/application":8,"./directives/applicationPeriods":9,"./directives/callout":10,"./directives/clearableInput":11,"./directives/confirm":12,"./directives/disableClickFocus":13,"./directives/formattedTime":14,"./directives/hakutoiveenVastaanotto":15,"./directives/hakutoiveet":16,"./directives/henkilotiedot":17,"./directives/ilmoittautuminen":18,"./directives/localizedLink":19,"./directives/question":20,"./directives/sortable":21,"./directives/valintatulos":22,"./hakemus":24,buffer:2}],24:[function(t,e,n){(function(n,r,i,o,u,s,a,c,f){function l(t){try{this.oid=t.hakemus.oid,this.updated=t.hakemus.updated,this.haku=h(t.hakemus.haku),this.state=h(t.hakemus.state),this.hasForm=t.hakemus.hasForm,this.educationBackground=h(t.hakemus.educationBackground),this.notifications=t.hakemus.notifications,this.hakutoiveet=v(t.hakemus.hakutoiveet),this.henkilotiedot=d(t.hakemus.answers.henkilotiedot),this.persistedAnswers=t.hakemus.answers,this.additionalQuestions=y.getQuestions(t.questions,this),this.tuloskirjeet=h(p(t.hakemus.tuloskirjeet)),this.tulosOk=t.tulosOk,this.requiredPaymentState=t.hakemus.requiredPaymentState,this.calculatedValues={postOffice:t.hakemus.postOffice}}catch(e){throw e}}function h(t){return $.extend(!0,{},t)}function p(t){return _(t).map(function(t){var e=new Date(t.created),n=e.getFullYear(),r=e.getMonth()+1,i=e.getDate();return t.createdDate=i+"."+r+"."+n,t})}function d(t){var e=["Shkposti","matkapuhelinnumero1","asuinmaa","lahiosoite","Postinumero"];return _(e).reduce(function(e,n){return e[n]=new y({id:n},t[n]),e},{})}function v(t){return _(t).map(function(t){return new g(t)})}function m(t){var e=function(){var e=_.range(1,this.hakutoiveet.length+1);t(e);var n=_(e).map(function(t,e){return[t,e+1]});return _.object(n)}.call(this);_(y.questionMap(this.additionalQuestions)).each(function(t,n){var r=/^(preference)(\d+)([-_].+)/.exec(n);if(null!=r){var i=r[1]+e[r[2]]+r[3];t.id.questionId=i}})}var g=t("./hakutoive"),y=t("./question").Question,b=t("./util");l.prototype={removePreference:function(t){this.hakutoiveet.splice(t,1),m.call(this,function(e){e.splice(t,1)})},addPreference:function(t){this.hakutoiveet.push(t)},hasPreference:function(t){return t>=0&&t<=this.hakutoiveet.length-1&&this.hakutoiveet[t].hasData()},movePreference:function(t,e){this.hakutoiveet[t].setAsModified(),this.hakutoiveet[e].setAsModified(),this.hakutoiveet.splice(e,0,this.hakutoiveet.splice(t,1)[0]),m.call(this,function(n){n.splice(e,0,n.splice(t,1)[0])})},canMovePreference:function(t,e){var n=function(t){for(var e=t.length-1;e>=0;e--)if(t[e].hasData())return e;return-1}(this.hakutoiveet);return!this.preferenceLocked(t)&&this.hakutoiveet[t].hasData()&&t>=0&&n>=e&&e>=0},preferenceLocked:function(t){function e(t){var e=_(i.haku.applicationPeriods).find(function(e){return e.id===t});return void 0!==e?e.active:i.haku.active}var n=this.hakutoiveet[t],r=n.hakuaikaId,i=this;return n.addedDuringCurrentSession?!1:_.isEmpty(n.kohdekohtainenHakuaika)?_.isEmpty(r)?!this.haku.active:!e(r):!n.kohdekohtainenHakuaika.active},allResultsAvailable:function(){return!this.hasResultState(["KESKEN","VARALLA"])&&this.valintatulosHakutoiveet().length>0},resultFetchedSuccessfully:function(){return this.tulosOk},hasSomeResults:function(){return this.valintatulosHakutoiveet().length>0},hasSomeNonKeskenResults:function(){return this.hasSomeResults()&&_(this.valintatulosHakutoiveet()).some(function(t){return"KESKEN"!=t.valintatila})},valintatulosHakutoiveet:function(){return this.state&&this.state.valintatulos?this.state.valintatulos.hakutoiveet:[]},applicationPeriodsInactive:function(){return _(this.haku.applicationPeriods).every(function(t){return!t.active})},editHakutoiveetEnabled:function(){return this.state&&("ACTIVE"==this.state.id||"INCOMPLETE"==this.state.id)},editHenkilotiedotEnabled:function(){return this.editHakutoiveetEnabled()||this.state&&"HAKUKAUSIPAATTYNYT"==this.state.id},vastaanotettavatHakutoiveet:function(){return _(this.valintatulosHakutoiveet()).filter(function(t){return"VASTAANOTETTAVISSA_SITOVASTI"===t.vastaanotettavuustila||"VASTAANOTETTAVISSA_EHDOLLISESTI"===t.vastaanotettavuustila})},ilmoittautumisLinkit:function(){return _(this.valintatulosHakutoiveet()).filter(function(t){return null!=t.ilmoittautumistila&&t.ilmoittautumistila.ilmoittauduttavissa&&null!=t.ilmoittautumistila.ilmoittautumistapa&&t.ilmoittautumistila.ilmoittautumistapa.url})},hasResultState:function(t){return _.isArray(t)||(t=[t]),_(this.valintatulosHakutoiveet()).any(function(e){return _(t).contains(e.valintatila)})},toJson:function(){function t(){var t=_(n.henkilotiedot).reduce(function(t,e,n){return t.henkilotiedot[n]=e.answer,t},{henkilotiedot:{}}),e=_(y.questionMap(n.additionalQuestions)).reduce(function(t,e){t[e.id.phaseId]=t[e.id.phaseId]||{};var n=e.answer;return _.isObject(n)?_(n).each(function(n,r){t[e.id.phaseId][r]=n}):t[e.id.phaseId][e.id.questionId]=n,t},{});return _.extend({},t,e)}function e(t){return _.each(t,function(n,r){_.isBoolean(n)&&n===!1?t[r]="":_.isObject(n)&&e(n)}),t}var n=this;return{oid:n.oid,hakuOid:n.haku.oid,hakutoiveet:_(this.hakutoiveet).map(function(t){return t.toJson()}),answers:e(t())}},mergeSavedApplication:function(t){this.updated=t.updated,this.requiredPaymentState=t.requiredPaymentState,this.notifications=t.notifications,_.isEqual(b.withoutAngularFields(this.state),t.state)||(this.state=$.extend(!0,{},t.state));for(var e=0;e<this.hakutoiveet.length&&e<t.hakutoiveet.length;e++)hakutoive=this.hakutoiveet[e],hakutoive.importJson(t.hakutoiveet[e]),hakutoive.hasData()&&hakutoive.setAsSaved()},importHakuajat:function(t){if(null!=t)for(var e=0;e<this.hakutoiveet.length&&e<t.length;e++)this.hakutoiveet[e].kohdekohtainenHakuaika=t[e].kohdekohtainenHakuaika},importPaymentInfo:function(t){var e=this;t=t||{},this.hakutoiveet.forEach(function(n){var r="OK"===e.requiredPaymentState;n.showPaymentNotification=t[n.data["Koulutus-id"]]&&!r})},validatePreferences:function(){return this.hakutoiveet.length>0&&this.hakutoiveet[0].hasData()&&_(this.hakutoiveet).every(function(t){return t.isValid()})&&!_(this.hakutoiveet.slice(0,this.lastIndexWithData()+1)).any(function(t){return!t.hasData()})},getChangedPreferences:function(){return _(this.hakutoiveet).chain().map(function(t,e){return t.isModified?e:null}).without(null).value()},isEditable:function(t){return!this.applicationPeriodsInactive()&&t<=this.lastIndexWithData()+1},lastIndexWithData:function(){for(var t=this.hakutoiveet.length-1;t>=0;t--)if(this.hakutoiveet[t].hasData())return t;return-1},importQuestions:function(t){this.additionalQuestions=function(t,e){var n=y.questionMap(t);return _(y.questionMap(e)).each(function(t,e){null!=n[e]&&(t.answer=n[e].answer)}),e}(this.additionalQuestions,t)},updateValidationMessages:function(t,e){function n(){_(o).each(function(t){t.setErrors()}),e||_(u).each(function(t){t.setErrors()})}function r(t,n){return null!=u[t]?(e||u[t].appendErrors(n),!0):g.isHakutoiveError(t)?(o[g.questionIdToHakutoiveId(t)].appendErrors(n),!0):!1}var i=b.mapArray(t,"key","message"),o=g.hakutoiveMap(this.hakutoiveet),u=_.extend({},y.questionMap(this.additionalQuestions),this.henkilotiedot),s=[];return n(),_(i).each(function(t,e){r(e,t)||s.push({questionId:e,errors:t})}),s}},e.exports=l}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/hakemus.js","/")},{"+7ZJp0":5,"./hakutoive":27,"./question":28,"./util":29,buffer:2}],"./hakemuseditori":[function(t,e,n){e.exports=t("sBSSnn")},{}],sBSSnn:[function(t,e,n){(function(n,r,i,o,u,s,a,c,f){e.exports=function(e){t("./applicationValidator")(e),t("./angularBacon")(e),t("./directives/confirm")(e),t("./directives/question")(e),t("./directives/localizedLink")(e),t("./directives/formattedTime")(e),t("./directives/sortable")(e),t("./directives/disableClickFocus")(e),t("./directives/application")(e),t("./directives/hakutoiveenVastaanotto")(e),t("./directives/ilmoittautuminen")(e),t("./directives/hakutoiveet")(e),t("./directives/valintatulos")(e),t("./directives/henkilotiedot")(e),t("./directives/applicationPeriods")(e),t("./directives/clearableInput")(e),t("./directives/callout")(e)},e.exports.Hakemus=t("./hakemus")}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/hakemuseditori.js","/")},{"+7ZJp0":5,"./angularBacon":6,"./applicationValidator":7,"./directives/application":8,"./directives/applicationPeriods":9,"./directives/callout":10,"./directives/clearableInput":11,"./directives/confirm":12,"./directives/disableClickFocus":13,"./directives/formattedTime":14,"./directives/hakutoiveenVastaanotto":15,"./directives/hakutoiveet":16,"./directives/henkilotiedot":17,"./directives/ilmoittautuminen":18,"./directives/localizedLink":19,"./directives/question":20,"./directives/sortable":21,"./directives/valintatulos":22,"./hakemus":24,buffer:2}],27:[function(t,e,n){(function(n,r,i,o,u,s,a,c,f){function l(t){this.importJson(t),this.isModified=!1,this.isNew=_.isEmpty(t),this.addedDuringCurrentSession=_.isEmpty(t),this.errors=[];
}var h=t("./util");l.prototype={toJson:function(){return this.data},importJson:function(t){this.data=t.hakemusData||{},this.hakuaikaId=t.hakuaikaId,this.kohdekohtainenHakuaika=t.kohdekohtainenHakuaika},clear:function(){this.data={},this.isNew=!0,this.isModified=!1},hasData:function(){return!_.isEmpty(this.data)},setOpetuspiste:function(t,e){this.data.Opetuspiste=e,this.data["Opetuspiste-id"]=t,this.isModified=!0,this.setErrors([])},setKoulutus:function(t){function e(t){return null==t?"":t.toString()}this.data.Koulutus=e(t.name),this.data["Koulutus-id"]=e(t.id),this.data["Koulutus-educationDegree"]=e(t.educationDegree),this.data["Koulutus-id-lang"]=e(t.teachingLanguages[0]),this.data["Koulutus-id-sora"]=e(t.sora),this.data["Koulutus-id-aoIdentifier"]=e(t.aoIdentifier),this.data["Koulutus-id-kaksoistutkinto"]=e(t.kaksoistutkinto),this.data["Koulutus-id-vocational"]=e(t.vocational),this.data["Koulutus-id-educationcode"]=e(t.educationCodeUri),this.data["Koulutus-id-athlete"]=e(t.athleteEducation),this.data["Koulutus-id-discretionary"]=e(t.kysytaanHarkinnanvaraiset),this.data["Koulutus-id-attachments"]=e(null!=t.attachments&&t.attachments.length>0),this.data["Koulutus-requiredBaseEducations"]=(t.requiredBaseEducations||[]).join(","),this.addGroupInfo(t),this.isModified=!0,this.setErrors([])},addGroupInfo:function(t){var e=[],n=[];if(t.organizationGroups instanceof Array)for(var r=0;r<t.organizationGroups.length;r++){var i=t.organizationGroups[r];i.groupTypes.indexOf("hakukohde")>=0&&(n.push(i.oid),i.usageGroups.indexOf("hakukohde_liiteosoite")>=0&&e.push(i.oid))}n.length>0&&(this.data["Koulutus-id-ao-groups"]=n.join(",")),e.length>0&&(this.data["Koulutus-id-attachmentgroups"]=e.join(","))},hasOpetuspiste:function(){return!_.isEmpty(this.data["Opetuspiste-id"])},removeOpetuspisteData:function(){var t=this;_.each(this.data,function(e,n){0!==n.indexOf("$")&&"Opetuspiste"!=n&&delete t.data[n]}),delete this.kohdekohtainenHakuaika},isValid:function(){return _.isEmpty(this.data.Opetuspiste)||!_.isEmpty(this.data["Koulutus-id"])},setErrors:function(t){this.errors=t||[]},appendErrors:function(t){this.errors=this.errors.concat(t)},setAsSaved:function(){this.isNew=!1,this.isModified=!1},setAsModified:function(){this.isModified=!0}};var p=/^(preference\d)$|^(preference\d)-Koulutus$/;l.isHakutoiveError=function(t){return p.test(t)},l.parseHakutoiveIndex=function(t){var e=/^preference(\d+)/.exec(t);return e?Number(e[1]):null},l.hasHakutoiveErrors=function(t){var e=h.mapArray(t,"key","message"),n=this;return _(e).any(function(t,e){return n.isHakutoiveError(e)&&t.length>0})},l.hakutoiveMap=function(t){return h.indexBy(t,function(t,e){return"preference"+(e+1)})},l.questionIdToHakutoiveId=function(t){return _.chain(p.exec(t)).rest().without(void 0).first().value()},e.exports=l}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/hakutoive.js","/")},{"+7ZJp0":5,"./util":29,buffer:2}],28:[function(t,e,n){(function(n,r,i,o,u,s,a,c,f){function l(t){var e=_.extend({},m,t);return _(e).each(function(t,n){if(null==t){if("title"!=n)throw new Error("question parameter "+n+" null");e.title="?"}}),e}function h(t,e,n){_.extend(this,l(t)),this.answer=e,this.errors=n||[]}function p(t,e){function n(){var e=_(t.options).find(function(t){return t["default"]});return null==e?"":e.value}function r(n){var r=/^(preference)(\d+)([-_].+)/.exec(n);if(null!=r&&null!=e.hakutoiveet[r[2]-1]&&e.hakutoiveet[r[2]-1].isNew)return null;var i=e.persistedAnswers[t.id.phaseId];return null==i?null:i[n]}var i=r(t.id.questionId);return null!=t.options?"Checkbox"==t.questionType?_(t.options).chain().map(function(t){return i=r(t.value),[t.value,null==i?!1:Boolean(i)]}).object().value():null==i?n():i:null!=i?i:void 0}function d(t){this.title=t,this.questionNodes=[]}var v=t("./util"),m={help:"",verboseHelp:"",required:!1,questionType:"",id:null,title:""};h.fromJson=function(t,e){return new h(t,p(t,e),t.required?["*"]:[])},h.getQuestions=function(t,e){function n(t,r){return _(t).each(function(t){null!=t.questions?r.questionNodes.push(n(t.questions,new d(t.title))):r.questionNodes.push(h.fromJson(t,e))}),r}return n(t,new d)},h.prototype={setErrors:function(t){this.errors=t||[]},appendErrors:function(t){this.errors=this.errors.concat(t)}},h.questionMap=function(t){return t=v.flattenTree(t,"questionNodes"),v.indexBy(t,function(t){return t.id.questionId})},e.exports={Question:h,QuestionGroup:d}}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/question.js","/")},{"+7ZJp0":5,"./util":29,buffer:2}],29:[function(t,e,n){(function(t,n,r,i,o,u,s,a,c){var f={mapArray:function(t,e,n){return _.reduce(t,function(t,r){var i=r[e];return null==t[i]&&(t[i]=[]),t[i].push(r[n]),t},{})},indexBy:function(t,e){return _.reduce(t,function(t,n,r){return t[e(n,r)]=n,t},{})},flattenTree:function(t,e){return function n(t,r){return null!=t&&(null==t[e]?r.push(t):_(t[e]).each(function(t){n(t,r)})),r}(t,[])},underscoreToCamelCase:function(t){return t.toLowerCase().replace(/^(.)|_(.)/g,function(t,e,n){return(e?e:""+n?n:"").toUpperCase()})},withoutAngularFields:function(t){return _.isArray(t)?_(t).map(f.withoutAngularFields):_.isObject(t)?_(t).reduce(function(t,e,n){return n.indexOf("$$")<0&&(t[n]=f.withoutAngularFields(e)),t},{}):t}};e.exports=f}).call(this,t("+7ZJp0"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/util.js","/")},{"+7ZJp0":5,buffer:2}]},{},[23]);