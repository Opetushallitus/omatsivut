!function(t){function i(i){for(var n,s,l=i[0],r=i[1],u=i[2],p=0,d=[];p<l.length;p++)s=l[p],a[s]&&d.push(a[s][0]),a[s]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);for(c&&c(i);d.length;)d.shift()();return o.push.apply(o,u||[]),e()}function e(){for(var t,i=0;i<o.length;i++){for(var e=o[i],n=!0,l=1;l<e.length;l++){var r=e[l];0!==a[r]&&(n=!1)}n&&(o.splice(i--,1),t=s(s.s=e[0]))}return t}var n={},a={0:0},o=[];function s(i){if(n[i])return n[i].exports;var e=n[i]={i:i,l:!1,exports:{}};return t[i].call(e.exports,e,e.exports,s),e.l=!0,e.exports}s.m=t,s.c=n,s.d=function(t,i,e){s.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:e})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,i){if(1&i&&(t=s(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(s.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var n in t)s.d(e,n,function(i){return t[i]}.bind(null,n));return e},s.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(i,"a",i),i},s.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},s.p="/omatsivut/";var l=window.webpackJsonp=window.webpackJsonp||[],r=l.push.bind(l);l.push=i,l=l.slice();for(var u=0;u<l.length;u++)i(l[u]);var c=r;o.push([380,1]),e()}({358:function(t,i,e){t.exports=e.p+"css/main.css"},359:function(t,i,e){t.exports=e.p+"css/hakutoiveidenMuokkaus.css"},360:function(t,i,e){t.exports=e.p+"css/preview.css"},361:function(t,i){
/*
 * An Angular service which helps with creating recursive directives.
 * @author Mark Lagendijk
 * @license MIT
 */
angular.module("RecursionHelper",[]).factory("RecursionHelper",["$compile",function(t){return{compile:function(i,e){angular.isFunction(e)&&(e={post:e});var n,a=i.contents().remove();return{pre:e&&e.pre?e.pre:null,post:function(i,o){n||(n=t(a)),n(i,function(t){o.append(t)}),e&&e.post&&e.post.apply(null,arguments)}}}}}])},362:function(t,i){angular.module("debounce",[]).service("debounce",["$timeout",function(t){return function(i,e,n){var a,o,s,l;function r(){s=this,o=arguments;var r=n&&!a;return a&&t.cancel(a),a=t(function(){a=null,n||(l=i.apply(s,o))},e),r&&(l=i.apply(s,o)),l}return r.cancel=function(){t.cancel(a),a=null},r}}])},365:function(t,i){t.exports='<div role="presentation" id="appRoot">\n\n  <p ng-if="localization(\'message.generalNotification\') != \'none\'">{{ localization(\'message.generalNotification\') }}</p>\n\n  <h1>{{ localization(\'title.omatHakemukset\') }}</h1>\n\n  <div class="application-list-status"\n       ng-if="applicationStatusMessage.length > 0"\n       ng-class="applicationStatusMessageType" ng-cloak\n       role="status">\n      <span>\n          {{ localization(applicationStatusMessage) }}\n      </span>\n  </div>\n\n\n    <p class="application-list_ataru-applications-not-loaded"\n       ng-if="!allApplicationsFetched && applicationStatusMessage == \'\'">{{ localization(\'info.allApplicationsNotFetched\') }}</p>\n\n  <ul id="hakemus-list" aria-label="{{ localization(\'title.omatHakemukset\') }}" ng-cloak>\n      <li ng-repeat="application in applications" class="application" data-oid="{{application.oid}}">\n          <application application="application"></application>\n      </li>\n  </ul>\n</div>\n'},366:function(t,i){t.exports='<div class="notification" ng-if="visible">\n    <img ng-click="close()" src="img/close.png" class="close">\n    <div ng-bind-html="message"></div>\n</div>'},367:function(t,i){t.exports='<div ng-switch="isGroup()" ng-controller="additionalQuestionController">\n    <div ng-switch-when="true" class="question-group">\n        <div ng-if="level == 0" class="application-section-heading">\n            <span ng-show="questionNode.title.length > 0">{{localization("label.questionGroupWithTitle")}}:</span>\n            <span ng-show="questionNode.title.length == 0">{{localization("label.questionGroupWithoutTitle")}}:</span>\n            {{ questionNode.title }}\n        </div>\n        <label ng-if="level > 0" class="question-group-title">{{ questionNode.title }}:</label>\n\n        <div ng-class="{ \'question-group-indent\': level > 0, \'question-group-section\': level == 0 }" ng-repeat="subItem in questionNode.questionNodes">\n            <question question-node="subItem" application="application" level="level+1">\n            </question>\n        </div>\n    </div>\n\n    <div ng-switch-when="false" class="question">\n        <div class="infoText" ng-if="questionNode.questionType === \'RichText\'" ng-bind-html="questionNode.title"></div>\n        <label ng-if="questionNode.questionType !== \'RichText\'" class="title" ng-bind-html="questionNode.title"></label>\n        <i class="icon-info-circled verboseHelp" ng-if="questionNode.verboseHelp" title="{{questionNode.verboseHelp}}"></i>\n        <span class="validation-message error">{{ questionNode.errors.join(\', \') }}</span>\n        <div class="instruction helptext" ng-if="questionNode.help" ng-bind-html="questionNode.help"></div>\n\n        <span class="answer"\n              ng-init="questionType = questionNode.questionType === \'Text\' && questionNode.maxlength > 100 ? \'TextArea\' : questionNode.questionType"\n              ng-switch="questionType">\n            <input id="{{questionNode.id.questionId}}" type="text"\n                   ng-switch-when="Text"\n                   ng-blur="questionAnswered()"\n                   ng-model="questionNode.answer"\n                   maxlength="{{questionNode.maxlength}}"/>\n            <textarea id="{{questionNode.id.questionId}}"\n                      ng-switch-when="TextArea"\n                      ng-model="questionNode.answer"\n                      ng-blur="questionAnswered()"\n                      maxlength="{{questionNode.maxlength}}"\n                      rows="{{questionNode.rows || 4}}"\n                      cols="{{questionNode.cols || 80}}"\n                    />\n            <select ng-switch-when="Dropdown"\n                    ng-model="questionNode.answer"\n                    ng-options="option.value as option.title for option in questionNode.options"\n                    ng-change="questionAnswered()">\n            </select>\n\n            <div ng-switch-when="Radio">\n                <label class="radio-button-item" ng-repeat="option in questionNode.options">\n                    <input name="{{questionNode.id.questionId}}" type="radio"\n                           ng-model="questionNode.answer"\n                           ng-change="questionAnswered()"\n                           value={{option.value}} />\n                    <span ng-bind-html="option.title"></span>\n                </label>\n            </div>\n\n            <div ng-switch-when="Checkbox">\n                <label class="radio-button-item" ng-repeat="option in questionNode.options">\n                    <input type="checkbox"\n                           ng-change="questionAnswered()"\n                           ng-model="questionNode.answer[option.value]">\n                    <span ng-bind-html="option.title"></span>\n                </label>\n            </div>\n        </span>\n    </div>\n</div>\n'},368:function(t,i){t.exports='<div role="presentation" class="hakemuseditori">\n    <section class="application-header">\n        <h2>{{application.haku.name }}</h2>\n\n        <application-periods haku="application.haku"></application-periods>\n\n        <div class="timestamp-row" ng-show="application.haku.jarjestelmanHakulomake || application.hakemusSource === \'Ataru\'">\n            <i ng-if="application.previewUrl" aria-hidden="true" class="icon-doc-text"></i>\n            <a ng-if="application.previewUrl"\n               ng-href="{{ application.previewUrl }}"\n               ng-class="{disabled: applicationForm.$dirty|| statusMessageType==\'pending\' || isValidating}"\n               target="_blank">{{ localization(\'button.showApplication\') }}</a>\n            <span ng-if="application.tuloskirje && application.tuloskirje.createdDate">\n                <span class="delimiter"> | </span>\n                <a class="tuloskirje" ng-href="{{url(\'omatsivut.applications.tuloskirje\',application.haku.oid)}}" ng-show="application.hasForm" ng-class="{disabled: applicationForm.$dirty|| statusMessageType==\'pending\' || isValidating}" target="_blank">\n                    {{ localization(\'button.downloadLetter\', {\n                    luotu: application.tuloskirje.createdDate\n                    }) }}\n                </a>\n            </span>\n            <span class="timestamp" ng-if="false" ng-class="{disabled: form.$dirty || statusMessageType==\'pending\' || isValidating}">\n                {{ timestampLabel() }} <time formatted-time="application.updated" format="LLL" />\n            </span>\n            <div callout="attachments"\n                 ng-if="application.previewUrl">\n                <localized-link key="message.rememberSendAttachments"\n                                href="{{ application.previewUrl + \'#liitteet\' }}"\n                                target="_blank">\n                </localized-link>\n            </div>\n        </div>\n    </section>\n\n    <section class="application-status" role="presentation">\n        <div class="application-status-item" ng-if="!application.haku.active && application.state.id != \'HAKUKIERROSPAATTYNYT\' && !application.allResultsAvailable() && application.vastaanotettavatHakutoiveet().length == 0">\n            {{ localization(\'label.applicationPeriodEnded\') }}\n            <span ng-if="application.haku.aikataulu.julkistus">\n                {{ localization(\'label.resultsPublishedDate\') }} <time formatted-time="application.haku.aikataulu.julkistus.end" format="LL" />.\n            </span>\n        </div>\n\n        <div class="application-status-item" ng-if="application.state.id == \'HAKUKIERROSPAATTYNYT\'">\n            {{ localization(\'label.applicationRoundEnded\') }}\n        </div>\n\n        <div class="application-status-item" ng-if="application.haku.active && (application.state.id == \'POSTPROCESSING\' || application.state.id == \'SUBMITTED\')">\n            {{ localization("message.applicationIsInPostProcessing") }}\n        </div>\n\n        <div class="paymentStatus">\n            <div ng-if="application.requiredPaymentState == \'OK\'" class="alert alert-success">\n                {{ localization("payment.status.ok") }}\n            </div>\n            <div ng-if="application.requiredPaymentState == \'NOTIFIED\'" class="alert alert-info">\n                {{ localization("payment.status.notified") }}\n            </div>\n            <div ng-if="application.requiredPaymentState == \'NOT_OK\'" class="alert alert-danger">\n                {{ localization("payment.status.notOk") }}\n            </div>\n        </div>\n    </section>\n\n    <section class="hakutoiveen-vastaanotto" ng-if="application.vastaanotettavatHakutoiveet().length > 0">\n        <hakutoiveen-vastaanotto\n                application-oid="application.oid"\n                haku="application.haku"\n                hakutoiveet="application.vastaanotettavatHakutoiveet()"\n                callback="hakutoiveVastaanotettu"\n        ></hakutoiveen-vastaanotto>\n    </section>\n\n    <section class="ilmoittautuminen">\n        <ilmoittautuminen hakukohteet="application.ilmoittautumisLinkit()"\n                          oili="application.oiliUrl()"\n                          application="application">\n        </ilmoittautuminen>\n        <kela ng-show="application.kelaURL()" kela="application.kelaURL()">\n        </kela>\n    </section>\n\n    <form name="applicationForm" novalidate>\n\n        <section class="application-section application-valintatulos-error" ng-if="!application.resultFetchedSuccessfully()">\n            <span role="status" class="status-message error">{{ localization("error.valintatulosFailed") }}</span>\n        </section>\n\n        <section class="application-section application-valintatulos" ng-if="application.resultFetchedSuccessfully() &&\n                                                                             application.hasSomeResults() &&\n                                                                             (application.hasSomeNonKeskenResults() || !application.editHakutoiveetEnabled())">\n            <valintatulos\n                    application="application"\n                    data="application.state.valintatulos"\n                    final="application.allResultsAvailable()"\n                    callback="hakutoiveVastaanotettu"\n            ></valintatulos>\n        </section>\n\n        <section ng-show="application.hasForm" class="application-section hakutoiveet" ng-if="application.editHakutoiveetEnabled()">\n            <header class="application-section-heading">\n                <span>{{ localization(\'label.preferences\') }}</span>\n                <button class="save-btn" ng-hide="application.applicationPeriodsInactive()" ng-disabled="shouldSaveButtonBeDisabled()" ng-click="saveApplication()">{{ localization(\'button.save\') }}</button>\n                <span role="status" class="status-message" ng-class="statusMessageStyleModifier()" ng-bind="statusMessage"></span>\n            </header>\n\n              <hakutoiveet application="application" preference-moved="preferenceMoved" validating="isValidating">\n              </hakutoiveet>\n          </section>\n\n        <section ng-show="application.hasForm" class="application-section additional-questions" ng-if="application.editHakutoiveetEnabled() && application.additionalQuestions.questionNodes.length > 0">\n            <question question-node="application.additionalQuestions" application="application" class="questions" level="-1">\n            </question>\n        </section>\n\n        <section ng-show="application.hasForm && !application.isHakutoiveidenMuokkaus" class="application-section henkilotiedot" ng-if="application.editHenkilotiedotEnabled()">\n            <header class="application-section-heading">\n                {{ localization(\'label.contactDetails\') }}\n            </header>\n\n            <henkilotiedot application="application">\n            </henkilotiedot>\n            <header class="application-section-heading" ng-if="!application.editHakutoiveetEnabled()">\n                <button class="save-btn" ng-disabled="shouldSaveButtonBeDisabled()" ng-click="saveApplication()">{{ localization(\'button.save\') }}</button>\n                <span role="status" class="status-message" ng-class="statusMessageStyleModifier()" ng-bind="statusMessage"></span>\n            </header>\n        </section>\n        <section ng-show="application.hasForm" class="application-section application-footer" ng-if="application.editHakutoiveetEnabled()">\n            <header class="application-section-heading">\n                <button class="save-btn" ng-disabled="shouldSaveButtonBeDisabled()" ng-click="saveApplication()">{{ localization(\'button.save\') }}</button>\n                <span role="status" class="status-message" ng-class="statusMessageStyleModifier()" ng-bind="statusMessage"></span>\n            </header>\n        </section>\n    </form>\n</div>\n'},369:function(t,i,e){var n={"./en-gb":95,"./en-gb.js":95,"./fi":96,"./fi.js":96,"./sv":97,"./sv.js":97};function a(t){var i=o(t);return e(i)}function o(t){var i=n[t];if(!(i+1)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i}a.keys=function(){return Object.keys(n)},a.resolve=o,t.exports=a,a.id=369},370:function(t,i){t.exports='<form name="vastaanottoForm" novalidate>\n  <div ng-form name="innerForm" class="hakutoiveenVastaanotto fade-transitions" ng-repeat="hakutoive in ctrl.hakutoiveet()">\n      <header class="hakutoiveenVastaanotto-caption thumb-up">\n          <strong>{{ localization(\'message.acceptEducation.received\') }}</strong>\n           {{ hakutoive.tarjoajaNimi }} - {{ hakutoive.hakukohdeNimi }}\n      </header>\n\n      <div class="hakutoive-vastaanotettavissa" ng-if="hakutoive.vastaanottoDeadline">\n           {{ localization(\'message.acceptEducation.latestAnswer\', { aika: ctrl.formatTimestamp(hakutoive.vastaanottoDeadline) }) }}\n      </div>\n      <div class="hakutoive-vain-yksi-valittavissa" ng-if="ctrl.haku().showSingleStudyPlaceEnforcement">\n          {{ localization(\'message.acceptEducation.onlyOnePossible.1\') }}\n          <span class="vain-yksi">{{ localization(\'message.acceptEducation.onlyOnePossible.2\') }}</span>\n          {{ localization(\'message.acceptEducation.onlyOnePossible.3\') }}\n      </div>\n      <div class="hakutoive-siirtohaku {{ctrl.siirtohakuClass}}" ng-if="ctrl.haku().korkeakouluhaku && ctrl.haku().siirtohaku">\n          {{ localization(\'message.siirtohaku\') }}\n      </div>\n\n      <ul class="hakutoive-options">\n          <li>\n            <label>\n              <input type="radio" name="vastaanotettavaHakutoive" value="VastaanotaSitovasti" ng-model="ctrl.vastaanottoAction" ng-disabled="ctrl.isVastaanottoKesken()" ng-click="ctrl.flashSiirtohakuNotification()"/>\n              {{ ctrl.haku().toisenasteenhaku ? localization(\'message.acceptEducation.acceptToinenAste\') : localization(\'message.acceptEducation.accept\') }}\n            </label>\n          </li>\n          <li ng-show="hakutoive.vastaanotettavuustila == \'VASTAANOTETTAVISSA_EHDOLLISESTI\'">\n              <label>\n              <input type="radio" name="vastaanotettavaHakutoive" value="VastaanotaEhdollisesti"\n                     ng-model="ctrl.vastaanottoAction" ng-disabled="ctrl.isVastaanottoKesken()"/>\n                {{ localization(\'message.acceptEducation.conditionalAccept\') }}\n              </label>\n              <ul class="info">\n                  <li>{{ localization(\'message.acceptEducation.conditionalAcceptInfo1\') }}</li>\n                  <li>{{ localization(\'message.acceptEducation.conditionalAcceptInfo2\') }}</li>\n              </ul>\n          </li>\n          <li>\n            <label>\n              <input type="radio" name="vastaanotettavaHakutoive" value="Peru" ng-model="ctrl.vastaanottoAction" ng-disabled="ctrl.isVastaanottoKesken()"/>\n              {{ localization(\'message.acceptEducation.reject\') }}\n            </label>\n          </li>\n          <li ng-if="ctrl.vastaanottoAction === \'Peru\' && ctrl.isKkHaku()">\n            <label>\n              <input type="checkbox" name="confirmRejection" ng-model="ctrl.confirmCancelAction"/>\n              {{ localization(\'message.acceptEducation.confirmReject\') }}\n            </label>\n          </li>\n      </ul>\n\n      <div>\n          <span class="ajax-spinner" ng-show="ctrl.ajaxPending"></span>\n          <button class="vastaanota-btn" disable-click-focus\n                  ng-click="ctrl.vastaanotaHakutoive(hakutoive)"\n                  ng-disabled="ctrl.isNotVastaanotettavissa()"\n                  aria-label="{{ localization(\'button.vastaanota_ariaLabel\') }}"\n                  ng-bind="localization(\'button.vastaanota\')">\n          </button>\n          <span ng-if="!ctrl.vastaanottoSentSuccessfully && !ctrl.haku().toisenasteenhaku" class="status-message note">\n              {{ localization(\'message.acceptEducation.cannotChangeAnswer\') }}\n          </span>\n          <span ng-if="ctrl.vastaanottoSentSuccessfully" class="status-message success">\n              {{ localization(\'message.acceptEducation.responseReceived\') }}\n          </span>\n          <span ng-bind="ctrl.error" class="status-message error" ></span>\n      </div>\n  </div>\n</form>\n'},371:function(t,i){t.exports='\x3c!-- Käydään läpi kaikki hakutoiveet ja luodaan tarvittaessa ulkoiset ilmoittautumislinkit (kk), ilmoittautumiskäli (2.aste) ja\nnäytetään mahdolliset ilmoittautumiset --\x3e\n<div class="ilmoittautuminen-item fade-transitions" ng-repeat="tulos in hakukohteet()">\n\n    \x3c!-- ulkoinen ilmoittautumislinkki, vain kk --\x3e\n    <div class="kk-lasnaolo" ng-if="!application.haku.toisenasteenhaku && tulos.ilmoittautumistila.ilmoittauduttavissa && linkkiOK(tulos)">\n        <header>\n          <strong ng-if="tulos.ehdollisestiHyvaksyttavissa">{{ localization(\'registration.conditionalAcceptanceTitle\') }}</strong>\n          <strong ng-if="!tulos.ehdollisestiHyvaksyttavissa">{{ localization(\'registration.reminder\') }}</strong>\n          <span class="tarjoaja-hakukohde">{{ tulos.tarjoajaNimi }} - {{ tulos.hakukohdeNimi }}\n            <p ng-if="ohjeetUudelleOpiskelijalle(tulos.hakukohdeOid)">\n              <a class="ohjeet-uudelle-opiskelijalle" ng-href="{{ohjeetUudelleOpiskelijalle(tulos.hakukohdeOid)}}">{{ localization(\'registration.instructionsForNewStudents\') }}</a>\n            </p>\n        </span>\n        </header>\n        <span ng-if="tulos.ehdollisestiHyvaksyttavissa">{{ localization(\'registration.conditionalAcceptanceInfo\') }}</span>\n        <span ng-if="!tulos.ehdollisestiHyvaksyttavissa">\n          <p>{{ localization(\'registration.reminderInfo\') }}</p>\n          <a class="ilmoitauttaminen-linkki" href="{{oili()}}">{{ localization(\'registration.goToRegistration\') }}</a>\n        </span>\n    </div>\n\n    \x3c!-- ilmoittautumiskäli, 2. aste --\x3e\n    <div class="result-list" ng-if="application.haku.toisenasteenhaku && tulos.vastaanottotila === \'VASTAANOTTANUT_SITOVASTI\' && !ilmoittautumistietoNaytetaan(tulos)">\n        <div class="result-list-wrap">\n        <div class="result-list-cell flex-100">\n          <lasnaoloilmoittautuminen application="application" tulos="tulos"/>\n        </div>\n      </div>\n    </div>\n\n    \x3c!-- tieto opintopolkuun rekisteröidystä läsnäoloilmoittautumisesta jos sellainen on--\x3e\n    <div class="lasnaolo-ilmoittautuminen-container" ng-if="ilmoittautumistietoNaytetaan(tulos)">\n      <fieldset>\n        <div class="lasnaolo-ilmoittautuminen">\n          <span class="label-highlight"> {{ application.haku.toisenasteenhaku ?\n            localization(\'lasnaoloilmoittautuminen.title\') : localization(\'lasnaoloilmoittautuminen.title_kk\') }}</span>\n          <span> {{ application.henkiloNimi }} </span>\n          <span class="tarjoaja-hakukohde"> {{ tulos.tarjoajaNimi }} {{ tulos.hakukohdeNimi }}</span>\n        </div>\n        <div class="lasnaolo-confirmation" ng-if="application.haku.toisenasteenhaku">\n          {{ localization(\'lasnaoloilmoittautuminen.confirmation\', getEnrolmentMessageKeys(tulos)) }} {{ getStateTranslation(tulos) }}\n        </div>\n        <div class="lasnaolo-confirmation" ng-if="!application.haku.toisenasteenhaku">\n          {{ localization(\'lasnaoloilmoittautuminen.confirmation_kk\') }} {{ getStateTranslation(tulos) }}\n        </div>\n      </fieldset>\n    </div>\n</div>\n'},372:function(t,i){t.exports="<div class=\"fade-transitions\">\n    <header>\n        <strong>{{ localization('registration.opintoetuudet.opintotukihakemus') }}</strong>\n    </header>\n    <a href=\"{{kela()}}\">{{ localization('registration.opintoetuudet.studentFinancialAid') }}</a>\n</div>"},373:function(t,i){t.exports='<div class="preference-list" ng-class="{validating: validating}" sortable sortable-item=".preference-list-item" sortable-moved="movePreference">\n    <div class="overlay" style="background: url(../img/hakemuseditori/ajax-loader.gif) rgba(255,255,255, 0.5) no-repeat center center;">\n    </div>\n    <div class="preference-list-item" aria-label="{{ ($index+1) + \'. \' + hakutoive.data.Opetuspiste + \' - \' + hakutoive.data.Koulutus }}" ng-repeat="hakutoive in application.hakutoiveet" ng-controller="hakutoiveController" ng-class="{\'inactive\': isEditingDisabled() && hakutoive.isNew}">\n        <div class="preference-list-item-layout" ng-show="isNonPrioritizedAndEditable()">\n\n            <div class="item-content" ng-show="application.haku.usePriority">\n                <span class="row-number">{{$index+1}}</span>\n            </div>\n\n            <div class="item-content">\n                <div class="sort-arrow-container" ng-show="application.haku.usePriority">\n                    <button class="sort-arrow-up" aria-label="{{ localization(\'button.sortUp_ariaLabel\') }}" ng-disabled="!application.canMovePreference($index, $index-1)" disable-click-focus></button>\n                    <button class="sort-arrow-down" aria-label="{{ localization(\'button.sortDown_ariaLabel\') }}" ng-disabled="!application.canMovePreference($index, $index+1)" disable-click-focus></button>\n                </div>\n            </div>\n            <div class="item-content">\n                <div class="row opetuspiste">\n                    <label ng-bind="hakutoive.data.Opetuspiste" ng-show="isEditingDisabled()"></label>\n\n                    <input type="text" ng-change="opetuspisteModified()"\n                           placeholder="{{localization(\'label.chooseLocation\')}}"\n                           ng-model="hakutoive.data.Opetuspiste"\n                           uib-typeahead="opetuspiste.name for opetuspiste in findOpetuspiste($viewValue)"\n                           typeahead-loading="loadingLocations"\n                           typeahead-on-select="opetuspisteValittu($item, $model, $label)"\n                           ng-show="!isEditingDisabled()"/>\n                </div>\n\n                <div class="row koulutus">\n                    <span ng-bind="hakutoive.data.Koulutus" ng-show="isEditingDisabled()"></span>\n\n                    <select ng-model="valittuKoulutus"\n                            ng-options="koulutus.name for koulutus in koulutusList"\n                            ng-change="koulutusValittu(valittuKoulutus)" ng-show="isKoulutusSelectable()">\n                    </select>\n                    <span class="instruction ajax-spinner-small" ng-show="isLoadingKoulutusList()">{{ localization("message.loadingData") }}</span>\n                    <div class="validation-message error" ng-if="hakutoive.errors.length">{{hakutoive.errors.join(\', \')}}</div>\n                    <div class="alert alert-info aoPaymentNotification" ng-if="hakutoive.showPaymentNotification">\n                        {{ localization("payment.aoNotification") }}\n                    </div>\n                    <div class="alert alert-info baseEducationNotification" ng-if="showNotification(\'baseEducationConflict\')">\n                        {{ localization("info.baseEducationConflict") }}\n                    </div>\n                </div>\n\n                <div class="row hakuaika" ng-if="hakutoive.kohdekohtainenHakuaika != null && !application.preferenceLocked($index)">\n                    {{ localization(\'label.applicationPeriodEnds\') }} <time formatted-time="hakutoive.kohdekohtainenHakuaika.end" format="LLL" />\n                </div>\n            </div>\n\n            <div class="item-content">\n                <div class="application-preference-locked" ng-if="application.preferenceLocked($index)">\n                    {{localization(\'label.applicationPeriodPassed\') }}\n                </div>\n\n                <button ng-show="canRemovePreference($index)" class="delete-btn" disable-click-focus confirm confirm-text="{{localization(\'button.delete_confirm\')}}" confirm-action="removeHakutoive($index)" aria-label="{{ localization(\'button.delete_ariaLabel\') }}"></button>\n            </div>\n        </div>\n    </div>\n</div>\n'},374:function(t,i){t.exports='<div class="result-list">\n    <div class="result-list-header">\n        <span>{{ localization(\'label.resultsCaption\') }}</span>\n        <span class="result-list-status"> {{ status }}</span>\n    </div>\n    <div class="result-list-wrap" ng-repeat="tulos in valintatulos().hakutoiveet" ng-class="valintatulosStyle(tulos)">\n        <div class="result-list-cell flex-40">\n            <span class="row-number">{{$index+1}}.</span>\n            <span ng-bind="tulos.tarjoajaNimi"></span>\n            <span ng-bind="tulos.hakukohdeNimi"></span>\n            <span class="hyvaksytty-kesken" ng-show="isHyvaksyttyKesken(tulos, valintatulos().hakutoiveet)">\n                <span>{{ localization(\'label.acceptedUnfinished.text\') }}</span>\n                <ol>\n                    <li>{{ localization(\'label.acceptedUnfinished.rules.1\') }}</li>\n                    <li>{{ localization(\'label.acceptedUnfinished.rules.2\') }}</li>\n                </ol>\n                <a href="{{ localization(\'label.acceptedUnfinished.href\') }}">{{ localization(\'label.acceptedUnfinished.link\') }}</a>\n            </span>\n        </div>\n        <div class="result-list-cell flex-60">\n            <div>\n                <div>\n                    <span ng-bind="valintatulosText(tulos, valintatulos().hakutoiveet)" class="valintatulos-otsake"></span>\n                </div>\n                <div class="update-vastaanottotieto" ng-show="tulos.vastaanottotila == \'EHDOLLISESTI_VASTAANOTTANUT\'">\n                    <span class="ajax-spinner" ng-show="ajaxPending"></span>\n                    <div ng-hide="ajaxPending">\n                        <div>\n                            <label>\n                                <input type="checkbox" ng-model="enableConfirmation" ignore-dirty/>\n                                {{ localization(\'label.acceptConditionallyAccepted\') }}\n                            </label>\n                        </div>\n                        <div class="confirm-update-vastaanottotieto">\n                            <button id="confirmChangeButton"\n                                    ng-disabled="!enableConfirmation"\n                                    ng-click="vastaanotaSitovasti(application, tulos)"\n                                    ng-init="enableConfirmation=false">{{ localization(\'button.confirmChange\') }}</button>\n                            <i>{{ localization(\'label.cannotUndoChanges\') }}</i>\n                        </div>\n                        <span class="status-message error" ng-show="error">{{ getError() }}</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'},375:function(t,i){t.exports='<div class="yhteystiedot">\n    <label>\n        <div class="label-column">{{ localization("label.email")}}</div>\n        <div class="value-column">\n            <input type="text" ng-model="yhteystiedot[\'Sähköposti\'].answer" ng-change="yhteystiedot[\'SähköpostiUudelleen\'].answer=yhteystiedot[\'Sähköposti\'].answer" clearable-input />\n            <span class="validation-message error">{{ yhteystiedot[\'Sähköposti\'].errors.join(\', \') }}</span>\n        </div>\n    </label>\n\n    <label>\n        <div class="label-column">{{ localization("label.mobilePhone")}}</div>\n        <div class="value-column mobilePhone"> <input type="text" ng-model="yhteystiedot[\'matkapuhelinnumero1\'].answer" clearable-input />\n            <span class="validation-message error">{{ yhteystiedot[\'matkapuhelinnumero1\'].errors.join(\', \') }}</span>\n        </div>\n    </label>\n\n    <div role="presentation" ng-if="yhteystiedot[\'asuinmaa\'].answer == \'FIN\'">\n      <label>\n          <div class="label-column">{{ localization("label.streetAddress")}}</div>\n          <div class="value-column"> <input type="text" ng-model="yhteystiedot[\'lahiosoite\'].answer" clearable-input />\n              <span class="validation-message error">{{ yhteystiedot[\'lahiosoite\'].errors.join(\', \') }}</span>\n          </div>\n      </label>\n      <label>\n          <div class="label-column">{{ localization("label.postalCode")}}</div>\n          <div class="value-column postalCode">\n              <input type="text" ng-model="yhteystiedot[\'Postinumero\'].answer" clearable-input />\n              <span ng-bind="application.calculatedValues.postOffice"/>\n\n              <span class="validation-message error">{{ yhteystiedot[\'Postinumero\'].errors.join(\', \') }}</span>\n          </div>\n      </label>\n    </div>\n</div>\n'},376:function(t,i){t.exports='<ul class="application-periods" ng-if="haku().active">\n    <li ng-if="periods().length == 1">\n        {{ localization("label.applicationPeriodEnds") }}\n        <time formatted-time="periods()[0].end" format="LLL"/>\n    </li>\n\n    <li ng-repeat="applicationPeriod in periods()" ng-class="{inactive: !applicationPeriod.active}" ng-if="periods().length != 1">\n        {{ $index + 1 }}. {{ localization("label.applicationPeriod").toLowerCase() }}\n        <time formatted-time="applicationPeriod.start" format="LLL"/> -\n        <time formatted-time="applicationPeriod.end" format="LLL"/>\n        <span class="application-period-status">{{ statusString(applicationPeriod) }}</span>\n    </li>\n</ul>\n'},377:function(t,i){t.exports='\x3c!-- Toisen asteen ilmoittautumislomake --\x3e\n<form class="lasnaoloilmoittautuminenForm" name="lasnaoloilmoittautuminenForm">\n    <fieldset>\n        <div class="lasnaolo-ilmoittautuminen">\n            <span class="label-highlight">{{ localization(\'lasnaoloilmoittautuminen.title\') }} </span>\n            <span> {{ application.henkiloNimi }} </span>\n            <span class="tarjoaja-hakukohde"> - {{ tulos.tarjoajaNimi }} {{ tulos.hakukohdeNimi }} </span>\n        </div>\n        <div ng-hide="ilmoittautunut || !application.haku.toisenasteenhaku">\n            <div class="instruction">{{ localization(\'lasnaoloilmoittautuminen.info\') }}</div>\n\n            \x3c!-- Syksyllä alkavat koulutukset --\x3e\n            <div class="check-options" ng-show="schoolStartsInAutumn()">\n                <label>\n                    <input class="oph-checkable-input" type="radio" name="radios" value="semester" ng-model="ilmoittautuminen">\n                    <span class="oph-checkable-text">{{ localization(\'lasnaoloilmoittautuminen.semester\') }}</span>\n                </label>\n            </div>\n\n            \x3c!-- Keväällä alkavat koulutukset --\x3e\n            <div class="check-options" ng-show="schoolStartsInSpring()">\n                <label>\n                    <input class="oph-checkable-input" type="radio" name="radios" value="spring" ng-model="ilmoittautuminen">\n                    <span class="oph-checkable-text">{{ localization(\'lasnaoloilmoittautuminen.spring\') }}</span>\n                </label>\n            </div>\n\n            <div class="save-btn-wrapper">\n                <button class="save-btn" ng-click="postLasnaoloilmoittautuminen()">{{ localization(\'lasnaoloilmoittautuminen.send\') }}</button>\n            </div>\n            <div class="lasnaolo-error" ng-if="error">\n                {{ getErrorTranslation() }}\n            </div>\n        </div>\n        <div class="lasnaolo-confirmation" ng-if="ilmoittautunut">\n          {{ localization(\'lasnaoloilmoittautuminen.confirmation\', getEnrolmentMessageKeys()) }} {{ getStateTranslation() }}\n        </div>\n    </fieldset>\n</form>\n'},378:function(t,i,e){"use strict";!function(t){if(t.urls)"1.0"!==t.urls.version&&console.log("'Mismatching oph_urls.js. First loaded (and in use):",t.urls.version," second loaded (not in use): ","1.0");else{t.urls=function(){for(var i={},e=!1,n=!0,a=0;a<arguments.length;a++){var o=arguments[a];"string"==typeof o||null==o?i.baseUrl=o:Object.keys(o).forEach(function(t){i[t]=o[t]})}var s=function(e,n){for(var a=[i,t.urls.override,t.urls.properties,t.urls.defaults],o=0;o<a.length;o++){var s=a[o];if(s.hasOwnProperty(e))return s[e]}if("function"==typeof n)return n();if(void 0===n)throw new Error("Could not resolve value for '"+e+"'");return n},l=function(t){return t=[void 0,null].indexOf(t)>-1?"":t,n&&(t=encodeURIComponent(t)),t},r=function(t){return e?-1===[void 0,null,""].indexOf(t):-1===[void 0].indexOf(t)},c={omitEmptyValuesFromQuerystring:function(){return e=!0,c},noEncode:function(){return n=!1,c},url:function(){var i,e=Array.prototype.shift.apply(arguments),n=Array.prototype.slice.call(arguments),a="";if(!e)throw new Error("first parameter 'key' not defined!");for(var o=s(e),c=n.length;c>0;c--){var p=n[c-1];"object"==typeof p?Object.keys(p).forEach(function(t){var e=p[t];if(u(e)||(i=o.replace("$"+t,l(e))),i==o&&r(e))for(var n=u(e)?e:[e],s=0;s<n.length;s++){var c=a.length>0?"&":"?",d=l(t)+"="+l(n[s]);a=a+c+d}o=i}):o=o.replace("$"+c,l(p))}var d=s(function(t){return t.substring(0,t.indexOf("."))}(e)+".baseUrl",function(){return s("baseUrl",null)});return d&&(o=function(){var t=Array.prototype.slice.call(arguments);if(0===t.length)throw new Error("no arguments");var i=null;return t.forEach(function(t){if(i){var e=i.endsWith("/"),n=t.startsWith("/");e&&n?i+=t.substring(1):e||n?i+=t:i=i+"/"+t}else i=t}),i}(d,o)),function(){var i=Array.prototype.slice.call(arguments);i.unshift("OphProperties"),t.urls.debug&&t.console&&t.console.log&&t.console.log.apply(t.console,i)}("url:",e,"->",o+=a),o}};return c},t.urls.version="1.0",t.urls.properties={},t.urls.defaults={},t.urls.override={},t.urls.debug=!1,t.urls.debugLog=function(){return t.urls.debug=!0,this},t.urls.addProperties=function(i){s(i,t.urls.properties)},t.urls.addDefaults=function(i){s(i,t.urls.defaults)},t.urls.addOverride=function(i){s(i,t.urls.override)};var i=[],e=!1,n=!1,a=0,o=0;t.urls.success=function(t){e?n||t():i.push(t)},t.urls.loadFromUrls=function(){var e=Array.prototype.slice.call(arguments),a=[];return i.push(function(){a.forEach(function(i){r(t.urls.properties,i)})}),o+=e.length,e.forEach(function(t,i){!function(t,i,e,n){var a=new XMLHttpRequest;a.open("GET",i,!0),a.onreadystatechange=function(){4==a.readyState&&(200==a.status?e&&e(JSON.parse(a.responseText)):n&&n((a.status,a.responseText)))},a.send(null)}(0,t,function(t){a.splice(i,0,t),l()},function(){n=!0,l()})}),{success:t.urls.success}},t.url=t.urls().url}function s(t,i){var e=Object.keys(t).filter(function(t){return t in i});0==e.length?r(i,t):(console.log("Url properties already contains following keys:",e,"existing properties:",i,"new properties:",t),alert("Url properties conflict. Check console log"))}function l(){(a+=1)==o&&(e=!0,n||i.forEach(function(t){t()}))}function r(t,i){Object.keys(i).forEach(function(e){t[e]=i[e]})}function u(t){return Array.isArray?Array.isArray(t):t&&t.constructor===Array}}("undefined"==typeof window?t.exports:window),String.prototype.startsWith||(String.prototype.startsWith=function(t,i){return i=i||0,this.substr(i,t.length)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(t,i){var e=this.toString();("number"!=typeof i||!isFinite(i)||Math.floor(i)!==i||i>e.length)&&(i=e.length),i-=t.length;var n=e.indexOf(t,i);return-1!==n&&n===i})},379:function(t,i){window.urls.addProperties({"omatsivut.applications":"/omatsivut/secure/applications","omatsivut.applications.update":"/omatsivut/secure/applications/:id","omatsivut.applications.validate":"/omatsivut/secure/applications/validate/$1","omatsivut.applications.vastaanota":"/omatsivut/secure/applications/vastaanota","omatsivut.applications.vastaanota.post":"/omatsivut/secure/applications/vastaanota/:hakemusOid/hakukohde/:hakukohdeOid","omatsivut.postitoimipaikka":"/omatsivut/koodisto/postitoimipaikka/:postalCode","omatsivut.koulutukset":"/omatsivut/koulutusinformaatio/koulutukset/:asId/:opetuspisteId","omatsivut.opetuspisteet":"/omatsivut/koulutusinformaatio/opetuspisteet/:query","omatsivut.translations":"/omatsivut/translations","omatsivut.login":"/omatsivut/login","omatsivut.applications.tuloskirje":"/omatsivut/secure/applications/tuloskirje/$1","omatsivut.lasnaoloilmoittautuminen":"/omatsivut/secure/ilmoittaudu"})},380:function(t,i,e){"use strict";e.r(i),e(141);var n=e(51),a=e.n(n),o=e(134),s=e.n(o),l=e(135),r=e.n(l),u=e(136),c=e.n(u),p=e(137),d=e.n(p),h=e(138),v=e.n(h),f=(e(358),e(359),e(360),e(139)),m=e.n(f);const k={VASTAANOTTANUT_SITOVASTI:"VASTAANOTTANUT_SITOVASTI",EI_VASTAANOTETTU_MAARA_AIKANA:"EI_VASTAANOTETTU_MAARA_AIKANA",EHDOLLISESTI_VASTAANOTTANUT:"EHDOLLISESTI_VASTAANOTTANUT"},g="/omatsivut/translations";function b(){return m.a.get("lang")||function(t){t||(t=document.location.host);let i=t.split(".");if(i.length<2)return"fi";let e=i[i.length-2];return e.indexOf("opintopolku")>-1?"fi":e.indexOf("studieinfo")>-1?"sv":e.indexOf("studyinfo")>-1?"en":"fi"}()}const y="bearerToken",S=e(18);function w(t,i,e){return S.reduce(t,function(t,n){var a=n[i];return null==t[a]&&(t[a]=[]),t[a].push(n[e]),t},{})}function A(t,i){return S.reduce(t,function(t,e,n){return t[i(e,n)]=e,t},{})}function T(t){return t.toLowerCase().replace(/^(.)|_(.)/g,function(t,i,e){return(i||(""+e?e:"")).toUpperCase()})}function E(t){return S.isArray(t)?S(t).map(E):S.isObject(t)?S(t).reduce(function(t,i,e){return e.indexOf("$$")<0&&(t[e]=E(i)),t},{}):t}function O(){return window.sessionStorage.getItem(y)}function x(){return window.parent.location.href.indexOf("runner.html")>0}const N=e(18),I={help:"",verboseHelp:"",required:!1,questionType:"",id:null,title:""};class j{constructor(t,i,e){N.extend(this,function(t){var i=N.extend({},I,t);return N(i).each(function(t,e){if(null==t){if("title"!=e)throw new Error("question parameter "+e+" null");i.title="?"}}),i}(t)),this.answer=i,this.errors=e||[]}setErrors(t){this.errors=t||[]}appendErrors(t){this.errors=this.errors.concat(t)}static fromJson(t,i){return new j(t,function(t,i){function e(e){var n=/^(preference)(\d+)([-_].+)/.exec(e);if(null!=n&&null!=i.hakutoiveet[n[2]-1]&&i.hakutoiveet[n[2]-1].isNew)return null;var a=i.persistedAnswers[t.id.phaseId];return null==a?null:a[e]}var n=e(t.id.questionId);return null!=t.options?"Checkbox"==t.questionType?N(t.options).chain().map(function(t){return n=e(t.value),[t.value,null!=n&&Boolean(n)]}).object().value():null==n?function(){var i=N(t.options).find(function(t){return t.default});return null==i?"":i.value}():n:null!=n?n:void 0}(t,i),t.required?["*"]:[])}static getQuestions(t,i){return function t(e,n){return N(e).each(function(e){null!=e.questions?n.questionNodes.push(t(e.questions,new q(e.title))):n.questionNodes.push(j.fromJson(e,i))}),n}(t,new q)}static questionMap(t){return A(t=function(t,i){return function t(e,n){return null!=e&&(null==e[i]?n.push(e):S(e[i]).each(function(i){t(i,n)})),n}(t,[])}(t,"questionNodes"),function(t){return t.id.questionId})}}class q{constructor(t){this.title=t,this.questionNodes=[]}}var P=["restResources",function(t){return function(){var i;function e(t,e){return function(){i===t&&e.apply(this,arguments)}}return function(n,a,o,s){o=e(i={},o),s=e(i,s),n.validatePreferences()?(a(),function(i,e,n){t.validate(i).then(t=>{const a=t.data;0===a.errors.length?e({questions:j.getQuestions(a.questions,i),response:a}):n({statusCode:200,errors:a.errors,questions:j.getQuestions(a.questions,i),response:a})},t=>{n({errors:[],statusCode:t.status,isSaveable:!0,response:t.data})})}(n,o,s)):s({errors:[]})}}}],K=e(98),L=e.n(K);const H=e(18);function M(t,i){const e=function(t,i){return i.split(".").reduce((t,i)=>null==t?null:t[i],t)}(window.translations,t);if(e)return function(t,i){return H.reduce(i,(t,i,e)=>t.replace("__"+e+"__",i),t).replace(/_/g," ")}(e,i||{});throw new Error("no translation for "+t)}var z=["$resource","$http",function(t,i){return{applications:t(window.url("omatsivut.applications"),null,{get:{method:"GET",isArray:!1},update:{method:"PUT",url:window.url("omatsivut.applications.update")}}),validate:function(t){return i.post(window.url("omatsivut.applications.validate",t.oid),t.toJson())},vastaanota:t(window.url("omatsivut.applications.vastaanota"),null,{post:{method:"POST",url:window.url("omatsivut.applications.vastaanota.post")}}),postOffice:t(window.url("omatsivut.postitoimipaikka")),koulutukset:t(window.url("omatsivut.koulutukset")),opetuspisteet:t(window.url("omatsivut.opetuspisteet")),lasnaoloilmoittautuminen:t(window.url("omatsivut.lasnaoloilmoittautuminen"))}}],V=["$animate",function(t){return x()&&t.enabled(!1),{uiTransitionTime:x()?0:500,modelDebounce:x()?0:300,uiIndicatorDebounce:x()?0:500}}];function U(t){return t.url.includes("insecure/")}function _(){return{request:function(t){return function(t){var i=decodeURIComponent(window.location.href);return(i.includes("hakutoiveidenMuokkaus.html")||i.includes("token"))&&t.url.includes("/secure/")}(t)&&(t.url=t.url.replace(/\/secure\//,"/insecure/")),U(t)&&O()&&(t.headers.Authorization="Bearer "+O()),t},response:function(t){return U(t.config)&&t.data&&t.data.jsonWebToken&&(function(t){window.sessionStorage.setItem(y,t)}(t.data.jsonWebToken),t.oiliJwt=t.data.oiliJwt,t.data=t.data.response),t}}}var C=["$httpProvider","$locationProvider",function(t,i){i.html5Mode(!0),t.interceptors.push(_)}];const D=e(18),R=/^(preference\d)$|^(preference\d)-Koulutus$/;class F{constructor(t){this.importJson(t),this.isModified=!1,this.isNew=D.isEmpty(t),this.addedDuringCurrentSession=D.isEmpty(t),this.errors=[]}toJson(){return this.data}importJson(t){this.data=t.hakemusData||{},this.hakuaikaId=t.hakuaikaId,this.kohdekohtainenHakuaika=t.kohdekohtainenHakuaika,this.koulutuksenAlkaminen=t.koulutuksenAlkaminen,this.ohjeetUudelleOpiskelijalle=t.ohjeetUudelleOpiskelijalle}clear(){this.data={},this.isNew=!0,this.isModified=!1}hasData(){return!D.isEmpty(this.data)}setOpetuspiste(t,i){this.data.Opetuspiste=i,this.data["Opetuspiste-id"]=t,this.isModified=!0,this.setErrors([])}setKoulutus(t){function i(t){return null==t?"":t.toString()}this.data.Koulutus=i(t.name),this.data["Koulutus-id"]=i(t.id),this.data["Koulutus-educationDegree"]=i(t.educationDegree),this.data["Koulutus-id-lang"]=i(t.teachingLanguages[0]),this.data["Koulutus-id-sora"]=i(t.sora),this.data["Koulutus-id-aoIdentifier"]=i(t.aoIdentifier),this.data["Koulutus-id-kaksoistutkinto"]=i(t.kaksoistutkinto),this.data["Koulutus-id-vocational"]=i(t.vocational),this.data["Koulutus-id-educationcode"]=i(t.educationCodeUri),this.data["Koulutus-id-athlete"]=i(t.athleteEducation),this.data["Koulutus-id-discretionary"]=i(t.kysytaanHarkinnanvaraiset),this.data["Koulutus-id-attachments"]=i(null!=t.attachments&&t.attachments.length>0),this.data["Koulutus-requiredBaseEducations"]=(t.requiredBaseEducations||[]).join(","),this.addGroupInfo(t),this.isModified=!0,this.setErrors([])}addGroupInfo(t){var i=[],e=[];if(t.organizationGroups instanceof Array)for(var n=0;n<t.organizationGroups.length;n++){var a=t.organizationGroups[n];a.groupTypes.indexOf("hakukohde")>=0&&(e.push(a.oid),a.usageGroups.indexOf("hakukohde_liiteosoite")>=0&&i.push(a.oid))}e.length>0&&(this.data["Koulutus-id-ao-groups"]=e.join(",")),i.length>0&&(this.data["Koulutus-id-attachmentgroups"]=i.join(","))}hasOpetuspiste(){return!D.isEmpty(this.data["Opetuspiste-id"])}removeOpetuspisteData(){var t=this;D.each(this.data,function(i,e){0!==e.indexOf("$")&&"Opetuspiste"!=e&&delete t.data[e]}),delete this.kohdekohtainenHakuaika}isValid(){return D.isEmpty(this.data.Opetuspiste)||!D.isEmpty(this.data["Koulutus-id"])}setErrors(t){this.errors=t||[]}appendErrors(t){this.errors=this.errors.concat(t)}setAsSaved(){this.isNew=!1,this.isModified=!1}setAsModified(){this.isModified=!0}static isHakutoiveError(t){return R.test(t)}static parseHakutoiveIndex(t){var i=/^preference(\d+)/.exec(t);return i?Number(i[1]):null}static hasHakutoiveErrors(t){var i=w(t,"key","message"),e=this;return D(i).any(function(t,i){return e.isHakutoiveError(i)&&t.length>0})}static hakutoiveMap(t){return A(t,function(t,i){return"preference"+(i+1)})}static questionIdToHakutoiveId(t){return D.chain(R.exec(t)).rest().without(void 0).first().value()}}const Y=e(18);class Q{constructor(t){this.oid=t.hakemus.oid,this.updated=t.hakemus.updated,this.haku=B(t.hakemus.haku),this.state=B(t.hakemus.state),this.hasForm=t.hakemus.hasForm,this.educationBackground=B(t.hakemus.educationBackground),this.notifications=t.hakemus.notifications,this.hakutoiveet=function(t){return Y(t).map(function(t){return new F(t)})}(t.hakemus.hakutoiveet),this.henkilotiedot=function(t){if(!Y.isUndefined(t))return Y(["Sähköposti","matkapuhelinnumero1","asuinmaa","lahiosoite","Postinumero"]).reduce(function(i,e){return i[e]=new j({id:e},t[e]),i},{})}(t.hakemus.answers.henkilotiedot),this.henkiloNimi=function(t){if(!Y.isUndefined(t)){var i=t.Etunimet;return i||(i=t.Kutsumanimi),i+" "+t.Sukunimi}}(t.hakemus.answers.henkilotiedot),this.persistedAnswers=t.hakemus.answers,this.additionalQuestions=j.getQuestions(t.questions,this),this.tuloskirje=B(function(t){if(t){var i=new Date(t.created),e=i.getFullYear(),n=i.getMonth()+1,a=i.getDate();t.createdDate=a+"."+n+"."+e}return t}(t.hakemus.tuloskirje)),this.tulosOk=t.tulosOk,this.requiredPaymentState=t.hakemus.requiredPaymentState,this.calculatedValues={postOffice:t.hakemus.postOffice},this.oiliJwt=null,this.hakemusSource=t.hakemusSource,this.previewUrl=t.previewUrl}removePreference(t){this.hakutoiveet.splice(t,1),J.call(this,function(i){i.splice(t,1)})}addPreference(t){this.hakutoiveet.push(t)}hasPreference(t){return t>=0&&t<=this.hakutoiveet.length-1&&this.hakutoiveet[t].hasData()}movePreference(t,i){this.hakutoiveet[t].setAsModified(),this.hakutoiveet[i].setAsModified(),this.hakutoiveet.splice(i,0,this.hakutoiveet.splice(t,1)[0]),J.call(this,function(e){e.splice(i,0,e.splice(t,1)[0])})}canMovePreference(t,i){var e=function(t){for(var i=t.length-1;i>=0;i--)if(t[i].hasData())return i;return-1}(this.hakutoiveet);return!this.preferenceLocked(t)&&this.hakutoiveet[t].hasData()&&t>=0&&i<=e&&i>=0}preferenceLocked(t){var i=this.hakutoiveet[t],e=i.hakuaikaId,n=this;return!(i.addedDuringCurrentSession||(Y.isEmpty(i.kohdekohtainenHakuaika)?Y.isEmpty(e)?this.haku.active:function(t){var i=Y(n.haku.applicationPeriods).find(function(i){return i.id===t});return void 0!==i?i.active:n.haku.active}(e):i.kohdekohtainenHakuaika.active))}allResultsAvailable(){return!this.hasResultState(["KESKEN","VARALLA"])&&this.valintatulosHakutoiveet().length>0}resultFetchedSuccessfully(){return this.tulosOk}hasSomeResults(){return this.valintatulosHakutoiveet().length>0}hasSomeNonKeskenResults(){return this.hasSomeResults()&&Y(this.valintatulosHakutoiveet()).some(function(t){return"KESKEN"!=t.valintatila})}valintatulosHakutoiveet(){return this.state&&this.state.valintatulos?this.state.valintatulos.hakutoiveet:[]}applicationPeriodsInactive(){return Y(this.haku.applicationPeriods).every(function(t){return!t.active})}editHakutoiveetEnabled(){return this.state&&("ACTIVE"===this.state.id||"INCOMPLETE"===this.state.id)&&"Ataru"!==this.hakemusSource}editHenkilotiedotEnabled(){return this.editHakutoiveetEnabled()||this.state&&"HAKUKAUSIPAATTYNYT"===this.state.id&&"Ataru"!==this.hakemusSource}vastaanotettavatHakutoiveet(){return Y(this.valintatulosHakutoiveet()).filter(function(t){return("VASTAANOTETTAVISSA_SITOVASTI"===t.vastaanotettavuustila||"VASTAANOTETTAVISSA_EHDOLLISESTI"===t.vastaanotettavuustila)&&"KESKEN"==t.vastaanottotila})}ilmoittautumisLinkit(){return Y(this.valintatulosHakutoiveet()).filter(function(t){return null!=t.ilmoittautumistila&&(t.ilmoittautumistila.ilmoittauduttavissa||function(t){return["LASNA_KOKO_LUKUVUOSI","POISSA_KOKO_LUKUVUOSI","LASNA_SYKSY","POISSA_SYKSY","LASNA","POISSA"].includes(t)}(t.ilmoittautumistila.ilmoittautumistila))})}kelaURL(){return Y.chain(this.valintatulosHakutoiveet()).map(function(t){return t.kelaURL}).filter(function(t){return t}).head().value()}oiliUrl(){var t=this.oiliJwt;return Y.chain(this.valintatulosHakutoiveet()).map(function(i){var e=i.ilmoittautumistila.ilmoittautumistapa.url;return e.endsWith("/oili/")?e:e+"?token="+t}).filter(function(t){return t}).head().value()}hasResultState(t){return Y.isArray(t)||(t=[t]),Y(this.valintatulosHakutoiveet()).any(function(i){return Y(t).contains(i.valintatila)})}toJson(){var t=this;return{oid:t.oid,hakuOid:t.haku.oid,hakutoiveet:Y(this.hakutoiveet).map(function(t){return t.toJson()}),answers:function t(i){return Y.each(i,function(e,n){Y.isBoolean(e)&&!1===e?i[n]="":Y.isObject(e)&&t(e)}),i}(function(){var i=Y(t.henkilotiedot).reduce(function(t,i,e){return t.henkilotiedot[e]=i.answer,t},{henkilotiedot:{}}),e=Y(j.questionMap(t.additionalQuestions)).reduce(function(t,i){t[i.id.phaseId]=t[i.id.phaseId]||{};var e=i.answer;return Y.isObject(e)?Y(e).each(function(e,n){t[i.id.phaseId][n]=e}):t[i.id.phaseId][i.id.questionId]=e,t},{});return Y.extend({},i,e)}())}}mergeSavedApplication(t){this.updated=t.updated,this.requiredPaymentState=t.requiredPaymentState,this.notifications=t.notifications,Y.isEqual(E(this.state),t.state)||(this.state=window.$.extend(!0,this.state,t.state));for(let i=0;i<this.hakutoiveet.length&&i<t.hakutoiveet.length;i++){let e=this.hakutoiveet[i];e.importJson(t.hakutoiveet[i]),e.hasData()&&e.setAsSaved()}}importHakuajat(t){if(null!=t)for(var i=0;i<this.hakutoiveet.length&&i<t.length;i++)this.hakutoiveet[i].kohdekohtainenHakuaika=t[i].kohdekohtainenHakuaika}importPaymentInfo(t){var i=this;t=t||{},this.hakutoiveet.forEach(function(e){var n="OK"===i.requiredPaymentState;e.showPaymentNotification=t[e.data["Koulutus-id"]]&&!n})}validatePreferences(){return this.hakutoiveet.length>0&&this.hakutoiveet[0].hasData()&&Y(this.hakutoiveet).every(function(t){return t.isValid()})&&!Y(this.hakutoiveet.slice(0,this.lastIndexWithData()+1)).any(function(t){return!t.hasData()})}getChangedPreferences(){return Y(this.hakutoiveet).chain().map(function(t,i){return t.isModified?i:null}).without(null).value()}isEditable(t){return!this.applicationPeriodsInactive()&&t<=this.lastIndexWithData()+1}lastIndexWithData(){for(var t=this.hakutoiveet.length-1;t>=0;t--)if(this.hakutoiveet[t].hasData())return t;return-1}compareQuestionMapsIgnoring(t,i,e){return Y.keys(t).length===Y.keys(i).length&&Y.every(i,function(i,n){if(t[n]){var a=Y.omit(t[n],e),o=Y.omit(i,e);return angular.equals(a,o)}return!1})}importQuestions(t){var i=j.questionMap(this.additionalQuestions),e=j.questionMap(t);return this.compareQuestionMapsIgnoring(i,e,["answer","errors"])?(this.additionalQuestions=function(t,i){var e=j.questionMap(t);return Y(e).each(function(t,e){null!=i[e]&&(t.errors=i[e].errors)}),t}(this.additionalQuestions,t),this.additionalQuestions):(this.additionalQuestions=function(t,i){var e=j.questionMap(t);return Y(j.questionMap(i)).each(function(t,i){null!=e[i]&&(t.answer=e[i].answer)}),i}(this.additionalQuestions,t),this.additionalQuestions)}updateValidationMessages(t,i){var e=w(t,"key","message"),n=F.hakutoiveMap(this.hakutoiveet),a=Y.extend({},j.questionMap(this.additionalQuestions),this.henkilotiedot),o=[];return Y(n).each(function(t){t.setErrors()}),i||Y(a).each(function(t){try{t.setErrors()}catch(t){console.log("For some unfathomable reason item.setErrors() is not defined here although it should be! Should be fixed hakemus.js#updateValidationMessages().")}}),Y(e).each(function(t,e){(function(t,e){return null!=a[t]?(i||a[t].appendErrors(e),!0):!!F.isHakutoiveError(t)&&(n[F.questionIdToHakutoiveId(t)].appendErrors(e),!0)})(e,t)||o.push({questionId:e,errors:t})}),o}}function B(t){return $.extend(!0,{},t)}function J(t){var i=function(){var i=Y.range(1,this.hakutoiveet.length+1);t(i);var e=Y(i).map(function(t,i){return[t,i+1]});return Y.object(e)}.call(this);Y(j.questionMap(this.additionalQuestions)).each(function(t,e){var n=/^(preference)(\d+)([-_].+)/.exec(e);if(null!=n){var a=n[1]+i[n[2]]+n[3];t.id.questionId=a}})}const W=e(18);var G=["restResources",function(t){return{restrict:"E",scope:!0,template:e(365),link:function(i,e,n){function a(){i.applicationStatusMessage="message.loadingApplications",i.applicationStatusMessageType="ajax-spinner",t.applications.get(o,s)}function o(t){i.allApplicationsFetched=t.allApplicationsFetched,i.applications=W.map(t.applications,function(t){var i=new Q(t);return i.isHakutoiveidenMuokkaus=!1,i}),i.applications.length>0?(i.applicationStatusMessage="",i.applicationStatusMessageType=""):i.allApplicationsFetched?(i.applicationStatusMessage="message.noApplications",i.applicationStatusMessageType="info"):(i.applicationStatusMessage="error.loadingFailed",i.applicationStatusMessageType="error")}function s(t){switch(t.status){case 401:document.location.replace(window.url("omatsivut.login"));break;case 404:i.applicationStatusMessage="errorPage.noApplicationsFound.text",i.applicationStatusMessageType="info";break;default:i.applicationStatusMessage="error.loadingFailed",i.applicationStatusMessageType="error"}i.applications=[]}i.$on("hakutoive-vastaanotettu",function(){a()}),i.loadApplications=a,a()}}}];const X=e(18);var Z=["RecursionHelper",function(t){return{restrict:"E",scope:{questionNode:"=",application:"=",level:"="},template:e(367),compile:function(i){return t.compile(i,function(t,i,e,n,a){t.isGroup=function(){return t.questionNode&&!X.isEmpty(t.questionNode.questionNodes)}})}}}],tt=["settings",function(t){return function(i,e,n){var a=function(t,i){t.css("transition","all 0.5s"),t.css("transform","translate3d(0px, "+i+"px, 0px)")},o=function(t){t.css({transition:"",transform:""})},s=function(s){return function(l){var r=$(l.target);if(!r.hasClass("disabled")){var u=r.closest(n.sortableItem);!function(s,l){var r=Math.abs(s.offset().top-l.offset().top);s.index()<l.index()?(a(s,l.outerHeight()+r-s.outerHeight()),a(l,-r)):(a(l,s.outerHeight()+r-l.outerHeight()),a(s,-r)),setTimeout(function(){i.$apply(function(t){var i=e.find(n.sortableItem);t[n.sortableMoved](i.index(s),i.index(l)),o(s),o(l)})},t.uiTransitionTime)}(u,u[s]())}}};e.on("click",".sort-arrow-down",s("next")),e.on("click",".sort-arrow-up",s("prev"))}}];const it=e(18);var et=["restResources","applicationValidator","settings","debounce","$timeout",function(t,i,n,a,o){return{restrict:"E",scope:{application:"="},template:e(368),link:function(e,s,l){e.localization=M;var r=a(i(),n.modelDebounce);function u(){e.applicationForm.$setDirty(),"success"===e.statusMessageType&&p("")}function c(t){r(e.application,function(){d(!0)},function(i){p(M("message.validationOk"),"info"),e.isSaveable=!0,d(!1),e.application.importQuestions(i.questions),e.application.importHakuajat(i.response.hakemus.hakutoiveet),e.application.importPaymentInfo(i.response.paymentInfo),e.application.notifications=i.response.hakemus.notifications,e.application.tuloskirjeet=i.response.hakemus.tuloskirjeet,h([],t)},function(i){d(!1),i.statusCode?200===i.statusCode?(e.isSaveable=it.isEmpty(i.errors),p(M("error.validationFailed"),"error")):401==i.statusCode?(e.isSaveable=!0,p(M("error.sessionExpired"),"error")):500==i.statusCode?(e.isSaveable=!0,p(M("error.serverError"),"error")):(e.isSaveable=!1,p(M("error.validationFailed_httpError"),"error")):(e.isSaveable=!1,p(M("error.validationFailed"),"error"));var n=null!=i.questions&&!F.hasHakutoiveErrors(i.errors),a=i.errors;n?e.application.importQuestions(i.questions):a=it(i.errors).filter(function(t){return F.isHakutoiveError(t.key)}),null!=i.response&&null!=i.response.hakemus&&(e.application.importHakuajat(i.response.hakemus.hakutoiveet),e.application.notifications=i.response.hakemus.notifications,e.application.tuloskirjeet=i.response.hakemus.tuloskirjeet),h(a,t)})}function p(t,i){e.statusMessage=t,e.statusMessageType=i||""}e.isSaveable=!0,e.isValidating=!1,e.timestampLabel=function(){return e.application.received===e.application.updated?localization("label.applicationReceived"):localization("label.applicationUpdated")},e.shouldSaveButtonBeDisabled=function(){return e.applicationForm.$pristine||"pending"===e.statusMessageType||!e.isSaveable||e.isValidating},e.statusMessageStyleModifier=function(){return{"ajax-spinner":"pending"===e.statusMessageType,error:"error"===e.statusMessageType,success:"success"===e.statusMessageType}},e.$watch(function(){return it(e.application.hakutoiveet).map(function(t){return{Koulutus:t.data.Koulutus,"Koulutus-id":t.data["Koulutus-id"],Opetuspiste:t.data.Opetuspiste,"Opetuspiste-id":t.data["Opetuspiste-id"]}})},function(t,i){it.isEqual(t,i)||(u(),c(!0))},!0),e.$watch(function(){var t=it(j.questionMap(e.application.additionalQuestions)).map(function(t,i){return t.answer}),i=it(e.application.henkilotiedot).map(function(t){return t.answer});return t.concat(i)},function(t,i){it.isEqual(i,t)||u()},!0),e.$on("questionAnswered",function(){c(!1)}),e.hakutoiveVastaanotettu=function(t,i){e.application.mergeSavedApplication(i.hakemus),o(function(){e.$emit("hakutoive-vastaanotettu",t)},0)},e.url=window.url,e.preferenceMoved=function(){p("")};var d=a(function(t){e.isValidating=t},n.uiIndicatorDebounce);function h(t,i){var n=e.application.updateValidationMessages(t,i);(n=it(n).filter(function(i){var e=F.parseHakutoiveIndex(i.questionId);return!it(t).any(function(t){return F.isHakutoiveError(t.key)&&F.parseHakutoiveIndex(t.key)==e})})).length>0&&(it(n).each(function(t){console.log("Validaatiovirhettä ei käsitelty:",t.questionId,t.errors)}),p(M("error.serverError"),"error"))}e.saveApplication=function(){t.applications.update({id:e.application.oid},e.application.toJson(),function(t){(function(t){var i=s.find(".preference-list-item");it.each(t,function(t){i.eq(t).addClass("saved")}),s.find(".timestamp-row").addClass("saved"),s.find(".yhteystiedot .ng-dirty").addClass("saved"),window.setTimeout(function(){s.find(".saved").removeClass("saved"),$(".timestamp-row").removeClass("saved")},3e3)})(e.application.getChangedPreferences()),e.$broadcast("show-callout","attachments",!0===t.requiresAdditionalInfo&&e.application.getChangedPreferences().length>0),e.application.mergeSavedApplication(t),e.applicationForm.$setPristine(),p(M("message.changesSaved"),"success"),h([]),e.application.editHakutoiveetEnabled()&&function(){var t=$(s[0]).find(".application-header");null!=t.get(0)&&$(window).scrollTop()>t.get(0).offsetTop&&t.get(0).scrollIntoView()}()},function(t){p(M(400==t.status&&it.isArray(t.data)&&t.data.length>0?"error.saveFailed_validationError":400!=t.status||it.isArray(t.data)&&t.data.length>0?401==t.status?"error.saveFailed_sessionExpired":500==t.status?"error.serverError":"error.saveFailed":"error.serverError"),"error"),400==t.status&&h(t.data)}),p("","pending")}}}}],nt=e(43),at=e.n(nt);e(96),e(97),e(95);const ot=b();"en"===ot?at.a.locale("en-gb"):at.a.locale(ot);var st=at.a;class lt{constructor(t,i,e){this.$timeout=t,this.restResources=i;try{this.email=e.$parent.$parent.application.henkilotiedot["Sähköposti"].answer}catch(t){this.email=""}}formatTimestamp(t){return st(t).format("LLL").replace(/,/g,"")}isVastaanottoKesken(){return this.ajaxPending||this.vastaanottoSentSuccessfully}isNotVastaanotettavissa(){return!(this.vastaanottoAction&&0!==this.vastaanottoAction.length)||this.isVastaanottoKesken()||this.isRejectSelected()&&!this.confirmCancelAction&&this.isKkHaku()}isRejectSelected(){return"Peru"===this.vastaanottoAction}isKkHaku(){return!this.haku().toisenasteenhaku}flashSiirtohakuNotification(){this.siirtohakuClass="siirtohaku-fade-out",this.$timeout(()=>this.siirtohakuClass="siirtohaku-fade-in",50)}vastaanotaHakutoive(t){this.ajaxPending=!0;const i={hakemusOid:this.applicationOid(),hakukohdeOid:t.hakukohdeOid},e={vastaanottoAction:{action:this.vastaanottoAction},email:this.email,hakukohdeNimi:t.hakukohdeNimi,tarjoajaNimi:t.tarjoajaNimi};this.restResources.vastaanota.post(i,e).$promise.then(this.onSuccess(t),this.onError())}onSuccess(t){var i=this;return function(e){i.ajaxPending=!1,i.error="",i.vastaanottoSentSuccessfully=!0,i.$timeout(()=>i.callback(t,e),3500)}}onError(){var t=this;return function(i){var e=401==i.status?"error.saveFailed_sessionExpired":500==i.status?"error.serverError":403==i.status?"error.priorAcceptance":"error.saveFailed";t.error=M(e),t.ajaxPending=!1}}}lt.$inject=["$timeout","restResources","$scope"],e(18),e(18);const rt=e(18);var ut=["restResources",function(t){return{restrict:"E",scope:{valintatulos:"&data",application:"=application",isFinal:"&final",callback:"=callback"},template:e(374),link:function(i,e,n){function a(t){return"HYVAKSYTTY"==t.valintatila||"HARKINNANVARAISESTI_HYVAKSYTTY"==t.valintatila||"VARASIJALTA_HYVAKSYTTY"==t.valintatila}function o(t){return t.tilanKuvaukset[b().toUpperCase()]}i.localization=M,i.VASTAANOTTOTILA=k,i.error=!1,i.language=b(),i.formatDate=function(t){return null==t?"":moment(t).format("LL").replace(/,/g,"")},i.$watch("isFinal()",function(t){i.status=M(t?"label.resultsFinal":"label.resultsPending")}),i.getError=function(){if(i.error)return M(i.error)},i.isHyvaksyttyKesken=function(t,i){if("HYVAKSYTTY"===t.valintatila){var e=rt.findIndex(i,function(t){return"KESKEN"===t.valintatila||"VARALLA"===t.valintatila});if(-1!=e)return e<rt.findIndex(i,function(i){return i.hakukohdeOid===t.hakukohdeOid})&&"EI_VASTAANOTETTAVISSA"===t.vastaanotettavuustila}return!1},i.valintatulosText=function(t,e){var n=i.isHyvaksyttyKesken(t,e)?"HyvaksyttyKesken":T(t.valintatila),s=M("label.resultState.EhdollisenHyvaksymisenEhdonKentanNimi");return[k.VASTAANOTTANUT_SITOVASTI,k.EI_VASTAANOTETTU_MAARA_AIKANA,k.EHDOLLISESTI_VASTAANOTTANUT].indexOf(t.vastaanottotila)>=0?M("label.resultState."+(n=T(t.vastaanottotila))):rt.isEmpty(o(t))?"VARALLA"===t.valintatila&&null!=t.varasijojaTaytetaanAsti?M("label.resultState.VarallaPvm",{varasija:t.varasijanumero?t.varasijanumero+".":"",varasijaPvm:i.formatDate(t.varasijojaTaytetaanAsti)}):a(t)&&t.ehdollisestiHyvaksyttavissa?void 0!==t.ehdollisenHyvaksymisenEhtoKoodi&&null!=t.ehdollisenHyvaksymisenEhtoKoodi?M("label.resultState."+n)+" ("+t[s]+")":M("label.resultState."+n)+M("label.resultState.EhdollinenPostfix"):M("label.resultState."+n,{varasija:t.varasijanumero?t.varasijanumero+".":""}):"PERUNUT"===t.valintatila?M("label.resultState."+n):"HYLATTY"===t.valintatila?M("label.resultState."+n)+" "+o(t):a(t)&&t.ehdollisestiHyvaksyttavissa?void 0!==t.ehdollisenHyvaksymisenEhtoKoodi&&null!=t.ehdollisenHyvaksymisenEhtoKoodi?M("label.resultState."+n)+" ("+t[s]+")":M("label.resultState."+n)+M("label.resultState.EhdollinenPostfix"):o(t)},i.vastaanotaSitovasti=function(e,n){var a="";try{a=e.henkilotiedot["Sähköposti"].answer}catch(t){a=""}i.ajaxPending=!0,t.vastaanota.post({hakemusOid:e.oid,hakukohdeOid:n.hakukohdeOid},{vastaanottoAction:{action:"VastaanotaSitovasti"},email:a,hakukohdeNimi:n.hakukohdeNimi,tarjoajaNimi:n.tarjoajaNimi},function(t){i.ajaxPending=!1,i.error="",i.vastaanottoSentSuccessfully=!0,i.callback(n,t)},function(t){i.ajaxPending=!1,i.error=401==t.status?"error.saveFailed_sessionExpired":500==t.status?"error.serverError":403==t.status?"error.priorAcceptance":"error.saveFailed"})},i.valintatulosStyle=function(t){if(a(t))return"accepted"}}}}],ct=["restResources","debounce","settings","angularBacon",function(t,i,n,a){return{restrict:"E",scope:{application:"=application"},template:e(375),link:function(i,e,o){i.localization=M,i.yhteystiedot=i.application.henkilotiedot;var s=a.watch(i,"yhteystiedot['Postinumero'].answer").debounce(n.modelDebounce).skipDuplicates().map(".trim"),l=a.resource(t.postOffice.get);function r(t){return function(i){return i.length===t}}var u=s.filter(r(5)).flatMapLatest(function(t){return l({postalCode:t})});u.onValue(function(t){i.application.calculatedValues.postOffice=t.postOffice,i.yhteystiedot.Postinumero.setErrors([])}),u.onError(function(){i.application.calculatedValues.postOffice=""}),s.filter(function(t){return function(i){return!t(i)}}(r(5))).onValue(function(){i.$apply(function(){i.application.calculatedValues.postOffice=""})})}}}],pt=["$parse",function(t){return{link:function(i,e,n){var a=$("<div/>",{class:"clearable-input"}),o=$("<div/>",{class:"clear-btn"});e.wrap(a).parent().prepend(o),o.on("click",function(){i.$apply(function(){t(n.ngModel).assign(i,"")})}),i.$watch(n.ngModel,function(t){o.toggle(t&&t.length>0)})}}}],dt=["restResources",function(t){return{restrict:"E",scope:{application:"=",tulos:"="},template:e(377),link:function(i,e,n){function a(){i.tulos.ilmoittautumistila.ilmoittautumisaika.tehty=new Date,i.ilmoittautunut=!0}function o(t){switch(console.log(t),t.status){case 401:document.location.replace(window.url("omatsivut.login"));break;case 404:i.error="notFound";break;default:i.error="other"}}i.localization=M,i.states={semester:"LASNA_KOKO_LUKUVUOSI",autumn:"LASNA_SYKSY",spring:"LASNA"},i.reserveStates={LASNA_KOKO_LUKUVUOSI:"semester",LASNA_SYKSY:"autumn",LASNA:"spring"},i.init=function(){var t=i.application.hakutoiveet.find(function(t){return t.data["Koulutus-id"]===i.tulos.hakukohdeOid});i.tulos.koulutuksenAlkaminen=t.koulutuksenAlkaminen?t.koulutuksenAlkaminen:{kausiUri:"kausi_s#1"},i.ilmoittautuminen=i.reserveStates[i.tulos.ilmoittautumistila.ilmoittautumistila],i.ilmoittautunut=!!i.ilmoittautuminen}(),i.postLasnaoloilmoittautuminen=function(){i.error=!1;var e={hakukohdeOid:i.tulos.hakukohdeOid,muokkaaja:"",tila:i.states[i.ilmoittautuminen],selite:"Omien sivujen läsnäoloilmoittautuminen"};t.lasnaoloilmoittautuminen.save({hakuOid:i.application.haku.oid,hakemusOid:i.application.oid},JSON.stringify(e),a,o)},i.getStateTranslation=function(){return M("lasnaoloilmoittautuminen."+i.ilmoittautuminen)},i.getErrorTranslation=function(){return M("lasnaoloilmoittautuminen.error."+i.error)},i.schoolStartsInSpring=function(){return"kausi_k#1"===i.tulos.koulutuksenAlkaminen.kausiUri},i.schoolStartsInAutumn=function(){return"kausi_s#1"===i.tulos.koulutuksenAlkaminen.kausiUri},i.getEnrolmentMessageKeys=function(){const t=i.tulos.ilmoittautumisenAikaleima?new Date(i.tulos.ilmoittautumisenAikaleima):new Date;return{date:t.toLocaleDateString("fi-FI"),time:t.toLocaleTimeString("fi-FI")}}}}}],ht=["$scope","$location","$http",function(t,i,e){const n=decodeURIComponent(i.url()).match(/token\/(.+)/),a=n&&n[1],o="insecure/applications/application/";function s(){if(a||O()){t.loading=!0,i.hash("/").replace();const n=a?"token/"+a:"session";e.get(o+n).then(function(i){t.loading=!1,t.application=new Q(i.data),t.application.oiliJwt=i.oiliJwt,t.application.isHakutoiveidenMuokkaus=!0;const e=i.data.hakemus.answers.henkilotiedot;t.allowVastaanotto=!e.Henkilotunnus,t.user={name:e.Kutsumanimi+" "+e.Sukunimi}},function(i){t.loading=!1,404===i.status?t.errorMessage="error.noActiveApplication":i.data&&"expiredToken"===i.data.error?t.infoMessage="info.expiredToken":401===i.status||403===i.status?t.errorMessage="error.invalidToken":t.errorMessage="error.serverError"})}else t.errorMessage="error.noTokenAvailable"}t.$on("hakutoive-vastaanotettu",function(){s()}),t.lang=b(),s(),t.logout=function(){window.sessionStorage.removeItem(y),t.application=null,t.loggedOut=!0}}],vt=["$scope",function(t){t.localization=M,t.questionAnswered=function(){t.$emit("questionAnswered")}}];const ft=e(18);var mt=["$scope","$timeout","settings","restResources",function(t,i,e,n){t.isEditingDisabled=function(){return!t.hakutoive.isNew||!t.application.isEditable(t.$index)},t.isKoulutusSelectable=function(){return!t.isEditingDisabled()&&this.hakutoive.hasOpetuspiste()&&!ft.isEmpty(t.koulutusList)},t.isLoadingKoulutusList=function(){return!t.isEditingDisabled()&&this.hakutoive.hasOpetuspiste()&&ft.isEmpty(t.koulutusList)},t.showNotification=function(i){var e=t.hakutoive.data["Koulutus-id"];return(t.application.notifications[e]||{})[i]},t.isNonPrioritizedAndEditable=function(){return this.application.haku.usePriority||t.application.isEditable(t.$index)},t.opetuspisteValittu=function(i,e,a){this.hakutoive.setOpetuspiste(i.id,i.name),t.koulutusList=[],n.koulutukset.query({asId:this.application.haku.oid,opetuspisteId:i.id,baseEducation:this.application.educationBackground.baseEducation,vocational:this.application.educationBackground.vocational,uiLang:b()}).$promise.then(i=>{t.koulutusList=i,1===i.length&&(t.valittuKoulutus=i[0],t.hakutoive.setKoulutus(i[0]))})},t.opetuspisteModified=function(){ft.isEmpty(this.hakutoive.data.Opetuspiste)?this.hakutoive.clear():this.hakutoive.removeOpetuspisteData()},t.removeHakutoive=function(i){t.application.removePreference(i),t.application.addPreference(new F({}))},t.canRemovePreference=function(i){return t.application.hasPreference(i)&&!t.application.preferenceLocked(i)},t.koulutusValittu=function(t){t&&this.hakutoive.setKoulutus(t)},t.findOpetuspiste=function(i){return n.opetuspisteet.query({query:i,asId:t.application.haku.oid,lang:b()}).$promise}}];e(361),e(362),window.moment=st,e(378),e(379),window.Service={login:function(){document.location.href="/omatsivut/login"},logout:function(){document.location.href="/omatsivut/logout"},getUser:function(){return new Promise((t,i)=>{fetch("/omatsivut/session",{credentials:"same-origin"}).then(e=>{200===e.status?e.json().then(i=>{t(i)}):i(new Error("No session found!"))}).catch(t=>{console.error(t),i(new Error("Failed to fetch session!"))})})}};const kt=a.a.module("listApp",[s.a,r.a,c.a,d.a,v.a,"RecursionHelper","debounce"]);function gt(t,i){"undefined"==typeof _paq||null==_paq?console.warn("Piwik not present, cannot log: "+t+"\n"+i):(console.warn(t+"\n"+i),_paq.push(["trackEvent",document.location,t,i]))}kt.config(C).factory("restResources",z).factory("angularBacon",function(){return{watch:function(t,i){let e=new L.a.Bus;return t.$watch(i,function(t,i){t!==i&&e.push(t)}),e},resource:function(t){return function(i,e){return L.a.fromNodeCallback(function(n){t(i,e,function(t){n(null,t)},function(t){n(t)})})}}}}).factory("applicationValidator",P).factory("settings",V).directive("applicationList",G).directive("notification",class{constructor(){this.restrict="E",this.scope={message:"@"},this.template=e(366)}link(t){t.visible=!0,t.close=(()=>t.visible=!1)}}).directive("confirm",function(){return{scope:{callback:"&confirmAction"},link:function(t,i,e){var n="";function a(){i.removeClass("confirm"),i.text(n),i.off(".cancelConfirm"),$("body").off(".cancelConfirm")}i.on("click",function(){return i.hasClass("confirm")?(t.$apply(t.callback),a()):(i.hide(),i.addClass("confirm"),n=i.text(),i.text(e.confirmText),$("body").one("click.cancelConfirm",a),i.fadeIn(100)),!1})}}}).directive("question",Z).directive("localizedLink",function(){return{restrict:"E",template:"",link:function(t,i,e){var n=M(e.key),a=$("<span>"+n+"</span>").find("a").attr("href",e.href).attr("target",e.target).end();t.$watch("attrs.href",function(t){a.find("a").attr("href",e.href)}),i.append(a)}}}).directive("formattedTime",function(){return{restrict:"A",template:"",scope:{formattedTime:"=formattedTime"},link:function(t,i,e){t.$watch("formattedTime",function(t){if(null==t)return"";var n=window.moment(t);i.attr("datetime",n.format()),i.text(n.format(e.format||"LLLL").replace(/,/g,""))})}}}).directive("sortable",tt).directive("disableClickFocus",function(){return{link:function(t,i){i.on("mousedown",function(t){t.preventDefault()})}}}).directive("application",et).directive("hakutoiveenVastaanotto",class{constructor(){this.restrict="E",this.bindToController={applicationOid:"&",haku:"&",hakutoiveet:"&",callback:"="},this.template=e(370),this.controller=lt,this.controllerAs="ctrl"}link(t,i,e){t.localization=M}}).directive("ilmoittautuminen",function(){return{restrict:"E",scope:{hakukohteet:"&",oili:"&",application:"="},template:e(371),link:function(t,i,e){t.localization=M,t.statesToReport={LASNA_KOKO_LUKUVUOSI:"semester",POISSA_KOKO_LUKUVUOSI:"away",LASNA_SYKSY:"autumn",POISSA_SYKSY:"spring",LASNA:"spring",POISSA:"away_spring"},t.linkkiOK=function(t){return null!=t.ilmoittautumistila.ilmoittautumistapa&&t.ilmoittautumistila.ilmoittautumistapa.url},t.ilmoittautumistietoNaytetaan=function(i){return!!(i&&i.ilmoittautumistila&&i.ilmoittautumistila.ilmoittautumistila)&&t.statesToReport[i.ilmoittautumistila.ilmoittautumistila]},t.getEnrolmentMessageKeys=function(t){var i=t.ilmoittautumisenAikaleima?new Date(t.ilmoittautumisenAikaleima):new Date;return{date:i.toLocaleDateString("fi-FI"),time:i.toLocaleTimeString("fi-FI")}},t.getStateTranslation=function(i){return M("lasnaoloilmoittautuminen."+t.statesToReport[i.ilmoittautumistila.ilmoittautumistila])},t.ohjeetUudelleOpiskelijalle=function(i){return(t.application.hakutoiveet?t.application.hakutoiveet:[]).filter(function(t){return t.ohjeetUudelleOpiskelijalle&&t.data["Koulutus-id"]==i}).map(function(t){return t.ohjeetUudelleOpiskelijalle}).pop()}}}}).directive("kela",function(){return{restrict:"E",scope:{kela:"&"},template:e(372),link:function(t,i,e){t.localization=M}}}).directive("hakutoiveet",function(){return{restrict:"E",scope:{application:"=",preferenceMoved:"=",validating:"="},template:e(373),link:function(t,i,e){t.localization=M,t.movePreference=function(t,i){i>=0&&i<this.application.hakutoiveet.length&&(this.application.movePreference(t,i),this.preferenceMoved())}}}}).directive("valintatulos",ut).directive("henkilotiedot",ct).directive("applicationPeriods",function(){return{restrict:"E",scope:{haku:"&haku"},template:e(376),link:function(t,i,e){t.localization=M,t.periods=function(){return t.haku().applicationPeriods},t.applicationPeriodString=function(i){return 1===t.periods().length?M("label.applicationPeriod"):i+1+". "+M("label.applicationPeriod").toLowerCase()},t.statusString=function(t){return t.active?M("label.applicationPeriodActive"):t.end<(new Date).getTime()?M("label.applicationPeriodPassed"):M("label.applicationPeriodNotStarted")}}}}).directive("ignoreDirty",function(){return{restrict:"A",require:"ngModel",link:function(t,i,e,n){n.$pristine=!1}}}).directive("clearableInput",pt).directive("callout",function(){return{link:function(t,i,e){i.addClass("callout"),i.prepend($("<div/>",{class:"callout-close"})),i.on("click",".callout-close",function(){i.fadeOut("fast")}),t.$on("show-callout",function(t,n,a){e.callout==n&&(a?i.fadeIn("fast"):i.fadeOut("fast"))})}}}).directive("lasnaoloilmoittautuminen",dt).controller("hakutoiveidenMuokkausController",ht).controller("additionalQuestionController",vt).controller("hakutoiveController",mt),kt.run(["$rootScope",function(t){t.localization=M}]),kt.run(["$http","$cookies",function(t,i){t.defaults.headers.common.clientSubSystemCode="omatsivut.frontend",i.CSRF&&(t.defaults.headers.common.CSRF=i.CSRF)}]),a.a.element(document).ready(async function(){const t=b();document.documentElement.lang=t,window.translations=await function(t){return fetch(g+"?lang="+t).then(t=>t.json()).then(t=>t).catch(t=>console.error(t))}(t)}().then(()=>{a.a.bootstrap(document,["listApp"]),document.getElementsByTagName("body")[0].setAttribute("aria-busy","false")})),window.onerror=function(t,i,e,n,a){let o=i+":"+e;void 0!==n&&(o+=":"+n),void 0!==a&&(o+="\n"+a.stack),gt(t,o)},a.a.module("exceptionOverride",[]).factory("$exceptionHandler",function(){return function(t){if(x())throw t;gt(t.message,t.stack)}})}});
//# sourceMappingURL=index.bundle.js.map